(function(){if(!("SVGPathSeg"in window)){window.SVGPathSeg=function(a,n,e){this.pathSegType=a;this.pathSegTypeAsLetter=n;this._owningPathSegList=e};SVGPathSeg.PATHSEG_UNKNOWN=0;SVGPathSeg.PATHSEG_CLOSEPATH=1;SVGPathSeg.PATHSEG_MOVETO_ABS=2;SVGPathSeg.PATHSEG_MOVETO_REL=3;SVGPathSeg.PATHSEG_LINETO_ABS=4;SVGPathSeg.PATHSEG_LINETO_REL=5;SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6;SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9;SVGPathSeg.PATHSEG_ARC_ABS=
10;SVGPathSeg.PATHSEG_ARC_REL=11;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13;SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14;SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)};
window.SVGPathSegClosePath=function(a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CLOSEPATH,"z",a)};SVGPathSegClosePath.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"};SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter};SVGPathSegClosePath.prototype.clone=function(){return new SVGPathSegClosePath(undefined)};window.SVGPathSegMovetoAbs=function(a,n,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_ABS,
"M",a);this._x=n;this._y=e};SVGPathSegMovetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"};SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoAbs.prototype.clone=function(){return new SVGPathSegMovetoAbs(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=
a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});window.SVGPathSegMovetoRel=function(a,n,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_REL,"m",a);this._x=n;this._y=e};SVGPathSegMovetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"};SVGPathSegMovetoRel.prototype._asPathString=
function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoRel.prototype.clone=function(){return new SVGPathSegMovetoRel(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoAbs=
function(a,n,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_ABS,"L",a);this._x=n;this._y=e};SVGPathSegLinetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"};SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoAbs.prototype.clone=function(){return new SVGPathSegLinetoAbs(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoAbs.prototype,
"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoRel=function(a,n,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_REL,"l",a);this._x=n;this._y=e};SVGPathSegLinetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"};
SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoRel.prototype.clone=function(){return new SVGPathSegLinetoRel(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},
enumerable:true});window.SVGPathSegCurvetoCubicAbs=function(a,n,e,b,k,p,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",a);this._x=n;this._y=e;this._x1=b;this._y1=k;this._x2=p;this._y2=c};SVGPathSegCurvetoCubicAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"};SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+
" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicAbs(undefined,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});
Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,
"y2",{get:function(){return this._y2},set:function(a){this._y2=a;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoCubicRel=function(a,n,e,b,k,p,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",a);this._x=n;this._y=e;this._x1=b;this._y1=k;this._x2=p;this._y2=c};SVGPathSegCurvetoCubicRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"};SVGPathSegCurvetoCubicRel.prototype._asPathString=
function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicRel(undefined,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},
set:function(a){this._y=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=
a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoQuadraticAbs=function(a,n,e,b,k){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",a);this._x=n;this._y=e;this._x1=b;this._y1=k};SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticAbs.prototype.toString=
function(){return"[object SVGPathSegCurvetoQuadraticAbs]"};SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticAbs(undefined,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});
Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(a){this._x1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a;this._segmentChanged()},enumerable:true});
window.SVGPathSegCurvetoQuadraticRel=function(a,n,e,b,k){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",a);this._x=n;this._y=e;this._x1=b;this._y1=k};SVGPathSegCurvetoQuadraticRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"};SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};
SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticRel(undefined,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,
"x1",{get:function(){return this._x1},set:function(a){this._x1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(a){this._y1=a;this._segmentChanged()},enumerable:true});window.SVGPathSegArcAbs=function(a,n,e,b,k,p,c,g){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_ABS,"A",a);this._x=n;this._y=e;this._r1=b;this._r2=k;this._angle=p;this._largeArcFlag=c;this._sweepFlag=g};SVGPathSegArcAbs.prototype=
Object.create(SVGPathSeg.prototype);SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"};SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcAbs.prototype.clone=function(){return new SVGPathSegArcAbs(undefined,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcAbs.prototype,
"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(a){this._r1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(a){this._r2=
a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(a){this._largeArcFlag=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(a){this._sweepFlag=
a;this._segmentChanged()},enumerable:true});window.SVGPathSegArcRel=function(a,n,e,b,k,p,c,g){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_REL,"a",a);this._x=n;this._y=e;this._r1=b;this._r2=k;this._angle=p;this._largeArcFlag=c;this._sweepFlag=g};SVGPathSegArcRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"};SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+
this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcRel.prototype.clone=function(){return new SVGPathSegArcRel(undefined,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},
set:function(a){this._y=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(a){this._r1=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(a){this._r2=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=
a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(a){this._largeArcFlag=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(a){this._sweepFlag=a;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoHorizontalAbs=function(a,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,
"H",a);this._x=n};SVGPathSegLinetoHorizontalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"};SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new SVGPathSegLinetoHorizontalAbs(undefined,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},
set:function(a){this._x=a;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoHorizontalRel=function(a,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",a);this._x=n};SVGPathSegLinetoHorizontalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"};SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalRel.prototype.clone=
function(){return new SVGPathSegLinetoHorizontalRel(undefined,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoVerticalAbs=function(a,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",a);this._y=n};SVGPathSegLinetoVerticalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"};
SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new SVGPathSegLinetoVerticalAbs(undefined,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoVerticalRel=function(a,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",a);
this._y=n};SVGPathSegLinetoVerticalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"};SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new SVGPathSegLinetoVerticalRel(undefined,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},
set:function(a){this._y=a;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoCubicSmoothAbs=function(a,n,e,b,k){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",a);this._x=n;this._y=e;this._x2=b;this._y2=k};SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"};SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+
" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothAbs(undefined,this._x,this._y,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},
enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoCubicSmoothRel=function(a,n,e,b,k){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",a);this._x=n;
this._y=e;this._x2=b;this._y2=k};SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"};SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothRel(undefined,this._x,this._y,
this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(a){this._x2=a;this._segmentChanged()},
enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(a){this._y2=a;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoQuadraticSmoothAbs=function(a,n,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",a);this._x=n;this._y=e};SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"};
SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothAbs(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,
"y",{get:function(){return this._y},set:function(a){this._y=a;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoQuadraticSmoothRel=function(a,n,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",a);this._x=n;this._y=e};SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"};SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=
function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothRel(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(a){this._y=
a;this._segmentChanged()},enumerable:true});SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new SVGPathSegClosePath(undefined)};SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(a,n){return new SVGPathSegMovetoAbs(undefined,a,n)};SVGPathElement.prototype.createSVGPathSegMovetoRel=function(a,n){return new SVGPathSegMovetoRel(undefined,a,n)};SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(a,n){return new SVGPathSegLinetoAbs(undefined,a,n)};SVGPathElement.prototype.createSVGPathSegLinetoRel=
function(a,n){return new SVGPathSegLinetoRel(undefined,a,n)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(a,n,e,b,k,p){return new SVGPathSegCurvetoCubicAbs(undefined,a,n,e,b,k,p)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(a,n,e,b,k,p){return new SVGPathSegCurvetoCubicRel(undefined,a,n,e,b,k,p)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(a,n,e,b){return new SVGPathSegCurvetoQuadraticAbs(undefined,a,n,e,b)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=
function(a,n,e,b){return new SVGPathSegCurvetoQuadraticRel(undefined,a,n,e,b)};SVGPathElement.prototype.createSVGPathSegArcAbs=function(a,n,e,b,k,p,c){return new SVGPathSegArcAbs(undefined,a,n,e,b,k,p,c)};SVGPathElement.prototype.createSVGPathSegArcRel=function(a,n,e,b,k,p,c){return new SVGPathSegArcRel(undefined,a,n,e,b,k,p,c)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(a){return new SVGPathSegLinetoHorizontalAbs(undefined,a)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=
function(a){return new SVGPathSegLinetoHorizontalRel(undefined,a)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(a){return new SVGPathSegLinetoVerticalAbs(undefined,a)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(a){return new SVGPathSegLinetoVerticalRel(undefined,a)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(a,n,e,b){return new SVGPathSegCurvetoCubicSmoothAbs(undefined,a,n,e,b)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=
function(a,n,e,b){return new SVGPathSegCurvetoCubicSmoothRel(undefined,a,n,e,b)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(a,n){return new SVGPathSegCurvetoQuadraticSmoothAbs(undefined,a,n)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(a,n){return new SVGPathSegCurvetoQuadraticSmoothRel(undefined,a,n)}}if(!("SVGPathSegList"in window)){window.SVGPathSegList=function(a){this._pathElement=a;this._list=this._parsePath(this._pathElement.getAttribute("d"));
this._mutationObserverConfig={attributes:true,attributeFilter:["d"]};this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this));this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};Object.defineProperty(SVGPathSegList.prototype,"numberOfItems",{get:function(){this._checkPathSynchronizedToList();return this._list.length},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"pathSegList",{get:function(){if(!this._pathSegList)this._pathSegList=
new SVGPathSegList(this);return this._pathSegList},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:true});SVGPathSegList.prototype._checkPathSynchronizedToList=
function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())};SVGPathSegList.prototype._updateListFromPathMutations=function(a){if(this._pathElement){var n=false;a.forEach(function(e){if(e.attributeName=="d")n=true});if(n)this._list=this._parsePath(this._pathElement.getAttribute("d"))}};SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect();this._pathElement.setAttribute("d",SVGPathSegList._pathSegArrayAsString(this._list));
this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};SVGPathSegList.prototype.segmentChanged=function(){this._writeListToPath()};SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList();this._list.forEach(function(a){a._owningPathSegList=null});this._list=[];this._writeListToPath()};SVGPathSegList.prototype.initialize=function(a){this._checkPathSynchronizedToList();this._list=[a];a._owningPathSegList=this;this._writeListToPath();return a};
SVGPathSegList.prototype._checkValidIndex=function(a){if(isNaN(a)||a<0||a>=this.numberOfItems)throw"INDEX_SIZE_ERR";};SVGPathSegList.prototype.getItem=function(a){this._checkPathSynchronizedToList();this._checkValidIndex(a);return this._list[a]};SVGPathSegList.prototype.insertItemBefore=function(a,n){this._checkPathSynchronizedToList();if(n>this.numberOfItems)n=this.numberOfItems;if(a._owningPathSegList)a=a.clone();this._list.splice(n,0,a);a._owningPathSegList=this;this._writeListToPath();return a};
SVGPathSegList.prototype.replaceItem=function(a,n){this._checkPathSynchronizedToList();if(a._owningPathSegList)a=a.clone();this._checkValidIndex(n);this._list[n]=a;a._owningPathSegList=this;this._writeListToPath();return a};SVGPathSegList.prototype.removeItem=function(a){this._checkPathSynchronizedToList();this._checkValidIndex(a);var n=this._list[a];this._list.splice(a,1);this._writeListToPath();return n};SVGPathSegList.prototype.appendItem=function(a){this._checkPathSynchronizedToList();if(a._owningPathSegList)a=
a.clone();this._list.push(a);a._owningPathSegList=this;this._writeListToPath();return a};SVGPathSegList._pathSegArrayAsString=function(a){var n="",e=true;a.forEach(function(b){if(e){e=false;n+=b._asPathString()}else n+=" "+b._asPathString()});return n};SVGPathSegList.prototype._parsePath=function(a){if(!a||a.length==0)return[];var n=this,e=function(){this.pathSegList=[]};e.prototype.appendSegment=function(k){this.pathSegList.push(k)};var b=function(k){this._string=k;this._currentIndex=0;this._endIndex=
this._string.length;this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN;this._skipOptionalSpaces()};b.prototype._isCurrentSpace=function(){var k=this._string[this._currentIndex];return k<=" "&&(k==" "||k=="\n"||k=="\t"||k=="\r"||k=="\u000c")};b.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex};b.prototype._skipOptionalSpacesOrDelimiter=function(){if(this._currentIndex<this._endIndex&&
!this._isCurrentSpace()&&this._string.charAt(this._currentIndex)!=",")return false;if(this._skipOptionalSpaces())if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)==","){this._currentIndex++;this._skipOptionalSpaces()}return this._currentIndex<this._endIndex};b.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex};b.prototype.peekSegmentType=function(){return this._pathSegTypeFromChar(this._string[this._currentIndex])};b.prototype._pathSegTypeFromChar=
function(k){switch(k){case "Z":case "z":return SVGPathSeg.PATHSEG_CLOSEPATH;case "M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case "m":return SVGPathSeg.PATHSEG_MOVETO_REL;case "L":return SVGPathSeg.PATHSEG_LINETO_ABS;case "l":return SVGPathSeg.PATHSEG_LINETO_REL;case "C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case "c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case "Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case "q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case "A":return SVGPathSeg.PATHSEG_ARC_ABS;
case "a":return SVGPathSeg.PATHSEG_ARC_REL;case "H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case "h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case "V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case "v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case "S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case "s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case "T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case "t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;
default:return SVGPathSeg.PATHSEG_UNKNOWN}};b.prototype._nextCommandHelper=function(k,p){if((k=="+"||k=="-"||k=="."||k>="0"&&k<="9")&&p!=SVGPathSeg.PATHSEG_CLOSEPATH){if(p==SVGPathSeg.PATHSEG_MOVETO_ABS)return SVGPathSeg.PATHSEG_LINETO_ABS;if(p==SVGPathSeg.PATHSEG_MOVETO_REL)return SVGPathSeg.PATHSEG_LINETO_REL;return p}return SVGPathSeg.PATHSEG_UNKNOWN};b.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return true;var k=this.peekSegmentType();return k==SVGPathSeg.PATHSEG_MOVETO_ABS||
k==SVGPathSeg.PATHSEG_MOVETO_REL};b.prototype._parseNumber=function(){var k=0,p=0,c=1,g=0,d=1,o=1,u=this._currentIndex;this._skipOptionalSpaces();if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="+")this._currentIndex++;else if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="-"){this._currentIndex++;d=-1}if(!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&this._string.charAt(this._currentIndex)!=
".")){for(var A=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=A)for(var q=this._currentIndex-1,M=1;q>=A;){p+=M*(this._string.charAt(q--)-"0");M*=10}if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="."){this._currentIndex++;if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>
"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)g+=(this._string.charAt(this._currentIndex++)-"0")*(c*=0.1)}if(this._currentIndex!=u&&this._currentIndex+1<this._endIndex&&(this._string.charAt(this._currentIndex)=="e"||this._string.charAt(this._currentIndex)=="E")&&this._string.charAt(this._currentIndex+1)!="x"&&this._string.charAt(this._currentIndex+1)!="m"){this._currentIndex++;if(this._string.charAt(this._currentIndex)==
"+")this._currentIndex++;else if(this._string.charAt(this._currentIndex)=="-"){this._currentIndex++;o=-1}if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";){k*=10;k+=this._string.charAt(this._currentIndex)-"0";this._currentIndex++}}p=p+g;p*=d;if(k)p*=Math.pow(10,o*k);if(u!=this._currentIndex){this._skipOptionalSpacesOrDelimiter();
return p}}};b.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var k=false;k=this._string.charAt(this._currentIndex++);if(k=="0")k=false;else if(k=="1")k=true;else return;this._skipOptionalSpacesOrDelimiter();return k}};b.prototype.parseSegment=function(){var k=this._string[this._currentIndex],p=this._pathSegTypeFromChar(k);if(p==SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==SVGPathSeg.PATHSEG_UNKNOWN)return null;p=this._nextCommandHelper(k,this._previousCommand);
if(p==SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;this._previousCommand=p;switch(p){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(n,this._parseNumber(),
this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(n,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(n,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(n,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new SVGPathSegLinetoVerticalAbs(n,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:this._skipOptionalSpaces();
return new SVGPathSegClosePath(n);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:k={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(n,k.x,k.y,k.x1,k.y1,k.x2,k.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:k={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(n,
k.x,k.y,k.x1,k.y1,k.x2,k.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:k={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(n,k.x,k.y,k.x2,k.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:k={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(n,k.x,k.y,k.x2,k.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:k={x1:this._parseNumber(),
y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(n,k.x,k.y,k.x1,k.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:k={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(n,k.x,k.y,k.x1,k.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(n,
this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:k={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(n,k.x,k.y,k.x1,k.y1,k.arcAngle,k.arcLarge,k.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:k={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),
x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(n,k.x,k.y,k.x1,k.y1,k.arcAngle,k.arcLarge,k.arcSweep);default:throw"Unknown path seg type.";}};e=new e;a=new b(a);if(!a.initialCommandIsMoveTo())return[];for(;a.hasMoreData();){b=a.parseSegment();if(!b)return[];e.appendSegment(b)}return e.pathSegList}}})();function touchHandler(a){var n=a.changedTouches,e=n[0],b="";switch(a.type){case "touchstart":b="mousedown";break;case "touchmove":b="mousemove";break;case "touchend":b="mouseup";break;default:return}var k=document.createEvent("MouseEvent");k.initMouseEvent(b,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);if(n.length<2){e.target.dispatchEvent(k);a.preventDefault()}};(function(a){function n(e){if(typeof e.data==="string"){var b=e.handler,k=e.data.toLowerCase().split(" ");e.handler=function(p){if(!(this!==p.target&&(/textarea|select/i.test(p.target.nodeName)||p.target.type==="text"))){var c=p.type!=="keypress"&&a.hotkeys.specialKeys[p.which],g=String.fromCharCode(p.which).toLowerCase(),d="",o={};if(p.altKey&&c!=="alt")d+="alt+";if(p.ctrlKey&&c!=="ctrl")d+="ctrl+";if(p.metaKey&&!p.ctrlKey&&c!=="meta")d+="meta+";if(p.shiftKey&&c!=="shift")d+="shift+";if(c)o[d+c]=
true;else{o[d+g]=true;o[d+a.hotkeys.shiftNums[g]]=true;if(d==="shift+")o[a.hotkeys.shiftNums[g]]=true}c=0;for(g=k.length;c<g;c++)if(o[k[c]])return b.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:n}})})(jQuery);(function(a){var n={},e;a.svgIcons=function(b,k){function p(la,ba){if(la!=="ajax"){if(W)return;var ea=(Q=Z[0].contentDocument)&&Q.getElementById("svg_eof");if(!ea&&!(ba&&ea)){T++;if(T<50)setTimeout(p,20);else{g();W=true}return}W=true}M=a(Q.firstChild).children();if(k.no_img)setTimeout(function(){I||c()},500);else{ea=ma+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";L=a(new Image).attr({src:ea,width:0,height:0}).appendTo("body").load(function(){c(true)}).error(function(){c()})}}
function c(la,ba){if(!I){if(k.no_img)la=false;if(la){var ea=a(document.createElement("div"));ea.hide().appendTo("body")}if(ba){var qa=k.fallback_path?k.fallback_path:"";a.each(ba,function(Ra,Fa){a("#"+Ra);var ya=a(new Image).attr({"class":"svg_icon",src:qa+Fa,width:A,height:q,alt:"icon"});ia(ya,Ra)})}else for(var oa=M.length,na=0;na<oa;na++){var pa=M[na],Ka=pa.id;if(Ka==="svg_eof")break;a("#"+Ka);pa=pa.getElementsByTagNameNS(o,"svg")[0];var La=document.createElementNS(o,"svg");La.setAttributeNS(o,
"viewBox",[0,0,A,q].join(" "));var Ha=pa.getAttribute("width"),Sa=pa.getAttribute("height");pa.removeAttribute("width");pa.removeAttribute("height");pa.getAttribute("viewBox")||pa.setAttribute("viewBox",[0,0,Ha,Sa].join(" "));La.setAttribute("xmlns",o);La.setAttribute("width",A);La.setAttribute("height",q);La.setAttribute("xmlns:xlink",u);La.setAttribute("class","svg_icon");da||(pa=pa.cloneNode(true));La.appendChild(pa);if(la){da||La.cloneNode(true);ea.empty().append(La);pa=ma+d(ea.html());pa=a(new Image).attr({"class":"svg_icon",
src:pa})}else pa=e(a(La),na);ia(pa,Ka)}k.placement&&a.each(k.placement,function(Ra,Fa){n[Fa]&&a(Ra).each(function(ya){var xa=n[Fa].clone();if(ya>0&&!la)xa=e(xa,ya,true);ta(a(this),xa,Fa)})});if(!ba){la&&ea.remove();Z&&Z.remove();L&&L.remove()}k.resize&&a.resizeSvgIcons(k.resize);I=true;k.callback&&k.callback(n)}}function g(){if(b.indexOf(".svgz")!=-1){var la=b.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg");a.svgIcons(la,k)}else k.fallback&&c(false,k.fallback)}
function d(la){if(window.btoa)return window.btoa(la);var ba=Array(Math.floor((la.length+2)/3)*4),ea,qa,oa,na,pa,Ka,La=0,Ha=0;do{ea=la.charCodeAt(La++);qa=la.charCodeAt(La++);oa=la.charCodeAt(La++);na=ea>>2;ea=(ea&3)<<4|qa>>4;pa=(qa&15)<<2|oa>>6;Ka=oa&63;if(isNaN(qa))pa=Ka=64;else if(isNaN(oa))Ka=64;ba[Ha++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(na);ba[Ha++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ea);ba[Ha++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(pa);
ba[Ha++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(Ka)}while(La<la.length);return ba.join("")}var o="http://www.w3.org/2000/svg",u="http://www.w3.org/1999/xlink",A=k.w?k.w:24,q=k.h?k.h:24,M,Q,L,I=false,W=false,T=0,O=navigator.userAgent,da=!!window.opera;O.indexOf("Safari/")>-1&&O.indexOf("Chrome/");var ma="data:image/svg+xml;charset=utf-8;base64,";if(k.svgz){var Z=a('<object data="'+b+'" type=image/svg+xml>').appendTo("body").hide();try{Q=Z[0].contentDocument;Z.load(p);
p(0,true)}catch(X){g()}}else{var fa=new DOMParser;a.ajax({url:b,dataType:"string",success:function(la){if(la){Q=fa.parseFromString(la,"text/xml");a(function(){p("ajax")})}else a(g)},error:function(la){if(window.opera)a(function(){g()});else if(la.responseText){Q=fa.parseFromString(la.responseText,"text/xml");Q.childNodes.length||a(g);a(function(){p("ajax")})}else a(g)}})}var ta=function(la,ba,ea,qa){da&&ba.css("visibility","hidden");if(k.replace){qa&&ba.attr("id",ea);(ea=la.attr("class"))&&ba.attr("class",
"svg_icon "+ea);la.replaceWith(ba)}else la.append(ba);da&&setTimeout(function(){ba.removeAttr("style")},1)},ia=function(la,ba){if(k.id_match===undefined||k.id_match!==false)ta(holder,la,ba,true);n[ba]=la};e=function(la,ba){var ea=la.find("defs");if(!ea.length)return la;ea=da?ea.find("*").filter(function(){return!!this.id}):ea.find("[id]");var qa=la[0].getElementsByTagName("*"),oa=qa.length;ea.each(function(na){var pa=this.id;a(Q).find("#"+pa);this.id=na="x"+pa+ba+na;pa="url(#"+pa+")";var Ka="url(#"+
na+")";for(na=0;na<oa;na++){var La=qa[na];La.getAttribute("fill")===pa&&La.setAttribute("fill",Ka);La.getAttribute("stroke")===pa&&La.setAttribute("stroke",Ka);La.getAttribute("filter")===pa&&La.setAttribute("filter",Ka)}});return la}};a.getSvgIcon=function(b,k){var p=n[b];if(k&&p)p=e(p,0,true).clone(true);return p};a.resizeSvgIcons=function(b){var k=!a(".svg_icon:first").length;a.each(b,function(p,c){var g=a.isArray(c),d=g?c[0]:c,o=g?c[1]:c;if(k)p=p.replace(/\.svg_icon/g,"svg");a(p).each(function(){this.setAttribute("width",
d);this.setAttribute("height",o);if(window.opera&&window.widget){this.parentNode.style.width=d+"px";this.parentNode.style.height=o+"px"}})})}})(jQuery);(function(){function a(b,k,p){b=document.createElementNS(n.svg,b);if(e)for(var c in k)b.setAttribute(c,k[c]);else for(c in k){var g=k[c],d=b[c];if(d&&d.constructor==="SVGLength")d.baseVal.value=g;else b.setAttribute(c,g)}p&&p.appendChild(b);return b}var n={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};if(!window.console)window.console=new function(){this.log=function(){};this.dir=function(){}};$.jGraduate={Paint:function(b){b=b||{};this.alpha=isNaN(b.alpha)?100:b.alpha;if(b.copy){this.type=
b.copy.type;this.alpha=b.copy.alpha;this.radialGradient=this.linearGradient=this.solidColor=null;switch(this.type){case "solidColor":this.solidColor=b.copy.solidColor;break;case "linearGradient":this.linearGradient=b.copy.linearGradient.cloneNode(true);break;case "radialGradient":this.radialGradient=b.copy.radialGradient.cloneNode(true)}}else if(b.linearGradient){this.type="linearGradient";this.radialGradient=this.solidColor=null;this.linearGradient=b.linearGradient.cloneNode(true)}else if(b.radialGradient){this.type=
"radialGradient";this.linearGradient=this.solidColor=null;this.radialGradient=b.radialGradient.cloneNode(true)}else if(b.solidColor){this.type="solidColor";this.solidColor=b.solidColor}else{this.type="none";this.radialGradient=this.linearGradient=this.solidColor=null}}};jQuery.fn.jGraduateDefaults={paint:new $.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var e=navigator.userAgent.indexOf("Gecko/")>=0;jQuery.fn.jGraduate=function(b){var k=
arguments;return this.each(function(){function p(ja,aa,ka,N,R){var ca=R||a("stop",{"stop-color":aa,"stop-opacity":ka,offset:ja},fa);if(R){aa=R.getAttribute("stop-color");ka=R.getAttribute("stop-opacity");ja=R.getAttribute("offset")}else fa.appendChild(ca);if(ka===null)ka=1;R=a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:"url(#jGraduate_trans)",transform:"translate("+(10+ja*da)+", 26)"},ob);var Ca=
a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:aa,"fill-opacity":ka,transform:"translate("+(10+ja*da)+", 26)",stroke:"#000","stroke-width":1.5},ob);$(Ca).mousedown(function(Na){c(this);Ya=gb;W.mousemove(o).mouseup(g);ua=vb.offset();Na.preventDefault();return false}).data("stop",ca).data("bg",R).dblclick(function(){$("div.jGraduate_LightBox").show();for(var Na=this,Za=+ca.getAttribute("stop-opacity")||
1,cb=ca.getAttribute("stop-color")||1,qb=(parseFloat(Za)*255).toString(16);qb.length<2;)qb="0"+qb;aa=cb.substr(1)+qb;$("#"+q+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:A.images.clientPath},color:{active:aa,alphaSupport:true}},function(Ta){cb=Ta.val("hex")?"#"+Ta.val("hex"):"none";Za=Ta.val("a")!==null?Ta.val("a")/256:1;Na.setAttribute("fill",cb);Na.setAttribute("fill-opacity",Za);ca.setAttribute("stop-color",
cb);ca.setAttribute("stop-opacity",Za);$("div.jGraduate_LightBox").hide();$("#"+q+"_jGraduate_stopPicker").hide()},null,function(){$("div.jGraduate_LightBox").hide();$("#"+q+"_jGraduate_stopPicker").hide()})});$(fa).find("stop").each(function(){var Na=$(this);if(+this.getAttribute("offset")>ja){if(!aa){var Za=this.getAttribute("stop-color"),cb=this.getAttribute("stop-opacity");ca.setAttribute("stop-color",Za);Ca.setAttribute("fill",Za);ca.setAttribute("stop-opacity",cb===null?1:cb);Ca.setAttribute("fill-opacity",
cb===null?1:cb)}Na.before(ca);return false}});N&&c(Ca);return ca}function c(ja){gb&&gb.setAttribute("stroke","#000");ja.setAttribute("stroke","blue");gb=ja;gb.parentNode.appendChild(gb)}function g(){W.unbind("mousemove",o);if(Aa.getAttribute("display")!=="none"){Aa.setAttribute("display","none");var ja=$(gb),aa=ja.data("stop");ja=ja.data("bg");$([gb,aa,ja]).remove()}Ya=null}function d(){var ja=Ua?"rotate("+Ua+","+Ba+","+hb+") ":"";db===1&&Ia===1?fa.removeAttribute("gradientTransform"):fa.setAttribute("gradientTransform",
ja+"translate("+-Ba*(db-1)+","+-hb*(Ia-1)+") scale("+db+","+Ia+")")}function o(ja){var aa=ja.pageX-ua.left;ja=ja.pageY-ua.top;aa=aa<10?10:aa>da+10?da+10:aa;var ka="translate("+aa+", 26)";if(ja<-60||ja>130){Aa.setAttribute("display","block");Aa.setAttribute("transform",ka)}else Aa.setAttribute("display","none");Ya.setAttribute("transform",ka);$.data(Ya,"bg").setAttribute("transform",ka);$.data(Ya,"stop").setAttribute("offset",(aa-10)/da);var N=0;$(fa).find("stop").each(function(){var R=this.getAttribute("offset"),
ca=$(this);if(R<N){ca.prev().before(ca);ra=$(fa).find("stop")}N=R})}var u=$(this),A=$.extend(true,{},jQuery.fn.jGraduateDefaults,b),q=u.attr("id"),M="#"+u.attr("id")+" ";if(M){var Q=function(){switch(u.paint.type){case "radialGradient":u.paint.linearGradient=null;break;case "linearGradient":u.paint.radialGradient=null;break;case "solidColor":u.paint.radialGradient=u.paint.linearGradient=null}$.isFunction(u.okCallback)&&u.okCallback(u.paint);u.hide()},L=function(){$.isFunction(u.cancelCallback)&&u.cancelCallback();
u.hide()};$.extend(true,u,{paint:new $.jGraduate.Paint({copy:A.paint}),okCallback:$.isFunction(k[1])&&k[1]||null,cancelCallback:$.isFunction(k[2])&&k[2]||null});u.position();var I=null,W=$(window);if(u.paint.type=="none")u.paint=$.jGraduate.Paint({solidColor:"ffffff"});u.addClass("jGraduate_Picker");u.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+
q+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var T=$(M+"> .jGraduate_colPick"),O=$(M+"> .jGraduate_gradPick");O.html('<div id="'+q+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+A.window.pickerTitle+'</h2><div id="'+q+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+q+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+
q+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+q+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+
q+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+q+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+
q+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+q+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+
q+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+q+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+A.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+q+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+
q+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+A.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+q+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+q+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+A.images.clientPath+
'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_AngleInput" size="3" value="0"/>\u00ba&nbsp;</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+q+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+q+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+A.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+
q+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+q+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var da=256,ma=da-0,Z=da-0,X,fa,ta,ia={};$(".jGraduate_SliderBar").width(145);var la=$("#"+q+"_jGraduate_GradContainer")[0],ba=a("svg",{id:q+"_jgraduate_svg",width:da,height:da,xmlns:n.svg},la);X=X||u.paint.type;var ea=fa=u.paint[X],qa=u.paint.alpha,oa=X==="solidColor";switch(X){case "solidColor":case "linearGradient":if(!oa){fa.id=q+"_lg_jgraduate_grad";
ea=fa=ba.appendChild(fa)}a("radialGradient",{id:q+"_rg_jgraduate_grad"},ba);if(X==="linearGradient")break;case "radialGradient":if(!oa){fa.id=q+"_rg_jgraduate_grad";ea=fa=ba.appendChild(fa)}a("linearGradient",{id:q+"_lg_jgraduate_grad",x1:0,y1:0,x2:1,y2:0},ba)}if(oa){ea=fa=$("#"+q+"_lg_jgraduate_grad")[0];I=u.paint[X];p(0,"#"+I,1);var na=typeof A.newstop;if(na==="string")switch(A.newstop){case "same":p(1,"#"+I,1);break;case "inverse":na="";if(I.length===3)I=I.split("").map(function(ja){return ja+
""+ja}).join("");for(var pa=0;pa<6;pa+=2){I.substr(pa,2);var Ka=(255-parseInt(I.substr(pa,2),16)).toString(16);if(Ka.length<2)Ka=0+Ka;na+=Ka}p(1,"#"+na,1);break;case "white":p(1,"#ffffff",1);break;case "black":p(1,"#000000",1)}else if(na==="object")p(1,A.newstop.color||"#"+I,"opac"in A.newstop?A.newstop.opac:1)}I=parseFloat(ea.getAttribute("x1")||0);na=parseFloat(ea.getAttribute("y1")||0);pa=parseFloat(ea.getAttribute("x2")||1);Ka=parseFloat(ea.getAttribute("y2")||0);var La=parseFloat(ea.getAttribute("cx")||
0.5),Ha=parseFloat(ea.getAttribute("cy")||0.5),Sa=parseFloat(ea.getAttribute("fx")||La),Ra=parseFloat(ea.getAttribute("fy")||Ha);ta=a("rect",{id:q+"_jgraduate_rect",x:0,y:0,width:ma,height:Z,fill:"url(#"+q+"_jgraduate_grad)","fill-opacity":qa/100},ba);var Fa=$("<div/>").attr({"class":"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:na*da,left:I*da}).data("coord","start").appendTo(la),ya=Fa.clone().text(2).css({top:Ka*da,left:pa*da}).attr("title","End stop").data("coord","end").appendTo(la),
xa=$("<div/>").attr({"class":"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:Ha*da,left:La*da}).data("coord","center").appendTo(la),Da=xa.clone().text("F").css({top:Ra*da,left:Sa*da,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(la);Da[0].id=q+"_jGraduate_focusCoord";$(M+" .grad_coord");$.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(ja,aa){var ka=fa.getAttribute(aa),N=isNaN(aa[1]);ka||(ka=N?"0.5":aa==="x2"?"1.0":"0.0");ia[aa]=$("#"+
q+"_jGraduate_"+aa).val(ka).change(function(){if(isNaN(parseFloat(this.value))||this.value<0)this.value=0;else if(this.value>1)this.value=1;if(!(aa[0]==="f"&&!fb))if(N&&X==="radialGradient"||!N&&X==="linearGradient")fa.setAttribute(aa,this.value);var R=N?aa[0]==="c"?xa:Da:aa[1]==="1"?Fa:ya,ca=aa.indexOf("x")>=0?"left":"top";R.css(ca,this.value*da)}).change()});var ra,ob,vb=$("#"+q+"_jGraduate_StopSlider"),gb,Va,Ya,Aa=a("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,
display:"none"},Va),ua,db=1,Ia=1,Ua=0,Ba=La,hb=Ha;Va=a("svg",{width:"100%",height:45},vb[0]);la=a("pattern",{width:16,height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},Va);a("image",{width:16,height:16},la).setAttributeNS(n.xlink,"xlink:href",A.images.clientPath+"map-opacity.png");$(Va).on("click touchstart",function(ja){ua=vb.offset();if(ja.target.tagName!=="path"){var aa=ja.pageX-ua.left-8;aa=aa<10?10:aa>da+10?da+10:aa;p(aa/da,0,0,true);ja.stopPropagation()}});$(Va).mouseover(function(){Va.appendChild(Aa)});
ob=a("g",{},Va);a("line",{x1:10,y1:15,x2:da+10,y2:15,"stroke-width":2,stroke:"#000"},Va);var rb=O.find(".jGraduate_spreadMethod").change(function(){fa.setAttribute("spreadMethod",$(this).val())}),Xa=null,$a=function(ja){var aa=ja.pageX-kb.left,ka=ja.pageY-kb.top;aa=aa<0?0:aa>da?da:aa;ka=ka<0?0:ka>da?da:ka;Xa.css("left",aa).css("top",ka);aa=aa/ma;ka=ka/Z;var N=Xa.data("coord"),R=fa;switch(N){case "start":ia.x1.val(aa);ia.y1.val(ka);R.setAttribute("x1",aa);R.setAttribute("y1",ka);break;case "end":ia.x2.val(aa);
ia.y2.val(ka);R.setAttribute("x2",aa);R.setAttribute("y2",ka);break;case "center":ia.cx.val(aa);ia.cy.val(ka);R.setAttribute("cx",aa);R.setAttribute("cy",ka);Ba=aa;hb=ka;d();break;case "focus":ia.fx.val(aa);ia.fy.val(ka);R.setAttribute("fx",aa);R.setAttribute("fy",ka);d()}ja.preventDefault()},wb=function(){Xa=null;W.unbind("mousemove",$a).unbind("mouseup",wb)};ra=fa.getElementsByTagNameNS(n.svg,"stop");if(sa<2){for(;sa<2;){fa.appendChild(document.createElementNS(n.svg,"stop"));++sa}ra=fa.getElementsByTagNameNS(n.svg,
"stop")}var sa=ra.length;for(pa=0;pa<sa;pa++)p(0,0,0,0,ra[pa]);rb.val(fa.getAttribute("spreadMethod")||"pad");var kb,fb=false;ta.setAttribute("fill-opacity",qa/100);$("#"+q+" div.grad_coord").mousedown(function(ja){ja.preventDefault();Xa=$(this);Xa.offset();kb=Xa.parent().offset();W.mousemove($a).mouseup(wb)});$("#"+q+"_jGraduate_Ok").bind("click touchstart",function(){u.paint.type=X;u.paint[X]=fa.cloneNode(true);u.paint.solidColor=null;Q()});$("#"+q+"_jGraduate_Cancel").bind("click touchstart",function(){L()});
if(X==="radialGradient")if(fb)Da.show();else{Da.hide();ia.fx.val("");ia.fy.val("")}$("#"+q+"_jGraduate_match_ctr")[0].checked=!fb;var xb,mb;$("#"+q+"_jGraduate_match_ctr").change(function(){fb=!this.checked;Da.toggle(fb);ia.fx.val("");ia.fy.val("");var ja=fa;if(fb){var aa=xb||0.5,ka=mb||0.5;ja.setAttribute("fx",aa);ja.setAttribute("fy",ka);ia.fx.val(aa);ia.fy.val(ka)}else{xb=ja.getAttribute("fx");mb=ja.getAttribute("fy");ja.removeAttribute("fx");ja.removeAttribute("fy")}});ra=fa.getElementsByTagNameNS(n.svg,
"stop");sa=ra.length;if(sa<2){for(;sa<2;){fa.appendChild(document.createElementNS(n.svg,"stop"));++sa}ra=fa.getElementsByTagNameNS(n.svg,"stop")}var ab;qa=O=0;if(X==="radialGradient"){ba=fa.gradientTransform.baseVal;if(ba.numberOfItems===2){sa=ba.getItem(0);ba=ba.getItem(1);if(sa.type===2&&ba.type===3){sa=ba.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==1)O=Math.round((1-sa.d)*100)}}else if(ba.numberOfItems===3){la=ba.getItem(0);sa=ba.getItem(1);ba=ba.getItem(2);if(la.type===4&&sa.type===
2&&ba.type===3){qa=Math.round(la.angle);sa=ba.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==1)O=Math.round((1-sa.d)*100)}}}O={radius:{handle:"#"+q+"_jGraduate_RadiusArrows",input:"#"+q+"_jGraduate_RadiusInput",val:(fa.getAttribute("r")||0.5)*100},opacity:{handle:"#"+q+"_jGraduate_OpacArrows",input:"#"+q+"_jGraduate_OpacInput",val:u.paint.alpha||100},ellip:{handle:"#"+q+"_jGraduate_EllipArrows",input:"#"+q+"_jGraduate_EllipInput",val:O},angle:{handle:"#"+q+"_jGraduate_AngleArrows",
input:"#"+q+"_jGraduate_AngleInput",val:qa}};$.each(O,function(ja,aa){var ka=$(aa.handle);ka.mousedown(function(N){var R=ka.parent();ab={type:ja,elem:ka,input:$(aa.input),parent:R,offset:R.offset()};W.mousemove(sb).mouseup(tb);N.preventDefault()});$(aa.input).val(aa.val).change(function(){var N=+this.value,R=0,ca=X==="radialGradient";switch(ja){case "radius":ca&&fa.setAttribute("r",N/100);R=Math.pow(N/100,0.4)/2*145;break;case "opacity":u.paint.alpha=N;ta.setAttribute("fill-opacity",N/100);R=N*1.45;
break;case "ellip":db=Ia=1;if(N===0){R=72.5;break}if(N>99.5)N=99.5;if(N>0)Ia=1-N/100;else db=-(N/100)-1;R=145*((N+100)/2)/100;ca&&d();break;case "angle":Ua=N;R=Ua/180;R+=0.5;R*=145;ca&&d()}if(R>145)R=145;else if(R<0)R=0;ka.css({"margin-left":R-5})}).change()});var sb=function(ja){var aa=ja.pageX-ab.offset.left-parseInt(ab.parent.css("border-left-width"));if(aa>145)aa=145;if(aa<=0)aa=0;var ka=aa-5;aa/=145;switch(ab.type){case "radius":aa=Math.pow(aa*2,2.5);if(aa>0.98&&aa<1.02)aa=1;if(aa<=0.01)aa=0.01;
fa.setAttribute("r",aa);break;case "opacity":u.paint.alpha=parseInt(aa*100);ta.setAttribute("fill-opacity",aa);break;case "ellip":Ia=db=1;if(aa<0.5){aa/=0.5;db=aa<=0?0.01:aa}else if(aa>0.5){aa/=0.5;aa=2-aa;Ia=aa<=0?0.01:aa}d();aa-=1;if(Ia===aa+1)aa=Math.abs(aa);break;case "angle":aa-=0.5;Ua=aa*=180;d();aa/=100}ab.elem.css({"margin-left":ka});aa=Math.round(aa*100);ab.input.val(aa);ja.preventDefault()},tb=function(){W.unbind("mousemove",sb).unbind("mouseup",tb);ab=null};for(O=(u.paint.alpha*255/100).toString(16);O.length<
2;)O="0"+O;O=O.split(".")[0];I=u.paint.solidColor=="none"?"":u.paint.solidColor+O;oa||(I=ra[0].getAttribute("stop-color"));$.extend($.fn.jPicker.defaults.window,{alphaSupport:true,effects:{type:"show",speed:0}});T.jPicker({window:{title:A.window.pickerTitle},images:{clientPath:A.images.clientPath},color:{active:I,alphaSupport:true}},function(ja){u.paint.type="solidColor";u.paint.alpha=ja.val("ahex")?Math.round(ja.val("a")/255*100):100;u.paint.solidColor=ja.val("hex")?ja.val("hex"):"none";u.paint.radialGradient=
null;Q()},null,function(){L()});var yb=$(M+" .jGraduate_tabs li");yb.on("click touchstart",function(){yb.removeClass("jGraduate_tab_current");$(this).addClass("jGraduate_tab_current");$(M+" > div").hide();var ja=$(this).attr("data-type");$(M+" .jGraduate_gradPick").show();if(ja==="rg"||ja==="lg"){$(".jGraduate_"+ja+"_field").show();$(".jGraduate_"+(ja==="lg"?"rg":"lg")+"_field").hide();$("#"+q+"_jgraduate_rect")[0].setAttribute("fill","url(#"+q+"_"+ja+"_jgraduate_grad)");X=ja==="lg"?"linearGradient":
"radialGradient";$("#"+q+"_jGraduate_OpacInput").val(u.paint.alpha).change();var aa=$("#"+q+"_"+ja+"_jgraduate_grad")[0];if(fa!==aa){var ka=$(fa).find("stop");$(aa).empty().append(ka);fa=aa;aa=rb.val();fa.setAttribute("spreadMethod",aa)}fb=ja==="rg"&&fa.getAttribute("fx")!=null&&!(La==Sa&&Ha==Ra);$("#"+q+"_jGraduate_focusCoord").toggle(fb);if(fb)$("#"+q+"_jGraduate_match_ctr")[0].checked=false}else{$(M+" .jGraduate_gradPick").hide();$(M+" .jGraduate_colPick").show()}});$(M+" > div").hide();yb.removeClass("jGraduate_tab_current");
var ib;switch(u.paint.type){case "linearGradient":ib=$(M+" .jGraduate_tab_lingrad");break;case "radialGradient":ib=$(M+" .jGraduate_tab_radgrad");break;default:ib=$(M+" .jGraduate_tab_color")}u.show();setTimeout(function(){ib.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.")})}})();jQuery&&function(){var a=$(window),n=$(document);$.extend($.fn,{contextMenu:function(e,b){if(e.menu==undefined)return false;if(e.inSpeed==undefined)e.inSpeed=150;if(e.outSpeed==undefined)e.outSpeed=75;if(e.inSpeed==0)e.inSpeed=-1;if(e.outSpeed==0)e.outSpeed=-1;$(this).each(function(){var k=$(this),p=$(k).offset(),c=$("#"+e.menu);c.addClass("contextMenu");$(this).bind("mousedown",function(d){$(this).on("mouseup",function(o){var u=$(this);u.unbind("mouseup");$(".contextMenu").hide();if(d.button===2||
e.allowLeft||d.ctrlKey&&svgedit.browser.isMac())svgedit.browser.isTouch()||g(o,d,u)})});svgedit.browser.isTouch()&&$(this).bind("taphold",function(d){var o=$(this);o.unbind("mouseup");g(d,d,o)});var g=function(d,o,u){if(typeof o=="undefined")o=d;d.stopPropagation();if(k.hasClass("disabled")||o.altKey)return false;var A=d.pageX,q=d.pageY;if(svgedit.browser.isTouch()){A=d.originalEvent.touches[0].pageX;q=d.originalEvent.touches[0].pageY}d=a.width()-c.width();o=a.height()-c.height();if(A>d-15)A=d-15;
if(q>o-30)q=o-30;if(svgedit.browser.isTouch())q-=c.height()/2;n.unbind("click");c.css({top:q,left:A}).fadeIn(e.inSpeed);c.find("A").mouseover(function(){c.find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){c.find("LI.hover").removeClass("hover")});n.keypress(function(M){switch(M.keyCode){case 38:if(c.find("LI.hover").length){c.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");c.find("LI.hover").length||c.find("LI:last").addClass("hover")}else c.find("LI:last").addClass("hover");
break;case 40:if(c.find("LI.hover").length==0)c.find("LI:first").addClass("hover");else{c.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");c.find("LI.hover").length||c.find("LI:first").addClass("hover")}break;case 13:c.find("LI.hover A").trigger("click");break;case 27:n.trigger("click")}});c.find("A").unbind("mouseup");c.find("LI:not(.disabled) A").mouseup(function(){n.unbind("click").unbind("keypress");$(".contextMenu").hide();b&&b($(this).attr("href").substr(1),
$(u),{x:A-p.left,y:q-p.top,docX:A,docY:q});return false});setTimeout(function(){n.click(function(){n.unbind("click").unbind("keypress");c.fadeOut(e.outSpeed);return false})},0)};$(k).add($("UL.contextMenu")).bind("contextmenu",function(){return false})});return $(this)},disableContextMenuItems:function(e){if(e==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined)for(var b=e.split(","),k=0;k<b.length;k++)$(this).find('A[href="'+b[k]+'"]').parent().addClass("disabled")});
return $(this)},enableContextMenuItems:function(e){if(e==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined)for(var b=e.split(","),k=0;k<b.length;k++)$(this).find('A[href="'+b[k]+'"]').parent().removeClass("disabled")});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},
destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})}(jQuery);var svgedit=svgedit||{};
(function(){if(!svgedit.browser)svgedit.browser={};var a=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;svgedit.browser.supportsSvg=function(){return a};if(svgedit.browser.supportsSvg()){var n=navigator.userAgent,e=document.createElementNS("http://www.w3.org/2000/svg","svg"),b=!!window.opera,k=n.indexOf("AppleWebKit")>=0,p=n.indexOf("Gecko/")>=0,c=n.indexOf("MSIE")>=0,g=n.indexOf("Chrome/")>=0,d=n.indexOf("Windows")>=0,o=n.indexOf("Macintosh")>=
0,u="ontouchstart"in window,A=!!e.querySelector,q=!!document.evaluate,M=function(){var da=document.createElementNS("http://www.w3.org/2000/svg","svg"),ma=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(da);ma.setAttribute("x",5);da.appendChild(ma);var Z=document.createElementNS("http://www.w3.org/2000/svg","text");Z.textContent="a";ma.appendChild(Z);ma=Z.getStartPositionOfChar(0);ma=ma.x;document.documentElement.removeChild(da);return ma===0}(),Q=
function(){var da=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(da);var ma=document.createElementNS("http://www.w3.org/2000/svg","path");ma.setAttribute("d","M0,0 C0,0 10,10 10,0");da.appendChild(ma);ma=ma.getBBox();document.documentElement.removeChild(da);return ma.height>4&&ma.height<5}(),L=function(){var da=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(da);var ma=document.createElementNS("http://www.w3.org/2000/svg",
"path");ma.setAttribute("d","M0,0 10,0");var Z=document.createElementNS("http://www.w3.org/2000/svg","path");Z.setAttribute("d","M5,0 15,0");var X=document.createElementNS("http://www.w3.org/2000/svg","g");X.appendChild(ma);X.appendChild(Z);da.appendChild(X);ma=X.getBBox();document.documentElement.removeChild(da);return ma.width==15}(),I=function(){var da=document.createElementNS("http://www.w3.org/2000/svg","rect");da.setAttribute("x",0.1);(da=da.cloneNode(false).getAttribute("x").indexOf(",")==
-1)||$.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n    Please upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed.");return da}(),W=function(){var da=document.createElementNS("http://www.w3.org/2000/svg","rect");da.setAttribute("style","vector-effect:non-scaling-stroke");return da.style.vectorEffect==="non-scaling-stroke"}(),T=function(){var da=document.createElementNS("http://www.w3.org/2000/svg","rect").transform.baseVal,
ma=e.createSVGTransform();da.appendItem(ma);return da.getItem(0)==ma}(),O=function(){if(typeof Blob!="function")return false;var da=new Blob(["<svg xmlns='http://www.w3.org/2000/svg'></svg>"],{type:"image/svg+xml;charset=utf-8"}),ma=new Image;ma.onload=function(){svgedit.browser.supportsBlobs=function(){return true}};ma.onerror=function(){svgedit.browser.supportsBlobs=function(){return false}};ma.src=URL.createObjectURL(da);return false}();svgedit.browser.isOpera=function(){return b};svgedit.browser.isWebkit=
function(){return k};svgedit.browser.isGecko=function(){return p};svgedit.browser.isIE=function(){return c};svgedit.browser.isChrome=function(){return g};svgedit.browser.isWindows=function(){return d};svgedit.browser.isMac=function(){return o};svgedit.browser.isTouch=function(){return u};svgedit.browser.supportsSelectors=function(){return A};svgedit.browser.supportsXpath=function(){return q};svgedit.browser.supportsPathBBox=function(){return Q};svgedit.browser.supportsHVLineContainerBBox=function(){return L};
svgedit.browser.supportsGoodTextCharPos=function(){return M};svgedit.browser.supportsEditableText=function(){return b};svgedit.browser.supportsGoodDecimals=function(){return I};svgedit.browser.supportsNonScalingStroke=function(){return W};svgedit.browser.supportsNativeTransformLists=function(){return T};svgedit.browser.supportsBlobs=function(){return O}}else window.location="browser-not-supported.html"})();svgedit=svgedit||{};
(function(){if(!svgedit.transformlist)svgedit.transformlist={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),n={};svgedit.transformlist.SVGTransformList=function(e){this._elem=e||null;this._xforms=[];this._update=function(){var b="";a.createSVGMatrix();for(var k=0;k<this.numberOfItems;++k){var p=this._list.getItem(k);b=b;p=p;var c=p.matrix,g="";switch(p.type){case 1:g="matrix("+[c.a,c.b,c.c,c.d,c.e,c.f].join(",")+")";break;case 2:g="translate("+c.e+","+c.f+")";break;case 3:g=
c.a==c.d?"scale("+c.a+")":"scale("+c.a+","+c.d+")";break;case 4:var d=0;g=0;if(p.angle!=0){d=1-c.a;g=(d*c.f+c.b*c.e)/(d*d+c.b*c.b);d=(c.e-c.b*g)/d}g="rotate("+p.angle+" "+d+","+g+")"}b=b+(g+" ")}this._elem.setAttribute("transform",b)};this._list=this;this._init=function(){var b=this._elem.getAttribute("transform");if(b)for(var k=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,p=true;p;){p=b.match(k);b=b.replace(k,"");if(p&&p[1]){var c=p[1].split(/\s*\(/),g=c[0];c=c[1].match(/\s*(.*?)\s*\)/);
c[1]=c[1].replace(/(\d)-/g,"$1 -");var d=c[1].split(/[, ]+/),o="abcdef".split(""),u=a.createSVGMatrix();$.each(d,function(M,Q){d[M]=parseFloat(Q);if(g=="matrix")u[o[M]]=d[M]});c=a.createSVGTransform();var A="set"+g.charAt(0).toUpperCase()+g.slice(1),q=g=="matrix"?[u]:d;if(g=="scale"&&q.length==1)q.push(q[0]);else if(g=="translate"&&q.length==1)q.push(0);else if(g=="rotate"&&q.length==1){q.push(0);q.push(0)}c[A].apply(c,q);this._list.appendItem(c)}}};this._removeFromOtherLists=function(b){if(b){var k=
false,p;for(p in n){for(var c=n[p],g=0,d=c._xforms.length;g<d;++g)if(c._xforms[g]==b){k=true;c.removeItem(g);break}if(k)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(b){this.numberOfItems=1;this._removeFromOtherLists(b);this._xforms=[b]};this.getItem=function(b){if(b<this.numberOfItems&&b>=0)return this._xforms[b];throw{code:1};};this.insertItemBefore=function(b,k){var p=null;if(k>=0)if(k<this.numberOfItems){this._removeFromOtherLists(b);
p=Array(this.numberOfItems+1);for(var c=0;c<k;++c)p[c]=this._xforms[c];p[c]=b;for(var g=c+1;c<this.numberOfItems;++g,++c)p[g]=this._xforms[c];this.numberOfItems++;this._xforms=p;p=b;this._list._update()}else p=this._list.appendItem(b);return p};this.replaceItem=function(b,k){var p=null;if(k<this.numberOfItems&&k>=0){this._removeFromOtherLists(b);p=this._xforms[k]=b;this._list._update()}return p};this.removeItem=function(b){if(b<this.numberOfItems&&b>=0){for(var k=this._xforms[b],p=Array(this.numberOfItems-
1),c=0;c<b;++c)p[c]=this._xforms[c];for(b=c;b<this.numberOfItems-1;++b,++c)p[b]=this._xforms[c+1];this.numberOfItems--;this._xforms=p;this._list._update();return k}else throw{code:1};};this.appendItem=function(b){this._removeFromOtherLists(b);this._xforms.push(b);this.numberOfItems++;this._list._update();return b}};svgedit.transformlist.resetListMap=function(){n={}};svgedit.transformlist.removeElementFromListMap=function(e){e.id&&n[e.id]&&delete n[e.id]};svgedit.transformlist.getTransformList=function(e){if(svgedit.browser.supportsNativeTransformLists())if(e.transform)return e.transform.baseVal;
else if(e.gradientTransform)return e.gradientTransform.baseVal;else{if(e.patternTransform)return e.patternTransform.baseVal}else{var b=e.id;b||(b="temp");var k=n[b];if(!k||b=="temp"){n[b]=new svgedit.transformlist.SVGTransformList(e);n[b]._init();k=n[b]}return k}return null}})();svgedit=svgedit||{};
(function(){if(!svgedit.math)svgedit.math={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(n,e,b){return{x:b.a*n+b.c*e+b.e,y:b.b*n+b.d*e+b.f}};svgedit.math.isIdentity=function(n){return n.a===1&&n.b===0&&n.c===0&&n.d===1&&n.e===0&&n.f===0};svgedit.math.matrixMultiply=function(){for(var n=arguments,e=n.length,b=n[e-1];e-- >1;)b=n[e-1].multiply(b);if(Math.abs(b.a)<1.0E-14)b.a=0;if(Math.abs(b.b)<1.0E-14)b.b=0;if(Math.abs(b.c)<1.0E-14)b.c=0;if(Math.abs(b.d)<
1.0E-14)b.d=0;if(Math.abs(b.e)<1.0E-14)b.e=0;if(Math.abs(b.f)<1.0E-14)b.f=0;return b};svgedit.math.hasMatrixTransform=function(n){if(!n)return false;for(var e=n.numberOfItems;e--;){var b=n.getItem(e);if(b.type==1&&!svgedit.math.isIdentity(b.matrix))return true}return false};svgedit.math.transformBox=function(n,e,b,k,p){var c={x:n,y:e},g={x:n+b,y:e};b={x:n+b,y:e+k};n={x:n,y:e+k};e=svgedit.math.transformPoint;c=e(c.x,c.y,p);var d=k=c.x,o=c.y,u=c.y;g=e(g.x,g.y,p);k=Math.min(k,g.x);d=Math.max(d,g.x);
o=Math.min(o,g.y);u=Math.max(u,g.y);n=e(n.x,n.y,p);k=Math.min(k,n.x);d=Math.max(d,n.x);o=Math.min(o,n.y);u=Math.max(u,n.y);b=e(b.x,b.y,p);k=Math.min(k,b.x);d=Math.max(d,b.x);o=Math.min(o,b.y);u=Math.max(u,b.y);return{tl:c,tr:g,bl:n,br:b,aabox:{x:k,y:o,width:d-k,height:u-o}}};svgedit.math.transformListToTransform=function(n,e,b){if(n==null)return a.createSVGTransformFromMatrix(a.createSVGMatrix());e=e==undefined?0:e;b=b==undefined?n.numberOfItems-1:b;e=parseInt(e);b=parseInt(b);if(e>b){var k=b;b=e;
e=k}k=a.createSVGMatrix();for(e=e;e<=b;++e){var p=e>=0&&e<n.numberOfItems?n.getItem(e).matrix:a.createSVGMatrix();k=svgedit.math.matrixMultiply(k,p)}return a.createSVGTransformFromMatrix(k)};svgedit.math.getMatrix=function(n){n=svgedit.transformlist.getTransformList(n);return svgedit.math.transformListToTransform(n).matrix};svgedit.math.snapToAngle=function(n,e,b,k){var p=Math.PI/4;b=b-n;var c=k-e;k=Math.sqrt(b*b+c*c);p=Math.round(Math.atan2(c,b)/p)*p;return{x:n+k*Math.cos(p),y:e+k*Math.sin(p),a:p}};
svgedit.math.rectsIntersect=function(n,e){if(!n||!e)return false;return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}})();svgedit=svgedit||{};
(function(){if(!svgedit.units)svgedit.units={};var a=["x","x1","cx","rx","width"],n=["y","y1","cy","ry","height"],e=$.merge(["r","radius"],a);$.merge(e,n);var b,k={px:1};svgedit.units.init=function(c){b=c;c=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(c);var g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("width","1em");g.setAttribute("height","1ex");g.setAttribute("x","1in");c.appendChild(g);g=g.getBBox();document.body.removeChild(c);
c=g.x;k.em=g.width;k.ex=g.height;k["in"]=c;k.cm=c/2.54;k.mm=c/25.4;k.pt=c/72;k.pc=c/6;k["%"]=0};svgedit.units.getTypeMap=function(){return k};svgedit.units.shortFloat=function(c){var g=b.getRoundDigits();if(isNaN(c)){if($.isArray(c))return svgedit.units.shortFloat(c[0])+","+svgedit.units.shortFloat(c[1])}else return+(+c).toFixed(g);return parseFloat(c).toFixed(g)-0};svgedit.units.convertUnit=function(c,g){g=g||b.getBaseUnit();return svgedit.unit.shortFloat(c/k[g])};svgedit.units.setUnitAttr=function(c,
g,d){isNaN(d)||c.getAttribute(g);c.setAttribute(g,d)};var p={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(c){var g=c.tagName,d=b.getBaseUnit();if(g=p[g])for(var o=g.length,u=0;u<o;u++){var A=g[u],q=c.getAttribute(A);if(q)isNaN(q)||c.setAttribute(A,q/k[d]+d)}};svgedit.units.convertToNum=
function(c,g){if(!isNaN(g))return g-0;if(g.substr(-1)==="%"){var d=g.substr(0,g.length-1)/100,o=b.getWidth(),u=b.getHeight();return a.indexOf(c)>=0?d*o:n.indexOf(c)>=0?d*u:d*Math.sqrt(o*o+u*u)/Math.sqrt(2)}else{o=g.substr(-2);d=g.substr(0,g.length-2);return d*k[o]}};svgedit.units.isValidUnit=function(c,g,d){var o=false;if(e.indexOf(c)>=0)if(isNaN(g)){g=g.toLowerCase();$.each(k,function(q){if(!o)if(RegExp("^-?[\\d\\.]+"+q+"$").test(g))o=true})}else o=true;else if(c=="id"){c=false;try{var u=b.getElement(g);
c=u==null||u===d}catch(A){}return c}else o=true;return o}})();svgedit=svgedit||{};
(function(){function a(c){if(svgedit.browser.supportsHVLineContainerBBox())try{return c.getBBox()}catch(g){}var d=$.data(c,"ref"),o=null;if(d){var u=$(d).children().clone().attr("visibility","hidden");$(p).append(u);o=u.filter("line, path")}else o=$(c).find("line, path");var A=false;if(o.length){o.each(function(){var q=this.getBBox();if(!q.width||!q.height)A=true});if(A){c=d?u:$(c).children();ret=getStrokedBBox(c)}else ret=c.getBBox()}else ret=c.getBBox();d&&u.remove();return ret}if(!svgedit.utilities)svgedit.utilities=
{};var n="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),e=null,b=null,k=null,p=null;svgedit.utilities.init=function(c){e=c;b=c.getDOMDocument();k=c.getDOMContainer();p=c.getSVGRoot()};svgedit.utilities.toXml=function(c){return $("<p/>").text(c).html()};svgedit.utilities.fromXml=function(c){return $("<p/>").html(c).text()};svgedit.utilities.encode64=function(c){c=svgedit.utilities.convertToXMLReferences(c);if(window.btoa)return window.btoa(c);
var g=Array(Math.floor((c.length+2)/3)*4),d,o,u,A,q,M,Q=0,L=0;do{d=c.charCodeAt(Q++);o=c.charCodeAt(Q++);u=c.charCodeAt(Q++);A=d>>2;d=(d&3)<<4|o>>4;q=(o&15)<<2|u>>6;M=u&63;if(isNaN(o))q=M=64;else if(isNaN(u))M=64;g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(A);g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d);g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q);g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(M)}while(Q<
c.length);return g.join("")};svgedit.utilities.decode64=function(c){if(window.atob)return window.atob(c);var g="",d,o,u="",A,q="",M=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(M++));o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(M++));A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(M++));q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(M++));
d=d<<2|o>>4;o=(o&15)<<4|A>>2;u=(A&3)<<6|q;g+=String.fromCharCode(d);if(A!=64)g+=String.fromCharCode(o);if(q!=64)g+=String.fromCharCode(u)}while(M<c.length);return unescape(g)};svgedit.utilities.convertToXMLReferences=function(c){for(var g="",d=0;d<c.length;d++){var o=c.charCodeAt(d);if(o<128)g+=c[d];else if(o>127)g+="&#"+o+";"}return g};svgedit.utilities.text2xml=function(c){if(c.indexOf("<svg:svg")>=0)c=c.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns");var g;try{var d=window.DOMParser?
new DOMParser:new ActiveXObject("Microsoft.XMLDOM");d.async=false}catch(o){throw Error("XML Parser could not be instantiated");}try{g=d.loadXML?d.loadXML(c)?d:false:d.parseFromString(c,"text/xml")}catch(u){throw Error("Error parsing XML string");}return g};svgedit.utilities.bboxToObj=function(c){return{x:c.x,y:c.y,width:c.width,height:c.height}};svgedit.utilities.walkTree=function(c,g){if(c&&c.nodeType==1){g(c);for(var d=c.childNodes.length;d--;)svgedit.utilities.walkTree(c.childNodes.item(d),g)}};
svgedit.utilities.walkTreePost=function(c,g){if(c&&c.nodeType==1){for(var d=c.childNodes.length;d--;)svgedit.utilities.walkTree(c.childNodes.item(d),g);g(c)}};svgedit.utilities.getUrlFromAttr=function(c){if(c)if(c.indexOf('url("')===0)return c.substring(5,c.indexOf('"',6));else if(c.indexOf("url('")===0)return c.substring(5,c.indexOf("'",6));else if(c.indexOf("url(")===0)return c.substring(4,c.indexOf(")"));return null};svgedit.utilities.getHref=function(c){if(c)return c.getAttributeNS("http://www.w3.org/1999/xlink",
"href")};svgedit.utilities.setHref=function(c,g){c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g)};svgedit.utilities.findDefs=function(c){c=e.getSVGContent().documentElement;var g=c.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs");return g=g.length>0?g[0]:c.insertBefore(c.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),c.firstChild.nextSibling)};svgedit.utilities.getPathBBox=function(c){var g=c.pathSegList,d=g.numberOfItems;c=[[],[]];var o=g.getItem(0),
u=[o.x,o.y];for(o=0;o<d;o++){var A=g.getItem(o);if(typeof A.x!="undefined"){c[0].push(u[0]);c[1].push(u[1]);if(A.x1){for(var q=[A.x1,A.y1],M=[A.x2,A.y2],Q=[A.x,A.y],L=0;L<2;L++){A=function(da){return Math.pow(1-da,3)*u[L]+3*Math.pow(1-da,2)*da*q[L]+3*(1-da)*Math.pow(da,2)*M[L]+Math.pow(da,3)*Q[L]};var I=6*u[L]-12*q[L]+6*M[L],W=-3*u[L]+9*q[L]-9*M[L]+3*Q[L],T=3*q[L]-3*u[L];if(W==0){if(I!=0){I=-T/I;0<I&&I<1&&c[L].push(A(I))}}else{T=Math.pow(I,2)-4*T*W;if(!(T<0)){var O=(-I+Math.sqrt(T))/(2*W);0<O&&O<
1&&c[L].push(A(O));I=(-I-Math.sqrt(T))/(2*W);0<I&&I<1&&c[L].push(A(I))}}}u=Q}else{c[0].push(A.x);c[1].push(A.y)}}}g=Math.min.apply(null,c[0]);d=Math.max.apply(null,c[0])-g;o=Math.min.apply(null,c[1]);c=Math.max.apply(null,c[1])-o;return{x:g,y:o,width:d,height:c}};svgedit.utilities.getBBox=function(c){var g=c||e.getSelectedElements()[0];if(c.nodeType!=1)return null;c=null;var d=g.nodeName;switch(d){case "text":if(g.textContent===""){g.textContent="a";c=g.getBBox();g.textContent=""}else try{c=g.getBBox()}catch(o){}break;
case "path":if(svgedit.browser.supportsPathBBox())try{c=g.getBBox()}catch(u){}else c=svgedit.utilities.getPathBBox(g);break;case "g":case "a":c=a(g);break;default:if(d==="use")c=a(g,true);if(d==="use")c||(c=g.getBBox());else if(~n.indexOf(d))try{c=g.getBBox()}catch(A){g=$(g).closest("foreignObject");if(g.length)try{c=g[0].getBBox()}catch(q){c=null}else c=null}}if(c)c=svgedit.utilities.bboxToObj(c);return c};svgedit.utilities.getRotationAngle=function(c,g){var d=c||e.getSelectedElements()[0];d=svgedit.transformlist.getTransformList(d);
if(!d)return 0;for(var o=d.numberOfItems,u=0;u<o;++u){var A=d.getItem(u);if(A.type==4)return g?A.angle*Math.PI/180:A.angle}return 0};svgedit.utilities.getElem=svgedit.browser.supportsSelectors()?function(c){return p.querySelector("#"+c)}:svgedit.browser.supportsXpath()?function(c){return b.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+c+'"]',k,function(){return"http://www.w3.org/2000/svg"},9,null).singleNodeValue}:function(c){return $(p).find("[id="+c+"]")[0]};svgedit.utilities.assignAttributes=
function(c,g,d,o){for(var u in g)if(d=u.substr(0,4)==="xml:"?"http://www.w3.org/XML/1998/namespace":u.substr(0,6)==="xlink:"?"http://www.w3.org/1999/xlink":null)c.setAttributeNS(d,u,g[u]);else o?svgedit.units.setUnitAttr(c,u,g[u]):c.setAttribute(u,g[u])};svgedit.utilities.cleanupElement=function(c){var g={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0},d;for(d in g){var o=
g[d];c.getAttribute(d)==o&&c.removeAttribute(d)}}})();svgedit=svgedit||{};
(function(){if(!svgedit.sanitize)svgedit.sanitize={};var a={};a["http://www.w3.org/1999/xlink"]="xlink";a["http://www.w3.org/XML/1998/namespace"]="xml";a["http://www.w3.org/2000/xmlns/"]="xmlns";a["http://svg-edit.googlecode.com"]="se";a["http://www.w3.org/1999/xhtml"]="xhtml";a["http://www.w3.org/1998/Math/MathML"]="mathml";var n={};$.each(a,function(k,p){n[p]=k});var e={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray",
"stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class",
"clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters",
"filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage",
"transform","font-family","font-size","font-style","font-weight","text-anchor","data-locked"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x",
"y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox",
"width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid",
"marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask",
"opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se",
"xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule",
"filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill",
"fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],
mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],
semantics:[]},b={};$.each(e,function(k,p){var c={};$.each(p,function(g,d){if(d.indexOf(":")>=0){var o=d.split(":");c[o[1]]=n[o[0]]}else c[d]=d=="xmlns"?"http://www.w3.org/2000/xmlns/":null});b[k]=c});svgedit.sanitize.getNSMap=function(){return a};svgedit.sanitize.sanitizeSvg=function(k){if(k.nodeType==3){k.nodeValue=k.nodeValue.replace(/^\s+|\s+$/g,"");k.nodeValue.length||k.parentNode.removeChild(k)}if(k.nodeType==1){var p=k.parentNode;if(k.ownerDocument&&p){var c=e[k.nodeName],g=b[k.nodeName];if(c!=
undefined){for(var d=[],o=k.attributes.length;o--;){var u=k.attributes.item(o),A=u.nodeName,q=u.localName,M=u.namespaceURI;if(!(g.hasOwnProperty(q)&&M==g[q]&&M!="http://www.w3.org/2000/xmlns/")&&!(M=="http://www.w3.org/2000/xmlns/"&&a[u.nodeValue])){A.indexOf("se:")==0&&d.push([A,u.nodeValue]);k.removeAttributeNS(M,q)}if(svgedit.browser.isGecko())switch(A){case "transform":case "gradientTransform":case "patternTransform":q=u.nodeValue.replace(/(\d)-/g,"$1 -");k.setAttribute(A,q)}if(A=="style"){u=
u.nodeValue.split(";");for(A=u.length;A--;){q=u[A].split(":");c.indexOf(q[0])>=0&&k.setAttribute(q[0],q[1])}k.removeAttribute("style")}}$.each(d,function(Q,L){k.setAttributeNS("http://svg-edit.googlecode.com",L[0],L[1])});if((o=svgedit.utilities.getHref(k))&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(k.nodeName)>=0)if(o[0]!="#"){svgedit.utilities.setHref(k,"");k.removeAttributeNS("http://www.w3.org/1999/xlink","href")}if(k.nodeName=="use"&&!svgedit.utilities.getHref(k))p.removeChild(k);
else{$.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(Q,L){var I=k.getAttribute(L);if(I)if((I=svgedit.utilities.getUrlFromAttr(I))&&I[0]!=="#"){k.setAttribute(L,"");k.removeAttribute(L)}});for(o=k.childNodes.length;o--;)svgedit.sanitize.sanitizeSvg(k.childNodes.item(o))}}else{for(c=[];k.hasChildNodes();)c.push(p.insertBefore(k.firstChild,k));p.removeChild(k);for(o=c.length;o--;)svgedit.sanitize.sanitizeSvg(c[o])}}}}})();svgedit=svgedit||{};
(function(){if(!svgedit.history)svgedit.history={};svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(a,n,e,b){this.elem=a;this.text=b?"Move "+a.tagName+" to "+b:"Move "+a.tagName;this.oldNextSibling=n;this.oldParent=e;this.newNextSibling=a.nextSibling;this.newParent=a.parentNode};svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"};svgedit.history.MoveElementCommand.prototype.type=
svgedit.history.MoveElementCommand.type;svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.MoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.MoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.InsertElementCommand=function(a,n){this.elem=a;this.text=n||"Create "+a.tagName;this.parent=a.parentNode;this.nextSibling=this.elem.nextSibling};svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"};svgedit.history.InsertElementCommand.prototype.type=
svgedit.history.InsertElementCommand.type;svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text};svgedit.history.InsertElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.InsertElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.parent=this.elem.parentNode;this.elem=this.elem.parentNode.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.RemoveElementCommand=function(a,n,e,b){this.elem=a;this.text=b||"Delete "+a.tagName;this.nextSibling=n;this.parent=e;svgedit.transformlist.removeElementFromListMap(a)};svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"};
svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type;svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.RemoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.parent=this.elem.parentNode;this.elem=this.parent.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,
this)};svgedit.history.RemoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.nextSibling==null&&window.console&&console.log("Error: reference element was lost");this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]};
svgedit.history.ChangeElementCommand=function(a,n,e){this.elem=a;this.text=e?"Change "+a.tagName+" "+e:"Change "+a.tagName;this.newValues={};this.oldValues=n;for(var b in n)this.newValues[b]=b=="#text"?a.textContent:b=="#href"?svgedit.utilities.getHref(a):a.getAttribute(b)};svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"};svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type;svgedit.history.ChangeElementCommand.prototype.getText=
function(){return this.text};svgedit.history.ChangeElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var n=false,e;for(e in this.newValues){if(this.newValues[e])if(e=="#text")this.elem.textContent=this.newValues[e];else e=="#href"?svgedit.utilities.setHref(this.elem,this.newValues[e]):this.elem.setAttribute(e,this.newValues[e]);else if(e=="#text")this.elem.textContent="";else{this.elem.setAttribute(e,"");this.elem.removeAttribute(e)}if(e==
"transform")n=true}if(!n)if(n=svgedit.utilities.getRotationAngle(this.elem)){e=elem.getBBox();n=["rotate(",n," ",e.x+e.width/2,",",e.y+e.height/2,")"].join("");n!=elem.getAttribute("transform")&&elem.setAttribute("transform",n)}a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var n=false,e;for(e in this.oldValues){if(this.oldValues[e])if(e==
"#text")this.elem.textContent=this.oldValues[e];else e=="#href"?svgedit.utilities.setHref(this.elem,this.oldValues[e]):this.elem.setAttribute(e,this.oldValues[e]);else if(e=="#text")this.elem.textContent="";else this.elem.removeAttribute(e);if(e=="transform")n=true}if(!n)if(n=svgedit.utilities.getRotationAngle(this.elem)){e=this.elem.getBBox();n=["rotate(",n," ",e.x+e.width/2,",",e.y+e.height/2,")"].join("");n!=this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",n)}svgedit.transformlist.removeElementFromListMap(this.elem);
a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.BatchCommand=function(a){this.text=a||"Batch Command";this.stack=[]};svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"};svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type;svgedit.history.BatchCommand.prototype.getText=function(){return this.text};svgedit.history.BatchCommand.prototype.apply=
function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var n=this.stack.length,e=0;e<n;++e)this.stack[e].apply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.BatchCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var n=this.stack.length-1;n>=0;n--)this.stack[n].unapply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,
this)};svgedit.history.BatchCommand.prototype.elements=function(){for(var a=[],n=this.stack.length;n--;)for(var e=this.stack[n].elements(),b=e.length;b--;)a.indexOf(e[b])==-1&&a.push(e[b]);return a};svgedit.history.BatchCommand.prototype.addSubCommand=function(a){this.stack.push(a)};svgedit.history.BatchCommand.prototype.isEmpty=function(){return this.stack.length==0};svgedit.history.UndoManager=function(a){this.handler_=a||null;this.undoStackPointer=0;this.undoStack=[];this.undoChangeStackPointer=
-1;this.undoableChangeStack=[]};svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[];this.undoStackPointer=0};svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer};svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer};svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():
""};svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""};svgedit.history.UndoManager.prototype.undo=function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)};svgedit.history.UndoManager.prototype.redo=function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)};
svgedit.history.UndoManager.prototype.addCommandToHistory=function(a){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0)this.undoStack=this.undoStack.splice(0,this.undoStackPointer);this.undoStack.push(a);this.undoStackPointer=this.undoStack.length};svgedit.history.UndoManager.prototype.beginUndoableChange=function(a,n){for(var e=++this.undoChangeStackPointer,b=n.length,k=Array(b),p=Array(b);b--;){var c=n[b];if(c!=null){p[b]=c;k[b]=c.getAttribute(a)}}this.undoableChangeStack[e]=
{attrName:a,oldValues:k,elements:p}};svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var a=this.undoChangeStackPointer--,n=this.undoableChangeStack[a],e=n.elements.length,b=n.attrName,k=new svgedit.history.BatchCommand("Change "+b);e--;){var p=n.elements[e];if(p!=null){var c={};c[b]=n.oldValues[e];c[b]!=p.getAttribute(b)&&k.addSubCommand(new svgedit.history.ChangeElementCommand(p,c,b))}}this.undoableChangeStack[a]=null;return k}})();svgedit=svgedit||{};
(function(){if(!svgedit.select)svgedit.select={};var a,n,e;svgedit.select.Selector=function(b,k){this.id=b;this.selectedElement=k;this.locked=true;this.selectorGroup=a.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}});this.selectorRect=this.selectorGroup.appendChild(a.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#4F80FF","stroke-width":"1","shape-rendering":"crispEdges",style:"pointer-events:none"}}));svgedit.browser.isTouch()&&this.selectorRect.setAttribute("stroke-opacity",
0.3);this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.reset(this.selectedElement)};svgedit.select.Selector.prototype.reset=function(b){this.locked=true;this.selectedElement=b;this.resize();this.selectorGroup.setAttribute("display","inline")};svgedit.select.Selector.prototype.updateGripCursors=function(b){var k=[];b=Math.round(b/45);if(b<0)b+=8;for(var p in e.selectorGrips)k.push(p);for(;b>0;){k.push(k.shift());b--}b=0;for(p in e.selectorGrips){e.selectorGrips[p].setAttribute("style",
"cursor:"+k[b]+"-resize");b++}};svgedit.select.Selector.prototype.showGrips=function(b){e.selectorGripsGroup.setAttribute("display",b?"inline":"none");var k=this.selectedElement;this.hasGrips=b;if(k&&b){this.selectorGroup.appendChild(e.selectorGripsGroup);this.updateGripCursors(svgedit.utilities.getRotationAngle(k))}};svgedit.select.Selector.prototype.resize=function(){var b=this.selectorRect,k=e,p=k.selectorGrips,c=this.selectedElement,g=c.getAttribute("stroke-width"),d=a.currentZoom(),o=1/d;if(c.getAttribute("stroke")!==
"none"&&!isNaN(g))o+=g/2;var u=c.tagName;if(u==="text")o+=2/d;g=svgedit.transformlist.getTransformList(c);g=svgedit.math.transformListToTransform(g).matrix;g.e*=d;g.f*=d;var A=svgedit.utilities.getBBox(c);if(u==="g"&&!$.data(c,"gsvg"))if(u=a.getStrokedBBox(c.childNodes))A=u;u=A.x;var q=A.y,M=A.width;A=A.height;o*=d;d=svgedit.math.transformBox(u*d,q*d,M*d,A*d,g);g=d.aabox;u=g.x-o;q=g.y-o;var Q=g.width+o*2;M=g.height+o*2;g=u+Q/2;A=q+M/2;if(c=svgedit.utilities.getRotationAngle(c)){u=a.svgRoot().createSVGTransform();
u.setRotate(-c,g,A);u=u.matrix;d.tl=svgedit.math.transformPoint(d.tl.x,d.tl.y,u);d.tr=svgedit.math.transformPoint(d.tr.x,d.tr.y,u);d.bl=svgedit.math.transformPoint(d.bl.x,d.bl.y,u);d.br=svgedit.math.transformPoint(d.br.x,d.br.y,u);u=d.tl;Q=u.x;M=u.y;var L=u.x,I=u.y;u=Math.min;q=Math.max;Q=u(Q,u(d.tr.x,u(d.bl.x,d.br.x)))-o;M=u(M,u(d.tr.y,u(d.bl.y,d.br.y)))-o;L=q(L,q(d.tr.x,q(d.bl.x,d.br.x)))+o;I=q(I,q(d.tr.y,q(d.bl.y,d.br.y)))+o;u=Q;q=M;Q=L-Q;M=I-M}b.setAttribute("d","M"+u+","+q+" L"+(u+Q)+","+q+" "+
(u+Q)+","+(q+M)+" "+u+","+(q+M)+"z");this.selectorGroup.setAttribute("transform",c?"rotate("+[c,g,A].join(",")+")":"");if(svgedit.browser.isTouch()){u-=15.75;q-=15.75}else{u-=4;q-=4}this.gripCoords={nw:[u,q].map(Math.round),ne:[u+Q,q].map(Math.round),sw:[u,q+M].map(Math.round),se:[u+Q,q+M].map(Math.round),n:[u+Q/2,q].map(Math.round),w:[u,q+M/2].map(Math.round),e:[u+Q,q+M/2].map(Math.round),s:[u+Q/2,q+M].map(Math.round)};for(var W in this.gripCoords){b=this.gripCoords[W];p[W].setAttribute("x",b[0]);
p[W].setAttribute("y",b[1])}this.rotateCoords={nw:[u,q],ne:[u+Q+8,q],sw:[u,q+M+8],se:[u+Q+8,q+M+8]};for(W in this.rotateCoords){b=this.rotateCoords[W];k.rotateGrips[W].setAttribute("cx",b[0]);k.rotateGrips[W].setAttribute("cy",b[1])}};svgedit.select.SelectorManager=function(){this.rubberBandBox=this.selectorParentGroup=null;this.selectors=[];this.selectorMap={};this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.selectorGripsGroup=null;this.rotateGrips={nw:null,ne:null,
se:null,sw:null};this.initGroup()};svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup);this.selectorParentGroup=a.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}});this.selectorGripsGroup=a.createSVGElement({element:"g",attr:{display:"none"}});this.selectorParentGroup.appendChild(this.selectorGripsGroup);a.svgRoot().appendChild(this.selectorParentGroup);
this.selectorMap={};this.selectors=[];this.rubberBandBox=null;for(var b in this.rotateGrips){var k=a.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate_"+b,fill:"#000",r:8,stroke:"#000","fill-opacity":0,"stroke-opacity":0,"stroke-width":0,style:"cursor:url("+n.imgPath+"rotate.png) 12 12, auto;"}});$.data(k,"dir",b);$.data(k,"type","rotate");this.rotateGrips[b]=this.selectorGripsGroup.appendChild(k)}for(b in this.selectorGrips){k=a.createSVGElement({element:"rect",attr:{id:"selectorGrip_resize_"+
b,width:8,height:8,fill:"#4F80FF",stroke:"rgba(0,0,0,0)","stroke-width":1,style:"cursor:"+b+"-resize","pointer-events":"all"}});if(svgedit.browser.isTouch()){k.setAttribute("width",30.5);k.setAttribute("height",30.5);k.setAttribute("fill-opacity",0.3)}$.data(k,"dir",b);$.data(k,"type","resize");this.selectorGrips[b]=this.selectorGripsGroup.appendChild(k)}if(!$("#canvasBackground").length){b=n.dimensions;b=a.createSVGElement({element:"svg",attr:{id:"canvasBackground",width:b[0],height:b[1],x:0,y:0,
overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}});k=a.createSVGElement({element:"defs",attr:{id:"placeholder_defs"}});var p=a.createSVGElement({element:"pattern",attr:{id:"checkerPattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20,viewBox:"0 0 10 10"}}),c=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:10,height:10,fill:"#fff"}}),g=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:5,height:5,fill:"#eee"}}),d=a.createSVGElement({element:"rect",
attr:{x:5,y:5,width:5,height:5,fill:"#eee"}}),o=a.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"url(#checkerPattern)",style:"pointer-events:none"}});b.appendChild(k);k.appendChild(p);p.appendChild(c);p.appendChild(g);p.appendChild(d);b.appendChild(o);a.svgRoot().insertBefore(b,a.svgContent())}};svgedit.select.SelectorManager.prototype.requestSelector=function(b){if(b==null)return null;var k=this.selectors.length;if(typeof this.selectorMap[b.id]==
"object"){this.selectorMap[b.id].locked=true;return this.selectorMap[b.id]}for(var p=0;p<k;++p)if(this.selectors[p]&&!this.selectors[p].locked){this.selectors[p].locked=true;this.selectors[p].reset(b);this.selectorMap[b.id]=this.selectors[p];return this.selectors[p]}this.selectors[k]=new svgedit.select.Selector(k,b);this.selectorParentGroup.appendChild(this.selectors[k].selectorGroup);this.selectorMap[b.id]=this.selectors[k];return this.selectors[k]};svgedit.select.SelectorManager.prototype.releaseSelector=
function(b){if(b!=null)for(var k=this.selectors.length,p=this.selectorMap[b.id],c=0;c<k;++c)if(this.selectors[c]&&this.selectors[c]==p){p.locked==false&&console.log("WARNING! selector was released but was already unlocked");delete this.selectorMap[b.id];p.locked=false;p.selectedElement=null;p.showGrips(false);try{p.selectorGroup.setAttribute("display","none")}catch(g){}break}};svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){if(!this.rubberBandBox)this.rubberBandBox=this.selectorParentGroup.appendChild(a.createSVGElement({element:"rect",
attr:{id:"selectorRubberBand",fill:"none",stroke:"#666","stroke-width":1,"stroke-dasharray":"3,2",display:"none",style:"pointer-events:none"}}));return this.rubberBandBox};svgedit.select.init=function(b,k){n=b;a=k;e=new svgedit.select.SelectorManager;a.createSVGElement({element:"g",attr:{id:"hover_group"}})};svgedit.select.getSelectorManager=function(){return e}})();svgedit=svgedit||{};
(function(){if(!svgedit.draw)svgedit.draw={};var a="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),n={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},e=n.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(b,k){this.name_=b;this.group_=k};svgedit.draw.Layer.prototype.getName=function(){return this.name_};svgedit.draw.Layer.prototype.getGroup=function(){return this.group_};svgedit.draw.randomizeIds=function(b,k){e=b==false?n.NEVER_RANDOMIZE:
n.ALWAYS_RANDOMIZE;if(e==n.ALWAYS_RANDOMIZE&&!k.getNonce())k.setNonce(Math.floor(Math.random()*100001));else e==n.NEVER_RANDOMIZE&&k.getNonce()&&k.clearNonce()};svgedit.draw.Drawing=function(b,k){if(!b||!b.tagName||!b.namespaceURI||b.tagName!="svg"||b.namespaceURI!="http://www.w3.org/2000/svg")throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=b;this.obj_num=0;this.idPrefix=k||"svg_";this.releasedNums=[];this.all_layers=[];this.current_layer=null;this.nonce_=
"";var p=this.svgElem_.getAttributeNS("http://svg-edit.googlecode.com","nonce");if(p&&e!=n.NEVER_RANDOMIZE)this.nonce_=p;else e==n.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(Math.random()*100001))};svgedit.draw.Drawing.prototype.getElem_=function(b){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+b):$(this.svgElem_).find("[id="+b+"]")[0]};svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_};svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_};
svgedit.draw.Drawing.prototype.setNonce=function(b){this.svgElem_.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:se","http://svg-edit.googlecode.com");this.svgElem_.setAttributeNS("http://svg-edit.googlecode.com","se:nonce",b);this.nonce_=b};svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""};svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num};svgedit.draw.Drawing.prototype.getNextId=function(){var b=
this.obj_num,k=false;if(this.releasedNums.length>0){this.obj_num=this.releasedNums.pop();k=true}else this.obj_num++;for(var p=this.getId();this.getElem_(p);){if(k){this.obj_num=b;k=false}this.obj_num++;p=this.getId()}if(k)this.obj_num=b;return p};svgedit.draw.Drawing.prototype.releaseId=function(b){var k=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if(typeof b!="string"||b.indexOf(k)!=0)return false;b=parseInt(b.substr(k.length));if(typeof b!="number"||b<=0||this.releasedNums.indexOf(b)!=-1)return false;
this.releasedNums.push(b);return true};svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length};svgedit.draw.Drawing.prototype.hasLayer=function(b){for(var k=0;k<this.getNumLayers();k++)if(this.all_layers[k][0]==b)return true;return false};svgedit.draw.Drawing.prototype.getLayerName=function(b){if(b>=0&&b<this.getNumLayers())return this.all_layers[b][0];return""};svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer};svgedit.draw.Drawing.prototype.getCurrentLayerName=
function(){for(var b=0;b<this.getNumLayers();++b)if(this.all_layers[b][1]==this.current_layer)return this.getLayerName(b);return""};svgedit.draw.Drawing.prototype.setCurrentLayer=function(b){for(var k=0;k<this.getNumLayers();++k)if(b==this.getLayerName(k)){if(this.current_layer!=this.all_layers[k][1]){this.current_layer.setAttribute("style","pointer-events:none");this.current_layer=this.all_layers[k][1];this.current_layer.setAttribute("style","pointer-events:all")}return true}return false};svgedit.draw.Drawing.prototype.deleteCurrentLayer=
function(){if(this.current_layer&&this.getNumLayers()>1){var b=this.current_layer.parentNode.removeChild(this.current_layer);this.identifyLayers();return b}return null};svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var b=this.svgElem_.childNodes.length,k=[],p=[],c=null,g=false,d=0;d<b;++d){var o=this.svgElem_.childNodes.item(d);if(o&&o.nodeType==1)if(o.tagName=="g"){g=true;var u=$("title",o).text();if(!u&&svgedit.browser.isOpera()&&o.querySelectorAll)u=$(o.querySelectorAll("title")).text();
if(u){p.push(u);this.all_layers.push([u,o]);c=o;svgedit.utilities.walkTree(o,function(A){A.setAttribute("style","pointer-events:inherit")});c.setAttribute("style","pointer-events:none")}else k.push(o)}else if(~a.indexOf(o.nodeName)){svgedit.utilities.getBBox(o);k.push(o)}}b=this.svgElem_.ownerDocument;if(k.length>0||!g){for(d=1;p.indexOf("Layer "+d)>=0;)d++;p="Layer "+d;c=b.createElementNS("http://www.w3.org/2000/svg","g");g=b.createElementNS("http://www.w3.org/2000/svg","title");g.textContent=p;
c.appendChild(g);for(g=0;g<k.length;++g)c.appendChild(k[g]);this.svgElem_.appendChild(c);this.all_layers.push([p,c])}svgedit.utilities.walkTree(c,function(A){A.setAttribute("style","pointer-events:inherit")});this.current_layer=c.getAttribute("data-locked")==="true"?this.all_layers.slice(-2)[0][1]:c;this.current_layer.setAttribute("style","pointer-events:all")};svgedit.draw.Drawing.prototype.createLayer=function(b){var k=this.svgElem_.ownerDocument,p=k.createElementNS("http://www.w3.org/2000/svg",
"g");k=k.createElementNS("http://www.w3.org/2000/svg","title");k.textContent=b;p.appendChild(k);this.svgElem_.appendChild(p);this.identifyLayers();return p};svgedit.draw.Drawing.prototype.getLayerVisibility=function(b){for(var k=null,p=0;p<this.getNumLayers();++p)if(this.getLayerName(p)==b){k=this.all_layers[p][1];break}if(!k)return false;return k.getAttribute("display")!="none"};svgedit.draw.Drawing.prototype.setLayerVisibility=function(b,k){if(typeof k!="boolean")return null;for(var p=null,c=0;c<
this.getNumLayers();++c)if(this.getLayerName(c)==b){p=this.all_layers[c][1];break}if(!p)return null;p.getAttribute("display");p.setAttribute("display",k?"inline":"none");return p};svgedit.draw.Drawing.prototype.getLayerOpacity=function(b){for(var k=0;k<this.getNumLayers();++k)if(this.getLayerName(k)==b){(b=this.all_layers[k][1].getAttribute("opacity"))||(b="1.0");return parseFloat(b)}return null};svgedit.draw.Drawing.prototype.setLayerOpacity=function(b,k){if(!(typeof k!="number"||k<0||k>1))for(var p=
0;p<this.getNumLayers();++p)if(this.getLayerName(p)==b){this.all_layers[p][1].setAttribute("opacity",k);break}}})();svgedit=svgedit||{};
(function(){if(!svgedit.path)svgedit.path={};var a={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},n={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},e=[],b=false,k={};svgedit.path.setLinkControlPoints=function(g){b=g};var p=svgedit.path.path=null;svgedit.path.init=
function(g){p=g;e=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(d,o){e.push(o+"Abs");e.push(o+"Rel")})};svgedit.path.insertItemBefore=function(g,d,o){g.pathSegList.insertItemBefore(d,o)};svgedit.path.ptObjToArr=function(g,d){for(var o=n[g],u=o.length,A=Array(u),q=0;q<u;q++)A[q]=d[o[q]];return A};svgedit.path.getGripPt=function(g,d){var o={x:d?d.x:g.item.x,y:d?d.y:g.item.y},
u=g.path;if(u.matrix)o=svgedit.math.transformPoint(o.x,o.y,u.matrix);o.x*=p.getCurrentZoom();o.y*=p.getCurrentZoom();return o};svgedit.path.getPointFromGrip=function(g,d){var o={x:g.x,y:g.y};if(d.matrix){g=svgedit.math.transformPoint(o.x,o.y,d.imatrix);o.x=g.x;o.y=g.y}o.x/=p.getCurrentZoom();o.y/=p.getCurrentZoom();return o};svgedit.path.addPointGrip=function(g,d,o){var u=svgedit.path.getGripContainer(),A=svgedit.utilities.getElem("pathpointgrip_"+g);if(!A){A=document.createElementNS("http://www.w3.org/2000/svg",
"rect");svgedit.utilities.assignAttributes(A,{id:"pathpointgrip_"+g,display:"none",width:svgedit.browser.isTouch()?30:5,height:svgedit.browser.isTouch()?30:5,fill:"#fff",stroke:"#4F80FF","shape-rendering":"crispEdges","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":a.pathNodeTooltip});A=u.appendChild(A);$("#pathpointgrip_"+g).dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}if(d&&o)svgedit.utilities.assignAttributes(A,{x:d-(svgedit.browser.isTouch()?
15:2.5),y:o-(svgedit.browser.isTouch()?15:2.5),display:"inline"});return A};svgedit.path.getGripContainer=function(){var g=svgedit.utilities.getElem("pathpointgrip_container");if(!g){g=svgedit.utilities.getElem("selectorParentGroup").appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));g.id="pathpointgrip_container"}return g};svgedit.path.addCtrlGrip=function(g){var d=svgedit.utilities.getElem("ctrlpointgrip_"+g);if(d)return d;d=document.createElementNS("http://www.w3.org/2000/svg",
"circle");svgedit.utilities.assignAttributes(d,{id:"ctrlpointgrip_"+g,display:"none",r:svgedit.browser.isTouch()?15:3,fill:"#4F80FF",stroke:"#4F80FF","stroke-opacity":0,"stroke-width":"3",cursor:"move",style:"pointer-events:all","xlink:title":a.pathCtrlPtTooltip});svgedit.path.getGripContainer().appendChild(d);return d};svgedit.path.getCtrlLine=function(g){var d=svgedit.utilities.getElem("ctrlLine_"+g);if(d)return d;d=document.createElementNS("http://www.w3.org/2000/svg","line");svgedit.utilities.assignAttributes(d,
{id:"ctrlLine_"+g,stroke:"#4F80FF","stroke-width":1,style:"pointer-events:none"});svgedit.path.getGripContainer().appendChild(d);return d};svgedit.path.getPointGrip=function(g,d){var o=svgedit.path.addPointGrip(g.index);if(d){var u=svgedit.path.getGripPt(g);svgedit.utilities.assignAttributes(o,{x:u.x-(svgedit.browser.isTouch()?15:2.5),y:u.y-(svgedit.browser.isTouch()?15:2.5),display:"inline"})}return o};svgedit.path.getControlPoints=function(g){var d=g.item,o=g.index;if(!d||!("x1"in d)||!("x2"in d))return null;
var u={};svgedit.path.getGripContainer();for(var A=[svgedit.path.path.segs[o-1].item,d],q=1;q<3;q++){var M=o+"c"+q,Q=u["c"+q+"_line"]=svgedit.path.getCtrlLine(M),L=svgedit.path.getGripPt(g,{x:d["x"+q],y:d["y"+q]}),I=svgedit.path.getGripPt(g,{x:A[q-1].x,y:A[q-1].y});svgedit.utilities.assignAttributes(Q,{x1:L.x,y1:L.y,x2:I.x,y2:I.y,display:"inline"});u["c"+q+"_line"]=Q;pointGrip=u["c"+q]=svgedit.path.addCtrlGrip(M);svgedit.utilities.assignAttributes(pointGrip,{cx:L.x,cy:L.y,display:"inline"});u["c"+
q]=pointGrip}return u};svgedit.path.replacePathSeg=function(g,d,o,u){u=u||svgedit.path.path.elem;g=u["createSVGPathSeg"+e[g]].apply(u,o);u.pathSegList.replaceItem(g,d)};svgedit.path.getSegSelector=function(g,d){var o=g.index,u=svgedit.utilities.getElem("segline_"+o);if(!u){var A=svgedit.path.getGripContainer();u=document.createElementNS("http://www.w3.org/2000/svg","path");svgedit.utilities.assignAttributes(u,{id:"segline_"+o,display:"none",fill:"none",stroke:"#0ff","stroke-opacity":1,"shape-rendering":"crispEdges",
"stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"});A.appendChild(u)}if(d){o=g.prev;if(!o){u.setAttribute("display","none");return u}o=svgedit.path.getGripPt(o);svgedit.path.replacePathSeg(2,0,[o.x,o.y],u);A=svgedit.path.ptObjToArr(g.type,g.item,true);for(var q=0;q<A.length;q+=2){o=svgedit.path.getGripPt(g,{x:A[q],y:A[q+1]});A[q]=o.x;A[q+1]=o.y}svgedit.path.replacePathSeg(g.type,1,A,u)}return u};svgedit.path.smoothControlPoints=this.smoothControlPoints=function(g,d,o){var u=g.x-o.x,A=g.y-
o.y,q=d.x-o.x,M=d.y-o.y;if((u!=0||A!=0)&&(q!=0||M!=0)){g=Math.atan2(A,u);d=Math.atan2(M,q);u=Math.sqrt(u*u+A*A);q=Math.sqrt(q*q+M*M);A=p.getSVGRoot().createSVGPoint();M=p.getSVGRoot().createSVGPoint();if(g<0)g+=2*Math.PI;if(d<0)d+=2*Math.PI;var Q=Math.abs(g-d),L=Math.abs(Math.PI-Q)/2;if(g-d>0){g=Q<Math.PI?g+L:g-L;d=Q<Math.PI?d-L:d+L}else{g=Q<Math.PI?g-L:g+L;d=Q<Math.PI?d+L:d-L}A.x=u*Math.cos(g)+o.x;A.y=u*Math.sin(g)+o.y;M.x=q*Math.cos(d)+o.x;M.y=q*Math.sin(d)+o.y;return[A,M]}};svgedit.path.Segment=
function(g,d){this.selected=false;this.index=g;this.item=d;this.type=d.pathSegType;this.ctrlpts=[];this.segsel=this.ptgrip=null};svgedit.path.Segment.prototype.showCtrlPts=function(g){for(var d in this.ctrlpts)this.ctrlpts[d].setAttribute("display",g?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill","#4F80FF")};svgedit.path.Segment.prototype.show=function(g){if(this.ptgrip){this.ptgrip.setAttribute("display",
g?"inline":"none");this.segsel.setAttribute("display",g?"inline":"none");this.showCtrlPts(g)}};svgedit.path.Segment.prototype.select=function(g){if(this.ptgrip){this.ptgrip.setAttribute("stroke",g?"#4F80FF":"#4F80FF");this.ptgrip.setAttribute("fill",g?"#4F80FF":"#fff");this.segsel.setAttribute("display",g?"inline":"none");this.ctrlpts&&this.selectCtrls(g);this.selected=g}};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,true);this.ctrlpts=svgedit.path.getControlPoints(this,
true);this.segsel=svgedit.path.getSegSelector(this,true)};svgedit.path.Segment.prototype.update=function(g){if(this.ptgrip){var d=svgedit.path.getGripPt(this),o=svgedit.browser.isTouch()?15:2.5;svgedit.utilities.assignAttributes(this.ptgrip,this.ptgrip.nodeName=="rect"?{x:d.x-o,y:d.y-o}:{cx:d.x,cy:d.y});svgedit.path.getSegSelector(this,true);if(this.ctrlpts){if(g){this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.type=this.item.pathSegType}svgedit.path.getControlPoints(this)}}};
svgedit.path.Segment.prototype.move=function(g,d){var o=this.item;o=$.extend({},o);o=this.ctrlpts?[o.x+=g,o.y+=d,o.x1,o.y1,o.x2+=g,o.y2+=d]:[o.x+=g,o.y+=d];svgedit.path.replacePathSeg(this.type,this.index,o);if(this.next&&this.next.ctrlpts){o=this.next.item;o=[o.x,o.y,o.x1+=g,o.y1+=d,o.x2,o.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,o)}if(this.mate){o=this.mate.item;o=[o.x+=g,o.y+=d];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,o)}this.update(true);this.next&&this.next.update(true)};
svgedit.path.Segment.prototype.setLinked=function(g){var d,o,u;if(g==2){o=1;d=this.next;if(!d)return;u=this.item}else{o=2;d=this.prev;if(!d)return;u=d.item}var A=$.extend({},d.item);A["x"+o]=u.x+(u.x-this.item["x"+g]);A["y"+o]=u.y+(u.y-this.item["y"+g]);svgedit.path.replacePathSeg(d.type,d.index,[A.x,A.y,A.x1,A.y1,A.x2,A.y2]);d.update(true)};svgedit.path.Segment.prototype.moveCtrl=function(g,d,o){var u=$.extend({},this.item);u["x"+g]+=d;u["y"+g]+=o;svgedit.path.replacePathSeg(this.type,this.index,
[u.x,u.y,u.x1,u.y1,u.x2,u.y2]);this.update(true)};svgedit.path.Segment.prototype.setType=function(g,d){svgedit.path.replacePathSeg(g,this.index,d);this.type=g;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(g===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(true)};svgedit.path.Path=function(g){if(!g||g.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=g;this.segs=[];this.selected_pts=[];svgedit.path.path=this;
this.init()};svgedit.path.Path.prototype.init=function(){$(svgedit.path.getGripContainer()).find("*").attr("display","none");var g=this.elem.pathSegList,d=g.numberOfItems;this.segs=[];this.selected_pts=[];this.first_seg=null;for(var o=0;o<d;o++){var u=g.getItem(o);u=new svgedit.path.Segment(o,u);u.path=this;this.segs.push(u)}g=this.segs;u=null;for(o=0;o<d;o++){var A=g[o],q=o+1>=d?null:g[o+1],M=o-1<0?null:g[o-1];if(A.type===2){if(M&&M.type!==1){q=g[u];q.next=g[u+1];q.next.prev=q;q.addGrip()}u=o}else if(q&&
q.type===1){A.next=g[u+1];A.next.prev=A;A.mate=g[u];A.addGrip();if(this.first_seg==null)this.first_seg=A}else if(q){if(A.type!==1){A.addGrip();if(q&&q.type!==2){A.next=q;A.next.prev=A}}}else if(A.type!==1){q=g[u];q.next=g[u+1];q.next.prev=q;q.addGrip();A.addGrip();if(!this.first_seg)this.first_seg=g[u]}}return this};svgedit.path.Path.prototype.eachSeg=function(g){for(var d=this.segs.length,o=0;o<d;o++)if(g.call(this.segs[o],o)===false)break};svgedit.path.Path.prototype.addSeg=function(g){var d=this.segs[g];
if(d.prev){var o=d.prev,u;switch(d.item.pathSegType){case 4:var A=(d.item.x+o.item.x)/2,q=(d.item.y+o.item.y)/2;u=this.elem.createSVGPathSegLinetoAbs(A,q);break;case 6:u=(o.item.x+d.item.x1)/2;var M=(d.item.x1+d.item.x2)/2,Q=(d.item.x2+d.item.x)/2,L=(u+M)/2;M=(M+Q)/2;A=(L+M)/2;var I=(o.item.y+d.item.y1)/2,W=(d.item.y1+d.item.y2)/2;o=(d.item.y2+d.item.y)/2;var T=(I+W)/2;W=(W+o)/2;q=(T+W)/2;u=this.elem.createSVGPathSegCurvetoCubicAbs(A,q,u,I,L,T);svgedit.path.replacePathSeg(d.type,g,[d.item.x,d.item.y,
M,W,Q,o])}svgedit.path.insertItemBefore(this.elem,u,g)}};svgedit.path.Path.prototype.deleteSeg=function(g){var d=this.segs[g],o=this.elem.pathSegList;d.show(false);var u=d.next;if(d.mate){var A=[u.item.x,u.item.y];svgedit.path.replacePathSeg(2,u.index,A);svgedit.path.replacePathSeg(4,d.index,A);o.removeItem(d.mate.index)}else{if(!d.prev){A=[u.item.x,u.item.y];svgedit.path.replacePathSeg(2,d.next.index,A)}o.removeItem(g)}};svgedit.path.Path.prototype.subpathIsClosed=function(g){var d=false;svgedit.path.path.eachSeg(function(o){if(o<=
g)return true;if(this.type===2)return false;else if(this.type===1){d=true;return false}});return d};svgedit.path.Path.prototype.removePtFromSelection=function(g){var d=this.selected_pts.indexOf(g);if(d!=-1){this.segs[g].select(false);this.selected_pts.splice(d,1)}};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(false)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=
function(g){this.eachSeg(function(){this.show(g)});g&&this.selectPt(this.first_seg.index);return this};svgedit.path.Path.prototype.movePts=function(g,d){for(var o=this.selected_pts.length;o--;)this.segs[this.selected_pts[o]].move(g,d)};svgedit.path.Path.prototype.moveCtrl=function(g,d){var o=this.segs[this.selected_pts[0]];o.moveCtrl(this.dragctrl,g,d);b&&o.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(g){this.storeD();for(var d=this.selected_pts.length,o;d--;){var u=this.segs[this.selected_pts[d]],
A=u.prev;if(A){if(!g){o="Toggle Path Segment Type";g=u.type==6?4:6}g-=0;var q=u.item.x,M=u.item.y,Q=A.item.x;A=A.item.y;var L;switch(g){case 6:if(u.olditem){Q=u.olditem;L=[q,M,Q.x1,Q.y1,Q.x2,Q.y2]}else{L=q-Q;var I=M-A;L=[q,M,Q+L/3,A+I/3,q-L/3,M-I/3]}break;case 4:L=[q,M];u.olditem=u.item}u.setType(g,L)}}svgedit.path.path.endChanges(o)};svgedit.path.Path.prototype.selectPt=function(g,d){this.clearSelection();g==null&&this.eachSeg(function(o){if(this.prev)g=o});this.addPtsToSelection(g);if(d){this.dragctrl=
d;b&&this.segs[g].setLinked(d)}};svgedit.path.Path.prototype.update=function(){var g=this.elem;if(svgedit.utilities.getRotationAngle(g)){this.matrix=svgedit.math.getMatrix(g);this.imatrix=this.matrix.inverse()}else this.imatrix=this.matrix=null;this.eachSeg(function(d){this.item=g.pathSegList.getItem(d);this.update()});return this};svgedit.path.getPath_=function(g){var d=k[g.id];d||(d=k[g.id]=new svgedit.path.Path(g));return d};svgedit.path.removePath_=function(g){g in k&&delete k[g]};var c=function(g,
d,o,u,A,q,M){dx=g-o;dy=d-u;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)+M;dx=r*Math.cos(theta)+o;dy=r*Math.sin(theta)+u;dx-=A;dy-=q;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)-M;return{x:(r*Math.cos(theta)+A)/1,y:(r*Math.sin(theta)+q)/1}};svgedit.path.recalcRotatedPath=function(){var g=svgedit.path.path.elem,d=svgedit.utilities.getRotationAngle(g,true);if(d){var o=svgedit.utilities.getBBox(g),u=svgedit.path.path.oldbbox,A=u.x+u.width/2;u=u.y+u.height/2;var q=o.x+o.width/2;o=o.y+o.height/
2;q=q-A;var M=o-u;o=Math.sqrt(q*q+M*M);M=Math.atan2(M,q)+d;q=o*Math.cos(M)+A;o=o*Math.sin(M)+u;M=g.pathSegList;for(var Q=M.numberOfItems;Q;){Q-=1;var L=M.getItem(Q),I=L.pathSegType;if(I!=1){var W=c(L.x,L.y,A,u,q,o,d);W=[W.x,W.y];if(L.x1!=null&&L.x2!=null){c_vals1=c(L.x1,L.y1,A,u,q,o,d);c_vals2=c(L.x2,L.y2,A,u,q,o,d);W.splice(W.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)}svgedit.path.replacePathSeg(I,Q,W)}}svgedit.utilities.getBBox(g);A=svgroot.createSVGTransform();g=svgedit.transformlist.getTransformList(g);
A.setRotate(d*180/Math.PI,q,o);g.replaceItem(A,0)}};svgedit.path.clearData=function(){k={}}})();if(!window.console){window.console={};window.console.log=function(){};window.console.dir=function(){}}if(window.opera){window.console.log=function(a){opera.postError(a)};window.console.dir=function(){}}
(function(){var a=jQuery.fn.attr;jQuery.fn.attr=function(n,e){var b=this.length;if(!b)return a.apply(this,arguments);for(var k=0;k<b;k++){var p=this[k];if(p.namespaceURI==="http://www.w3.org/2000/svg")if(e!==undefined)p.setAttribute(n,e);else if($.isArray(n)){b=n.length;for(k={};b--;){var c=n[b],g=p.getAttribute(c);if(g||g==="0")g=isNaN(g)?g:g-0;k[c]=g}return k}else if(typeof n==="object")for(c in n)p.setAttribute(c,n[c]);else{if((g=p.getAttribute(n))||g==="0")g=isNaN(g)?g:g-0;return g}else return a.apply(this,
arguments)}return this}})();
$.SvgCanvas=function(a,n){function e(f,h){for(var m=svgedit.utilities.getBBox(f),z=0;z<2;z++){var w=z===0?"fill":"stroke",H=f.getAttribute(w);if(H&&H.indexOf("url(")===0){H=R(H);if(H.tagName==="linearGradient"){var D=H.getAttribute("x1")||0,v=H.getAttribute("y1")||0,E=H.getAttribute("x2")||1,J=H.getAttribute("y2")||0;D=m.width*D+m.x;v=m.height*v+m.y;E=m.width*E+m.x;J=m.height*J+m.y;D=O(D,v,h);J=O(E,J,h);E={};E.x1=(D.x-m.x)/m.width;E.y1=(D.y-m.y)/m.height;E.x2=(J.x-m.x)/m.width;E.y2=(J.y-m.y)/m.height;
H=H.cloneNode(true);$(H).attr(E);H.id=ka();lb().appendChild(H);f.setAttribute(w,"url(#"+H.id+")")}}}}var b="http://www.w3.org/2000/svg",k={show_outside_canvas:true,selectNew:true,dimensions:[640,480]};n&&$.extend(k,n);var p=k.dimensions,c=this,g=a.ownerDocument,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("width",p[0]);d.setAttribute("height",p[1]);d.id="svgroot";d.setAttribute("xlinkns","http://www.w3.org/1999/xlink");a.appendChild(d);var o=g.createElementNS(b,"svg");
(c.clearSvgContentElement=function(){for(;o.firstChild;)o.removeChild(o.firstChild);$(o).attr({id:"svgcontent",width:p[0],height:p[1],x:p[0],y:p[1],overflow:k.show_outside_canvas?"visible":"hidden",xmlns:b,"xmlns:se":"http://svg-edit.googlecode.com","xmlns:xlink":"http://www.w3.org/1999/xlink",topic:"none"}).appendTo(d);var f=g.createComment(" Created with Method Draw - http://github.com/duopixel/Method-Draw/ ");o.appendChild(f)})();var u="svg_";c.setIdPrefix=function(f){u=f};c.current_drawing_=new svgedit.draw.Drawing(o,
u);var A=c.getCurrentDrawing=function(){return c.current_drawing_},q=1,M=null,Q={shape:{fill:(k.initFill.color=="none"?"":"#")+k.initFill.color,fill_paint:null,fill_opacity:k.initFill.opacity,stroke:"#"+k.initStroke.color,stroke_paint:null,stroke_opacity:k.initStroke.opacity,stroke_width:k.initStroke.width,stroke_dasharray:"none",opacity:k.initOpacity}};Q.text=$.extend(true,{},Q.shape);$.extend(Q.text,{fill:"#000000",stroke_width:0,font_size:24,font_family:"Helvetica, Arial, sans-serif"});var L=Q.shape,
I=Array(1),W=this.addSvgElementFromJson=function(f){var h=svgedit.utilities.getElem(f.attr.id),m=A().getCurrentLayer();if(h&&f.element!=h.tagName){m.removeChild(h);h=null}if(!h){h=g.createElementNS(b,f.element);if(m)(M||m).appendChild(h)}f.curStyles&&svgedit.utilities.assignAttributes(h,{fill:L.fill,stroke:L.stroke,"stroke-width":L.stroke_width,"stroke-dasharray":L.stroke_dasharray,"stroke-opacity":L.stroke_opacity,"fill-opacity":L.fill_opacity,opacity:L.opacity/2,style:"pointer-events:inherit"},
100);svgedit.utilities.assignAttributes(h,f.attr,100);svgedit.utilities.cleanupElement(h);return h},T=c.getTransformList=svgedit.transformlist.getTransformList,O=svgedit.math.transformPoint,da=c.matrixMultiply=svgedit.math.matrixMultiply,ma=c.hasMatrixTransform=svgedit.math.hasMatrixTransform,Z=c.transformListToTransform=svgedit.math.transformListToTransform,X=svgedit.math.snapToAngle,fa=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return k.baseUnit},getElement:svgedit.utilities.getElem,
getHeight:function(){return o.getAttribute("height")/q},getWidth:function(){return o.getAttribute("width")/q},getRoundDigits:function(){return db.round_digits}});var ta=c.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return g},getDOMContainer:function(){return a},getSVGRoot:function(){return d},getSelectedElements:function(){return I},getSVGContent:function(){return o}});var ia=c.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,la=c.getHref=svgedit.utilities.getHref,
ba=c.setHref=svgedit.utilities.setHref,ea=svgedit.utilities.getPathBBox;c.getBBox=svgedit.utilities.getBBox;var qa=c.getRotationAngle=svgedit.utilities.getRotationAngle,oa=c.getElem=svgedit.utilities.getElem,na=c.assignAttributes=svgedit.utilities.assignAttributes,pa=this.cleanupElement=svgedit.utilities.cleanupElement,Ka=svgedit.sanitize.getNSMap(),La=c.sanitizeSvg=svgedit.sanitize.sanitizeSvg,Ha=svgedit.history.MoveElementCommand,Sa=svgedit.history.InsertElementCommand,Ra=svgedit.history.RemoveElementCommand,
Fa=svgedit.history.ChangeElementCommand,ya=svgedit.history.BatchCommand;c.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(f,h){var m=svgedit.history.HistoryEventTypes;if(f==m.BEFORE_UNAPPLY||f==m.BEFORE_APPLY)c.clearSelection();else if(f==m.AFTER_APPLY||f==m.AFTER_UNAPPLY){var z=h.elements();c.pathActions.clear();N("changed",z);z=h.type();m=f==m.AFTER_APPLY;if(z==Ha.type())(m?h.newParent:h.oldParent)==o&&c.identifyLayers();else if(z==Sa.type()||z==Ra.type()){h.parent==o&&c.identifyLayers();
if(z==Sa.type())m&&Va(h.elem);else m||Va(h.elem);h.elem.tagName==="use"&&Ib(h.elem)}else if(z==Fa.type()){h.elem.tagName=="title"&&h.elem.parentNode.parentNode==o&&c.identifyLayers();m=m?h.newValues:h.oldValues;m.stdDeviation&&c.setBlurOffsets(h.elem.parentNode,m.stdDeviation)}}}});var xa=function(f){c.undoMgr.addCommandToHistory(f)};svgedit.select.init(k,{createSVGElement:function(f){return c.addSvgElementFromJson(f)},svgRoot:function(){return d},svgContent:function(){return o},currentZoom:function(){return q},
getStrokedBBox:function(f){return c.getStrokedBBox([f])}});var Da=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return q},getSVGRoot:function(){return d}});svgedit.utilities.snapToGrid=function(f){var h=k.snappingStep,m=k.baseUnit;if(m!=="px")h*=svgedit.units.getTypeMap()[m];return f=Math.round(f/h)*h};var ra=svgedit.utilities.snapToGrid,ob={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",
exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},vb=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],gb=$.data,Va=function(f){var h=$(f).attr(vb),m;for(m in h){var z=h[m];if(z&&z.indexOf("url(")===0){z=ia(z).substr(1);if(!oa(z)){lb().appendChild(xb[z]);delete xb[z]}}}f=f.getElementsByTagName("*");if(f.length){h=0;for(m=f.length;h<m;h++)Va(f[h])}},Ya={},Aa=k.imgPath+"logo.png",ua=[],db={round_digits:5},Ia=false,Ua=
null,Ba="select",hb="none",rb={},Xa=Q.text,$a=L,wb=null,sa=null,kb=[],fb={},xb={};c.clipBoard=[];var mb=this.runExtensions=function(f,h,m){var z=false;if(m)z=[];$.each(fb,function(w,H){if(f in H)if(m)z.push(H[f](h));else z=H[f](h)});return z};this.addExtension=function(f,h){if(f in fb)console.log('Cannot add extension "'+f+'", an extension by that name already exists"');else{var m=$.isFunction(h)?h($.extend(c.getPrivateMethods(),{svgroot:d,svgcontent:o,nonce:A().getNonce(),selectorManager:Da})):h;
fb[f]=m;N("extension_added",m)}};var ab=this.round=function(f){return parseInt(f*q)/q},sb=this.getIntersectionList=function(f){if(sa==null)return null;var h=M||A().getCurrentLayer();kb.length||(kb=yb(h));var m=null;try{m=h.getIntersectionList(f,null)}catch(z){}if(m==null||typeof m.item!="function"){m=[];if(f)f=f;else{f=sa.getBBox();h={};for(var w in f)h[w]=f[w]/q;f=h}for(w=kb.length;w--;)f.width&&f.width&&svgedit.math.rectsIntersect(f,kb[w].bbox)&&m.push(kb[w].elem)}return m};getStrokedBBox=this.getStrokedBBox=
function(f){f||(f=tb());if(!f.length)return false;var h=function(J){try{var G=svgedit.utilities.getBBox(J),F=svgedit.utilities.getRotationAngle(J);if(F&&F%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(J))){F=false;if(["ellipse","path","line","polyline","polygon"].indexOf(J.tagName)>=0)G=F=c.convertToPath(J,true);else if(J.tagName=="rect"){var l=J.getAttribute("rx"),s=J.getAttribute("ry");if(l||s)G=F=c.convertToPath(J,true)}if(!F){var C=J.cloneNode(true),B=document.createElementNS(b,
"g"),K=J.parentNode;K.appendChild(B);B.appendChild(C);G=svgedit.utilities.bboxToObj(B.getBBox());K.removeChild(B)}}return G}catch(P){console.log(J,P)}},m;$.each(f,function(){if(!m)if(this.parentNode)m=h(this)});if(m==null)return null;var z=m.x+m.width,w=m.y+m.height,H=m.x,D=m.y,v=function(J){var G=J.getAttribute("stroke-width"),F=0;if(J.getAttribute("stroke")!="none"&&!isNaN(G))F+=G/2;return F},E=[];$.each(f,function(J,G){var F=h(G);if(F){var l=v(G);H=Math.min(H,F.x-l);D=Math.min(D,F.y-l);E.push(F)}});
m.x=H;m.y=D;$.each(f,function(J,G){var F=E[J];if(F&&G.nodeType==1){var l=v(G);z=Math.max(z,F.x+F.width+l);w=Math.max(w,F.y+F.height+l)}});m.width=z-H;m.height=w-D;return m};var tb=this.getVisibleElements=function(f){f||(f=$(o).children());f.find("#canvas_background").length&&f.splice(0,1);var h=[];$(f).children().each(function(m,z){try{z.getBBox()&&h.push(z)}catch(w){}});return h.reverse()},yb=this.getVisibleElementsAndBBoxes=function(f){f||(f=$(o).children());var h=[];$(f).children().each(function(m,
z){try{z.getBBox()&&h.push({elem:z,bbox:getStrokedBBox([z])})}catch(w){}});return h.reverse()},ib=this.groupSvgElem=function(f){var h=document.createElementNS(b,"g");f.parentNode.replaceChild(h,f);$(h).append(f).data("gsvg",f)[0].id=ka()},ja=function(f){var h=document.createElementNS(f.namespaceURI,f.nodeName);h.removeAttribute("id");$.each(f.attributes,function(z,w){w.localName!="-moz-math-font-style"&&h.setAttributeNS(w.namespaceURI,w.nodeName,w.nodeValue)});if(svgedit.browser.isWebkit()&&f.nodeName==
"path"){var m=Ma.convertPath(f);h.setAttribute("d",m)}$.each(f.childNodes,function(z,w){switch(w.nodeType){case 1:h.appendChild(ja(w));break;case 3:h.textContent=w.nodeValue}});if($(f).data("gsvg"))$(h).data("gsvg",h.firstChild);else if($(f).data("symbol")){f=$(f).data("symbol");$(h).data("ref",f).data("symbol",f)}else h.tagName=="image"&&Db(h);h.id=ka();return h},aa,ka,N;(function(f){var h={};aa=f.getId=function(){return A().getId()};ka=f.getNextId=function(){return A().getNextId()};N=f.call=function(m,
z){if(h[m])return h[m](this,z)};f.bind=function(m,z){var w=h[m];h[m]=z;return w}})(c);this.prepareSvg=function(f){this.sanitizeSvg(f.documentElement);f=f.getElementsByTagNameNS(b,"path");for(var h=0,m=f.length;h<m;++h){var z=f[h];z.setAttribute("d",Ma.convertPath(z));Ma.fixEnd(z)}};var R=this.getRefElem=function(f){return oa(ia(f).substr(1))},ca=function(f){if(!svgedit.browser.isGecko())return f;var h=f.cloneNode(true);f.parentNode.insertBefore(h,f);f.parentNode.removeChild(f);Da.releaseSelector(f);
I[0]=h;Da.requestSelector(h).showGrips(true);return h};this.setTopic=function(f){var h=I[0];h&&h.setAttribute("topic",f)};this.getTopic=function(){var f=I[0];if(!f)return"";return f.getAttribute("topic")};this.setRotationAngle=function(f,h){f=parseFloat(f);var m=I[0];if(m){var z=m.getAttribute("transform"),w=svgedit.utilities.getBBox(m),H=w.x+w.width/2,D=w.y+w.height/2;w=T(m);w.numberOfItems>0&&w.getItem(0).type==4&&w.removeItem(0);if(f!=0){H=O(H,D,Z(w).matrix);D=d.createSVGTransform();D.setRotate(f,
H.x,H.y);w.numberOfItems?w.insertItemBefore(D,0):w.appendItem(D)}else w.numberOfItems==0&&m.removeAttribute("transform");if(!h){w=m.getAttribute("transform");m.setAttribute("transform",z);jb("transform",w,I);N("changed",I)}oa("pathpointgrip_container");m=Da.requestSelector(I[0]);m.resize();m.updateGripCursors(f)}};var Ca=this.recalculateAllSelectedDimensions=function(){for(var f=new ya(hb=="none"?"position":"size"),h=I.length;h--;){var m=Ta(I[h]);m&&f.addSubCommand(m)}if(!f.isEmpty()){xa(f);N("changed",
I)}},Na=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Za=function(f){console.log([f.a,f.b,f.c,f.d,f.e,f.f])},cb=this.remapElement=function(f,h,m){var z=k.gridSnapping&&f.parentNode.parentNode.localName==="svg",w=function(){if(z)for(var F in h)h[F]=ra(h[F]);na(f,h,1E3,true)};box=svgedit.utilities.getBBox(f);for(var H=0;H<2;H++){var D=H===0?"fill":"stroke",v=f.getAttribute(D);if(v&&v.indexOf("url(")===0)if(m.a<0||m.d<0){v=R(v).cloneNode(true);if(m.a<0){var E=v.getAttribute("x1"),
J=v.getAttribute("x2");v.setAttribute("x1",-(E-1));v.setAttribute("x2",-(J-1))}if(m.d<0){E=v.getAttribute("y1");J=v.getAttribute("y2");v.setAttribute("y1",-(E-1));v.setAttribute("y2",-(J-1))}v.id=ka();lb().appendChild(v);f.setAttribute(D,"url(#"+v.id+")")}}H=f.tagName;if(H==="g"||H==="text"||H==="use")if(m.a==1&&m.b==0&&m.c==0&&m.d==1&&(m.e!=0||m.f!=0)){D=Z(f).matrix;D=da(D.inverse(),m,D);h.x=parseFloat(h.x)+D.e;h.y=parseFloat(h.y)+D.f}else{D=T(f);v=d.createSVGTransform();v.setMatrix(da(Z(D).matrix,
m));D.clear();D.appendItem(v)}switch(H){case "foreignObject":case "rect":case "image":if(H==="image"&&(m.a<0||m.d<0)){D=T(f);v=d.createSVGTransform();v.setMatrix(da(Z(D).matrix,m));D.clear();D.appendItem(v)}else{D=O(h.x,h.y,m);h.width=m.a*h.width;h.height=m.d*h.height;h.x=D.x+Math.min(0,h.width);h.y=D.y+Math.min(0,h.height);h.width=Math.abs(h.width);h.height=Math.abs(h.height)}w();break;case "ellipse":H=O(h.cx,h.cy,m);h.cx=H.x;h.cy=H.y;h.rx=m.a*h.rx;h.ry=m.d*h.ry;h.rx=Math.abs(h.rx);h.ry=Math.abs(h.ry);
w();break;case "circle":H=O(h.cx,h.cy,m);h.cx=H.x;h.cy=H.y;H=svgedit.math.transformBox(box.x,box.y,box.width,box.height,m);h.r=Math.min((H.tr.x-H.tl.x)/2,(H.bl.y-H.tl.y)/2);if(h.r)h.r=Math.abs(h.r);w();break;case "line":D=O(h.x1,h.y1,m);E=O(h.x2,h.y2,m);h.x1=D.x;h.y1=D.y;h.x2=E.x;h.y2=E.y;case "text":m=f.querySelectorAll("tspan");for(H=m.length;H--;){D=ta("x",f.getAttribute("x"));v=ta("x",m[H].getAttribute("x"));E=ta("y",f.getAttribute("y"));J=ta("y",m[H].getAttribute("y"));var G={};if(!isNaN(D)&&
!isNaN(v)&&D!=0&&v!=0&&h.x)G.x=h.x-(D-v);if(!isNaN(E)&&!isNaN(J)&&E!=0&&J!=0&&h.y)G.y=h.y-(E-J);if(G.x||G.y)na(m[H],G,1E3,true)}w();break;case "use":w();break;case "g":(w=$(f).data("gsvg"))&&na(w,h,1E3,true);break;case "polyline":case "polygon":w=h.points.length;for(H=0;H<w;++H){J=h.points[H];J=O(J.x,J.y,m);h.points[H].x=J.x;h.points[H].y=J.y}w=h.points.length;m="";for(H=0;H<w;++H){J=h.points[H];m+=J.x+","+J.y+" "}f.setAttribute("points",m);break;case "path":D=f.pathSegList;w=D.numberOfItems;h.d=
Array(w);for(H=0;H<w;++H){v=D.getItem(H);h.d[H]={type:v.pathSegType,x:v.x,y:v.y,x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,r1:v.r1,r2:v.r2,angle:v.angle,largeArcFlag:v.largeArcFlag,sweepFlag:v.sweepFlag}}w=h.d.length;H=h.d[0];G=O(H.x,H.y,m);h.d[0].x=G.x;h.d[0].y=G.y;for(H=1;H<w;++H){v=h.d[H];D=v.type;if(D%2==0){J=O(v.x!=undefined?v.x:G.x,v.y!=undefined?v.y:G.y,m);D=O(v.x1,v.y1,m);E=O(v.x2,v.y2,m);v.x=J.x;v.y=J.y;v.x1=D.x;v.y1=D.y;v.x2=E.x;v.y2=E.y}else{v.x=m.a*v.x;v.y=m.d*v.y;v.x1=m.a*v.x1;v.y1=m.d*v.y1;v.x2=
m.a*v.x2;v.y2=m.d*v.y2}v.r1=m.a*v.r1;v.r2=m.d*v.r2}m="";w=h.d.length;for(H=0;H<w;++H){v=h.d[H];D=v.type;m+=Na[D];switch(D){case 13:case 12:m+=v.x+" ";break;case 15:case 14:m+=v.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:m+=v.x+","+v.y+" ";break;case 7:case 6:m+=v.x1+","+v.y1+" "+v.x2+","+v.y2+" "+v.x+","+v.y+" ";break;case 9:case 8:m+=v.x1+","+v.y1+" "+v.x+","+v.y+" ";break;case 11:case 10:m+=v.r1+","+v.r2+" "+v.angle+" "+ +v.largeArcFlag+" "+ +v.sweepFlag+" "+v.x+","+v.y+" ";break;case 17:case 16:m+=
v.x2+","+v.y2+" "+v.x+","+v.y+" "}}f.setAttribute("d",m)}},qb=function(f,h,m){f=R(f).firstChild;var z=T(f),w=d.createSVGTransform();w.setTranslate(h,m);z.appendItem(w);Ta(f)},Ta=this.recalculateDimensions=function(f){if(f==null)return null;var h=T(f);if(h&&h.numberOfItems>0){for(var m=h.numberOfItems;m--;){var z=h.getItem(m);if(z.type===0)h.removeItem(m);else if(z.type===1)svgedit.math.isIdentity(z.matrix)&&h.removeItem(m);else z.type===4&&z.angle===0&&h.removeItem(m)}if(h.numberOfItems===1&&qa(f))return null}if(!h||
h.numberOfItems==0){f.removeAttribute("transform");return null}if(h){m=h.numberOfItems;for(var w=[];m--;){z=h.getItem(m);if(z.type===1)w.push([z.matrix,m]);else if(w.length)w=[]}if(w.length===2){m=d.createSVGTransformFromMatrix(da(w[1][0],w[0][0]));h.removeItem(w[0][1]);h.removeItem(w[1][1]);h.insertItemBefore(m,w[1][1])}m=h.numberOfItems;if(m>=2&&h.getItem(m-2).type===1&&h.getItem(m-1).type===2){w=d.createSVGTransform();z=da(h.getItem(m-2).matrix,h.getItem(m-1).matrix);w.setMatrix(z);h.removeItem(m-
2);h.removeItem(m-2);h.appendItem(w)}}switch(f.tagName){case "line":case "polyline":case "polygon":case "path":break;default:if(h.numberOfItems===1&&h.getItem(0).type===1||h.numberOfItems===2&&h.getItem(0).type===1&&h.getItem(0).type===4)return null}var H=$(f).data("gsvg");m=new ya("Transform");var D={},v=null;z=[];switch(f.tagName){case "line":z=["x1","y1","x2","y2"];break;case "circle":z=["cx","cy","r"];break;case "ellipse":z=["cx","cy","rx","ry"];break;case "foreignObject":case "rect":case "image":z=
["width","height","x","y"];break;case "use":case "text":case "tspan":z=["x","y"];break;case "polygon":case "polyline":v={};v.points=f.getAttribute("points");w=f.points;var E=w.numberOfItems;D.points=Array(E);for(var J=0;J<E;++J){var G=w.getItem(J);D.points[J]={x:G.x,y:G.y}}break;case "path":v={};v.d=f.getAttribute("d");D.d=f.getAttribute("d")}if(z.length){D=$(f).attr(z);$.each(D,function(va,za){D[va]=ta(va,za)})}else if(H)D={x:$(H).attr("x")||0,y:$(H).attr("y")||0};if(v==null){v=$.extend(true,{},
D);$.each(v,function(va,za){v[va]=ta(va,za)})}v.transform=Ua?Ua:"";if(f.tagName=="g"&&!H||f.tagName=="a"){w=svgedit.utilities.getBBox(f);var F={x:w.x+w.width/2,y:w.y+w.height/2},l=O(w.x+w.width/2,w.y+w.height/2,Z(h).matrix);z=d.createSVGMatrix();if(w=qa(f)){J=w*Math.PI/180;E=Math.abs(J)>1.0E-10?Math.sin(J)/(1-Math.cos(J)):2/J;for(J=0;J<h.numberOfItems;++J){z=h.getItem(J);if(z.type==4){z=z.matrix;F.y=(E*z.e+z.f)/2;F.x=(z.e-E*z.f)/2;h.removeItem(J);break}}}J=z=H=0;var s=h.numberOfItems;if(s)var C=h.getItem(0).matrix;
if(s>=3&&h.getItem(s-2).type==3&&h.getItem(s-3).type==2&&h.getItem(s-1).type==2){J=3;var B=h.getItem(s-3).matrix,K=h.getItem(s-2).matrix,P=h.getItem(s-1).matrix;E=f.childNodes;for(G=E.length;G--;){var V=E.item(G);z=H=0;if(V.nodeType==1){var S=T(V);if(S){z=Z(S).matrix;H=qa(V);var U=Ua,Y=[];Ua=V.getAttribute("transform");if(H||ma(S)){var ha=d.createSVGTransform();ha.setMatrix(da(B,K,P,z));S.clear();S.appendItem(ha);Y.push(ha)}else{H=da(z.inverse(),P,z);ha=d.createSVGMatrix();ha.e=-H.e;ha.f=-H.f;z=da(ha.inverse(),
z.inverse(),B,K,P,z,H.inverse());var wa=d.createSVGTransform(),Ea=d.createSVGTransform(),ga=d.createSVGTransform();wa.setTranslate(H.e,H.f);Ea.setScale(z.a,z.d);ga.setTranslate(ha.e,ha.f);S.appendItem(ga);S.appendItem(Ea);S.appendItem(wa);Y.push(ga);Y.push(Ea);Y.push(wa)}m.addSubCommand(Ta(V));Ua=U}}}h.removeItem(s-1);h.removeItem(s-2);h.removeItem(s-3)}else if(s>=3&&h.getItem(s-1).type==1){J=3;z=Z(h).matrix;ha=d.createSVGTransform();ha.setMatrix(z);h.clear();h.appendItem(ha)}else if((s==1||s>1&&
h.getItem(1).type!=3)&&h.getItem(0).type==2){J=2;H=Z(h).matrix;h.removeItem(0);z=Z(h).matrix.inverse();z=da(z,H);H=z.e;z=z.f;if(H!=0||z!=0){E=f.childNodes;G=E.length;for(s=[];G--;){V=E.item(G);if(V.nodeType==1){if(V.getAttribute("clip-path")){U=V.getAttribute("clip-path");if(s.indexOf(U)===-1){qb(U,H,z);s.push(U)}}U=Ua;Ua=V.getAttribute("transform");if(S=T(V)){B=d.createSVGTransform();B.setTranslate(H,z);S.numberOfItems?S.insertItemBefore(B,0):S.appendItem(B);m.addSubCommand(Ta(V));S=f.getElementsByTagNameNS(b,
"use");V="#"+V.id;for(B=S.length;B--;){K=S.item(B);if(V==la(K)){P=d.createSVGTransform();P.setTranslate(-H,-z);T(K).insertItemBefore(P,0);m.addSubCommand(Ta(K))}}Ua=U}}}s=[];Ua=U}}else if(s==1&&h.getItem(0).type==1&&!w){J=1;z=h.getItem(0).matrix;E=f.childNodes;for(G=E.length;G--;){V=E.item(G);if(V.nodeType==1){U=Ua;Ua=V.getAttribute("transform");if(S=T(V)){H=da(z,Z(S).matrix);s=d.createSVGTransform();s.setMatrix(H);S.clear();S.appendItem(s,0);m.addSubCommand(Ta(V));Ua=U;U=V.getAttribute("stroke-width");
V.getAttribute("stroke")!=="none"&&!isNaN(U)&&V.setAttribute("stroke-width",U*((Math.abs(H.a)+Math.abs(H.d))/2))}}}h.clear()}else{if(w){F=d.createSVGTransform();F.setRotate(w,l.x,l.y);h.numberOfItems?h.insertItemBefore(F,0):h.appendItem(F)}h.numberOfItems==0&&f.removeAttribute("transform");return null}if(J==2){if(w){l={x:F.x+C.e,y:F.y+C.f};F=d.createSVGTransform();F.setRotate(w,l.x,l.y);h.numberOfItems?h.insertItemBefore(F,0):h.appendItem(F)}}else if(J==3){z=Z(h).matrix;C=d.createSVGTransform();C.setRotate(w,
F.x,F.y);C=C.matrix;F=d.createSVGTransform();F.setRotate(w,l.x,l.y);l=F.matrix.inverse();U=z.inverse();l=da(U,l,C,z);H=l.e;z=l.f;if(H!=0||z!=0){E=f.childNodes;for(G=E.length;G--;){V=E.item(G);if(V.nodeType==1){U=Ua;Ua=V.getAttribute("transform");S=T(V);B=d.createSVGTransform();B.setTranslate(H,z);S.numberOfItems?S.insertItemBefore(B,0):S.appendItem(B);m.addSubCommand(Ta(V));Ua=U}}}if(w)h.numberOfItems?h.insertItemBefore(F,0):h.appendItem(F)}}else{w=svgedit.utilities.getBBox(f);if(!w&&f.tagName!="path")return null;
z=d.createSVGMatrix();if(H=qa(f)){F={x:w.x+w.width/2,y:w.y+w.height/2};l=O(w.x+w.width/2,w.y+w.height/2,Z(h).matrix);J=H*Math.PI/180;E=Math.abs(J)>1.0E-10?Math.sin(J)/(1-Math.cos(J)):2/J;for(J=0;J<h.numberOfItems;++J){z=h.getItem(J);if(z.type==4){z=z.matrix;F.y=(E*z.e+z.f)/2;F.x=(z.e-E*z.f)/2;h.removeItem(J);break}}}J=0;s=h.numberOfItems;if(!svgedit.browser.isWebkit())if((C=f.getAttribute("fill"))&&C.indexOf("url(")===0){C=R(C);U="pattern";if(C.tagName!==U)U="gradient";if(C.getAttribute(U+"Units")===
"userSpaceOnUse"){z=Z(h).matrix;w=T(C);w=Z(w).matrix;z=da(z,w);w="matrix("+[z.a,z.b,z.c,z.d,z.e,z.f].join(",")+")";C.setAttribute(U+"Transform",w)}}if(s>=3&&h.getItem(s-2).type==3&&h.getItem(s-3).type==2&&h.getItem(s-1).type==2){J=3;z=Z(h,s-3,s-1).matrix;h.removeItem(s-1);h.removeItem(s-2);h.removeItem(s-3)}else if(s==4&&h.getItem(s-1).type==1){J=3;z=Z(h).matrix;ha=d.createSVGTransform();ha.setMatrix(z);h.clear();h.appendItem(ha);z=d.createSVGMatrix()}else if((s==1||s>1&&h.getItem(1).type!=3)&&h.getItem(0).type==
2){J=2;C=h.getItem(0).matrix;U=Z(h,1).matrix;w=U.inverse();z=da(w,C,U);h.removeItem(0)}else if(s==1&&h.getItem(0).type==1&&!H){z=Z(h).matrix;switch(f.tagName){case "line":D=$(f).attr(["x1","y1","x2","y2"]);case "polyline":case "polygon":D.points=f.getAttribute("points");if(D.points){w=f.points;E=w.numberOfItems;D.points=Array(E);for(J=0;J<E;++J){G=w.getItem(J);D.points[J]={x:G.x,y:G.y}}}case "path":D.d=f.getAttribute("d");J=1;h.clear()}}else{J=4;if(H){F=d.createSVGTransform();F.setRotate(H,l.x,l.y);
h.numberOfItems?h.insertItemBefore(F,0):h.appendItem(F)}h.numberOfItems==0&&f.removeAttribute("transform");return null}if(J==1||J==2||J==3)cb(f,D,z);if(J==2){if(H){ma(h)||(l={x:F.x+z.e,y:F.y+z.f});F=d.createSVGTransform();F.setRotate(H,l.x,l.y);h.numberOfItems?h.insertItemBefore(F,0):h.appendItem(F)}}else if(J==3&&H){z=Z(h).matrix;C=d.createSVGTransform();C.setRotate(H,F.x,F.y);C=C.matrix;F=d.createSVGTransform();F.setRotate(H,l.x,l.y);l=F.matrix.inverse();U=z.inverse();l=da(U,l,C,z);cb(f,D,l);if(H)h.numberOfItems?
h.insertItemBefore(F,0):h.appendItem(F)}}h.numberOfItems==0&&f.removeAttribute("transform");m.addSubCommand(new Fa(f,v));return m},pb=null,Pa=this.clearSelection=function(f){if(I[0]!=null)for(var h=I.length,m=0;m<h;++m){var z=I[m];if(z==null)break;Da.releaseSelector(z);I[m]=null}f||N("selected",I)},Qa=this.addToSelection=function(f,h){if(f.length!=0){for(var m=0;m<I.length;){if(I[m]==null)break;++m}for(var z=f.length;z--;){var w=f[z];if(w&&svgedit.utilities.getBBox(w)){if(w.tagName==="a"&&w.childNodes.length===
1)w=w.firstChild;if(I.indexOf(w)==-1){I[m]=w;m++;w=Da.requestSelector(w);I.length>1&&w.showGrips(false)}}}N("selected",I);h||I.length==1?Da.requestSelector(I[0]).showGrips(true):Da.requestSelector(I[0]).showGrips(false);for(I.sort(function(H,D){if(H&&D&&H.compareDocumentPosition)return 3-(D.compareDocumentPosition(H)&6);else if(H==null)return 1});I[0]==null;)I.shift(0)}},ub=this.selectOnly=function(f,h){Pa(true);Qa(f,h)};this.removeFromSelection=function(f){if(I[0]!=null)if(f.length!=0){var h=Array(I.length);
j=0;len=I.length;for(var m=0;m<len;++m){var z=I[m];if(z)if(f.indexOf(z)==-1){h[j]=z;j++}else Da.releaseSelector(z)}I=h}};this.selectAllInCurrentLayer=function(){var f=A().getCurrentLayer();if(f){Ba="select";ub($(M||f).children())}};var Hb=this.getMouseTarget=function(f){if(f==null||f.target==null)return null;f=f.target;if(f.correspondingUseElement)f=f.correspondingUseElement;if(["http://www.w3.org/1998/Math/MathML","http://www.w3.org/1999/xhtml"].indexOf(f.namespaceURI)>=0&&f.id!="svgcanvas")for(;f.nodeName!=
"foreignObject";){f=f.parentNode;if(!f)return d}var h=A().getCurrentLayer();if([d,a,o,h].indexOf(f)>=0)return d;if($(f).closest("#selectorParentGroup").length)return Da.selectorParentGroup;for(;f.parentNode&&f.parentNode!==(M||h);)f=f.parentNode;return f};(function(){var f=null,h=null,m=null,z=null,w=null,H={},D={minx:null,miny:null,maxx:null,maxy:null};$(a).mousedown(function(v){if(!c.spaceKey){var E=v.button===2;pb=o.querySelector("g").getScreenCTM().inverse();var J=O(v.pageX,v.pageY,pb),G=J.x*
q;J=J.y*q;v.preventDefault();if(E)Ba="select";G=G/q;J=J/q;var F=Hb(v);if(F.tagName==="a"&&F.childNodes.length===1)F=F.firstChild;var l=z=h=G,s=w=m=J;if(k.gridSnapping){G=ra(G);J=ra(J);h=ra(h);m=ra(m)}if(F==Da.selectorParentGroup&&I[0]!=null){F=v.target;var C=gb(F,"type");if(C=="rotate"){Ba="rotate";current_rotate_mode=gb(F,"dir")}else if(C=="resize"){Ba="resize";hb=gb(F,"dir")}F=I[0]}Ua=F.getAttribute("transform");C=T(F);switch(Ba){case "select":Ia=true;hb="none";if(E)Ia=false;if(F!=d){if(I.indexOf(F)==
-1){v.shiftKey||Pa(true);Qa([F]);wb=F;Ma.clear()}if(!E)for(E=0;E<I.length;++E)if(I[E]!=null){var B=T(I[E]);B.numberOfItems?B.insertItemBefore(d.createSVGTransform(),0):B.appendItem(d.createSVGTransform())}}else if(!E){Pa();Ba="multiselect";if(sa==null)sa=Da.getRubberBandBox();z*=q;w*=q;na(sa,{x:z,y:w,width:0,height:0,display:"inline"},100)}break;case "zoom":Ia=true;if(sa==null)sa=Da.getRubberBandBox();na(sa,{x:l*q,y:l*q,width:0,height:0,display:"inline"},100);break;case "resize":Ia=true;h=G;m=J;H=
svgedit.utilities.getBBox($("#selectedBox0")[0]);var K={};$.each(H,function(P,V){K[P]=V/q});H=K;E=qa(F)?1:0;if(ma(C)){C.insertItemBefore(d.createSVGTransform(),E);C.insertItemBefore(d.createSVGTransform(),E);C.insertItemBefore(d.createSVGTransform(),E)}else{C.appendItem(d.createSVGTransform());C.appendItem(d.createSVGTransform());C.appendItem(d.createSVGTransform());if(svgedit.browser.supportsNonScalingStroke()){if(G=svgedit.browser.isWebkit())B=function(P){var V=P.getAttributeNS(null,"stroke");P.removeAttributeNS(null,
"stroke");setTimeout(function(){P.setAttributeNS(null,"stroke",V)},0)};F.style.vectorEffect="non-scaling-stroke";G&&B(F);J=F.getElementsByTagName("*");l=J.length;for(E=0;E<l;E++){J[E].style.vectorEffect="non-scaling-stroke";G&&B(J[E])}}}break;case "fhellipse":case "fhrect":case "fhpath":Ia=true;f=l+","+s+" ";B=L.stroke_width==0?1:L.stroke_width;W({element:"polyline",curStyles:true,attr:{points:f,id:ka(),fill:"none",opacity:L.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}});D.minx=
l;D.maxx=l;D.miny=s;D.maxy=s;break;case "image":Ia=true;B=W({element:"image",attr:{x:G,y:J,width:0,height:0,id:ka(),opacity:L.opacity/2,style:"pointer-events:inherit"}});ba(B,Aa);Db(B);break;case "square":case "rect":Ia=true;h=G;m=J;W({element:"rect",curStyles:true,attr:{x:G,y:J,width:0,height:0,id:ka(),opacity:L.opacity/2}});break;case "line":Ia=true;B=L.stroke_width==0?1:L.stroke_width;W({element:"line",curStyles:true,attr:{x1:G,y1:J,x2:G,y2:J,id:ka(),stroke:L.stroke,"stroke-width":B,"stroke-dasharray":L.stroke_dasharray,
"stroke-linejoin":L.stroke_linejoin,"stroke-linecap":L.stroke_linecap,"stroke-opacity":L.stroke_opacity,fill:"none",opacity:L.opacity/2,style:"pointer-events:none"}});break;case "circle":Ia=true;W({element:"circle",curStyles:true,attr:{cx:G,cy:J,r:0,id:ka(),opacity:L.opacity/2}});break;case "ellipse":Ia=true;W({element:"ellipse",curStyles:true,attr:{cx:G,cy:J,rx:0,ry:0,id:ka(),opacity:L.opacity/2}});break;case "text":Ia=true;W({element:"text",curStyles:true,attr:{x:G,y:J,id:ka(),fill:Xa.fill,"stroke-width":Xa.stroke_width,
"font-size":Xa.font_size,"font-family":Xa.font_family,"text-anchor":"start","xml:space":"preserve",opacity:L.opacity}});break;case "path":case "pathedit":h*=q;m*=q;Ma.mouseDown(v,F,h,m);Ia=true;break;case "textedit":h*=q;m*=q;eb.mouseDown(v,F,h,m);Ia=true;break;case "rotate":Ia=true;c.undoMgr.beginUndoableChange("transform",I);document.getElementById("workarea").className="rotate"}B=mb("mouseDown",{event:v,start_x:h,start_y:m,selectedElements:I},true);$.each(B,function(P,V){if(V&&V.started)Ia=true});
if(Ba)document.getElementById("workarea").className=Ba=="resize"?v.target.style.cursor:Ba}}).mousemove(function(v){if(!(v.originalEvent.touches&&v.originalEvent.touches.length>1))if(Ia)if(!(v.button===1||c.spaceKey)){var E=I[0],J=O(v.pageX,v.pageY,pb),G=J.x*q;J=J.y*q;var F=oa(aa()),l=x=G/q,s=y=J/q;if(k.gridSnapping){x=ra(x);y=ra(y)}v.preventDefault();switch(Ba){case "select":if(I[0]!==null){l=x-h;var C=y-m;if(k.gridSnapping){l=ra(l);C=ra(C)}if(v.shiftKey){var B=X(h,m,x,y);x=B.x;y=B.y}if(l!=0||C!=
0){s=I.length;for(var K=0;K<s;++K){E=I[K];if(E==null)break;var P=d.createSVGTransform();F=T(E);if(B){l=B.x-h;C=B.y-m}P.setTranslate(l,C);F.numberOfItems?F.replaceItem(P,0):F.appendItem(P);Da.requestSelector(E).resize()}if(v.altKey)if(!c.addClones){c.addClones=c.cloneSelectedElements(0,0,P);c.removeClones=function(){c.addClones&&c.addClones.forEach(function(Ea){Ea.parentNode&&Ea.parentNode.removeChild(Ea);c.addClones=false})};window.addEventListener("keyup",c.removeClones)}N("transition",I)}}break;
case "multiselect":l*=q;s*=q;na(sa,{x:Math.min(z,l),y:Math.min(w,s),width:Math.abs(l-z),height:Math.abs(s-w)},100);F=[];l=[];B=sb();s=I.length;for(K=0;K<s;++K){C=B.indexOf(I[K]);if(C==-1)F.push(I[K]);else B[C]=null}s=B.length;for(K=0;K<s;++K)B[K]&&l.push(B[K]);F.length>0&&c.removeFromSelection(F);l.length>0&&Qa(l);break;case "resize":F=T(E);l=(B=ma(F))?H:svgedit.utilities.getBBox(E);s=l.x;K=l.y;var V=l.width,S=l.height;l=x-h;C=y-m;if(k.gridSnapping){l=ra(l);C=ra(C);S=ra(S);V=ra(V)}if(P=qa(E)){var U=
Math.sqrt(l*l+C*C);C=Math.atan2(C,l)-P*Math.PI/180;l=U*Math.cos(C);C=U*Math.sin(C)}if(hb.indexOf("n")==-1&&hb.indexOf("s")==-1)C=0;if(hb.indexOf("e")==-1&&hb.indexOf("w")==-1)l=0;var Y=U=0,ha=S?(S+C)/S:1,wa=V?(V+l)/V:1;if(hb.indexOf("n")>=0){ha=S?(S-C)/S:1;Y=S}if(hb.indexOf("w")>=0){wa=V?(V-l)/V:1;U=V}l=d.createSVGTransform();C=d.createSVGTransform();V=d.createSVGTransform();if(k.gridSnapping){s=ra(s);U=ra(U);K=ra(K);Y=ra(Y)}l.setTranslate(-(s+U),-(K+Y));if(v.shiftKey)if(wa==1)wa=ha;else ha=wa;C.setScale(wa,
ha);V.setTranslate(s+U,K+Y);if(B){B=P?1:0;F.replaceItem(l,2+B);F.replaceItem(C,1+B);F.replaceItem(V,0+B)}else{B=F.numberOfItems;F.replaceItem(V,B-3);F.replaceItem(C,B-2);F.replaceItem(l,B-1)}Da.requestSelector(E).resize();N("transition",I);break;case "zoom":l*=q;s*=q;na(sa,{x:Math.min(z*q,l),y:Math.min(w*q,s),width:Math.abs(l-z*q),height:Math.abs(s-w*q)},100);break;case "text":na(F,{x:x,y:y},1E3);break;case "line":if(k.gridSnapping){x=ra(x);y=ra(y)}l=x;B=y;if(v.shiftKey){B=X(h,m,l,B);l=B.x;B=B.y}F.setAttributeNS(null,
"x2",l);F.setAttributeNS(null,"y2",B);break;case "foreignObject":case "square":case "rect":case "image":l=Math.abs(x-h);B=Math.abs(y-m);if(Ba=="square"||v.shiftKey){l=B=Math.max(l,B);s=h<x?h:h-l;K=m<y?m:m-B}else{s=Math.min(h,x);K=Math.min(m,y)}if(v.altKey){l*=2;B*=2;s=h-l/2;K=m-B/2}if(k.gridSnapping){l=ra(l);B=ra(B);s=ra(s);K=ra(K)}na(F,{width:l,height:B,x:s,y:K},1E3);break;case "circle":l=$(F).attr(["cx","cy"]);B=l.cx;s=l.cy;l=Math.sqrt((x-B)*(x-B)+(y-s)*(y-s));if(k.gridSnapping)l=ra(l);F.setAttributeNS(null,
"r",l);break;case "ellipse":l=$(F).attr(["cx","cy"]);B=Math.abs(h+(x-h)/2);s=Math.abs(m+(y-m)/2);if(k.gridSnapping){x=ra(x);B=ra(B);y=ra(y);s=ra(s)}l=Math.abs(h-B);K=Math.abs(m-s);if(v.shiftKey){K=l;s=y>m?m+l:m-l}if(v.altKey){B=h;s=m;l=Math.abs(x-B);K=v.shiftKey?l:Math.abs(y-s)}F.setAttributeNS(null,"rx",l);F.setAttributeNS(null,"ry",K);F.setAttributeNS(null,"cx",B);F.setAttributeNS(null,"cy",s);break;case "fhellipse":case "fhrect":D.minx=Math.min(l,D.minx);D.maxx=Math.max(l,D.maxx);D.miny=Math.min(s,
D.miny);D.maxy=Math.max(s,D.maxy);case "fhpath":f+=+l+","+s+" ";F.setAttributeNS(null,"points",f);break;case "path":case "pathedit":x*=q;y*=q;if(k.gridSnapping){x=ra(x);y=ra(y);h=ra(h);m=ra(m)}if(v.shiftKey){if(B=svgedit.path.path){F=B.dragging?B.dragging[0]:h;B=B.dragging?B.dragging[1]:m}else{F=h;B=m}B=X(F,B,x,y);x=B.x;y=B.y}if(sa&&sa.getAttribute("display")!=="none"){l*=q;s*=q;na(sa,{x:Math.min(z*q,l),y:Math.min(w*q,s),width:Math.abs(l-z*q),height:Math.abs(s-w*q)},100)}Ma.mouseMove(v,x,y);break;
case "textedit":x*=q;y*=q;eb.mouseMove(G,J);break;case "rotate":l=svgedit.utilities.getBBox(E);B=l.x+l.width/2;s=l.y+l.height/2;F=fa(E);F=O(B,s,F);B=F.x;s=F.y;F=l.x;K=l.y;if(current_rotate_mode=="nw")F=l.x+l.width;if(current_rotate_mode=="se")K=l.y+l.height;if(current_rotate_mode=="sw"){F=l.x+l.width;K=l.y+l.height}compensation_angle=(Math.atan2(s-K,B-F)*(180/Math.PI)-90)%360;P=(Math.atan2(s-y,B-x)*(180/Math.PI)-90)%360;P+=compensation_angle;if(k.gridSnapping)P=ra(P);if(v.shiftKey)P=Math.round(P/
45)*45;c.setRotationAngle(P<-180?360+P:P,true);N("transition",I)}mb("mouseMove",{event:v,mouse_x:G,mouse_y:J,selected:E})}}).click(function(v){v.preventDefault();return false}).dblclick(function(v){var E=v.target.parentNode,J=Hb(v),G=J.tagName;if(E!==M){if(G==="text"&&Ba!=="textedit"){v=O(v.pageX,v.pageY,pb);eb.select(J,v.x,v.y)}if((G==="g"||G==="a")&&qa(J)){Jb(J);J=I[0];Pa(true)}M&&Eb();E.tagName!=="g"&&E.tagName!=="a"||E===A().getCurrentLayer()||J===Da.selectorParentGroup||Qb(J)}}).mouseup(function(v){c.addClones=
false;window.removeEventListener("keyup",c.removeClones);I=I.filter(Boolean);if(v.button!==2){var E=wb;wb=null;if(Ia){var J=O(v.pageX,v.pageY,pb),G=J.x*q;J=J.y*q;var F=G/q,l=J/q,s=oa(aa()),C=false;Ia=false;switch(Ba){case "resize":case "multiselect":if(sa!=null){sa.setAttribute("display","none");kb=[]}Ba="select";case "select":if(I[0]!=null){if(I.length==1){G=I[0];switch(G.tagName){case "g":case "use":case "image":case "foreignObject":break;default:$a.fill=G.getAttribute("fill");$a.fill_opacity=G.getAttribute("fill-opacity");
$a.stroke=G.getAttribute("stroke");$a.stroke_opacity=G.getAttribute("stroke-opacity");$a.stroke_width=G.getAttribute("stroke-width");$a.stroke_dasharray=G.getAttribute("stroke-dasharray");$a.stroke_linejoin=G.getAttribute("stroke-linejoin");$a.stroke_linecap=G.getAttribute("stroke-linecap")}if(G.tagName=="text"){Xa.font_size=G.getAttribute("font-size");Xa.font_family=G.getAttribute("font-family")}Da.requestSelector(G).showGrips(true)}Ca();z=z;w=w;G=Math.abs(l-w);if(G>1||G>1){v=I.length;for(G=0;G<
v;++G){if(I[G]==null)break;I[G].firstChild||Da.requestSelector(I[G]).resize()}}else{G=v.target;if(I[0].nodeName==="path"&&I[1]==null)Ma.select(I[0]);else v.shiftKey&&E!=G&&c.removeFromSelection([G])}if(svgedit.browser.supportsNonScalingStroke())if(v=I[0]){v.removeAttribute("style");svgedit.utilities.walkTree(v,function(P){P.removeAttribute("style")})}}return;case "zoom":sa!=null&&sa.setAttribute("display","none");N("zoomed",{x:Math.min(z,F),y:Math.min(w,l),width:Math.abs(F-z),height:Math.abs(l-w),
factor:v.altKey?0.5:2});return;case "fhpath":E=s.getAttribute("points");l=E.indexOf(",");if(C=l>=0?E.indexOf(",",l+1)>=0:E.indexOf(" ",E.indexOf(" ")+1)>=0)s=Ma.smoothPolylineIntoPath(s);break;case "line":E=$(s).attr(["x1","x2","y1","y2"]);C=E.x1!=E.x2||E.y1!=E.y2;break;case "foreignObject":case "square":case "rect":case "image":E=$(s).attr(["width","height"]);C=E.width!=0||E.height!=0||Ba==="image";break;case "circle":C=s.getAttribute("r")!=0;break;case "ellipse":E=$(s).attr(["rx","ry"]);C=E.rx!=
null||E.ry!=null;break;case "fhellipse":if(D.maxx-D.minx>0&&D.maxy-D.miny>0){s=W({element:"ellipse",curStyles:true,attr:{cx:(D.minx+D.maxx)/2,cy:(D.miny+D.maxy)/2,rx:(D.maxx-D.minx)/2,ry:(D.maxy-D.miny)/2,id:aa()}});N("changed",[s]);C=true}break;case "fhrect":if(D.maxx-D.minx>0&&D.maxy-D.miny>0){s=W({element:"rect",curStyles:true,attr:{x:D.minx,y:D.miny,width:D.maxx-D.minx,height:D.maxy-D.miny,id:aa()}});N("changed",[s]);C=true}break;case "text":C=true;ub([s]);eb.start(s);break;case "path":s=null;
Ia=true;E=Ma.mouseUp(v,s,G,J);s=E.element;C=E.keep;break;case "pathedit":C=true;s=null;Ma.mouseUp(v);break;case "textedit":C=false;s=null;eb.mouseUp(v,G,J);break;case "rotate":C=true;s=null;Ba="select";E=c.undoMgr.finishUndoableChange();E.isEmpty()||xa(E);Ca();N("changed",I)}G=mb("mouseUp",{event:v,mouse_x:G,mouse_y:J},true);$.each(G,function(P,V){if(V){C=V.keep||C;s=V.element;Ia=V.started||Ia}});if(!C&&s!=null){A().releaseId(aa());s.parentNode.removeChild(s);s=null;for(G=v.target;G.parentNode.parentNode.tagName==
"g";)G=G.parentNode;if((Ba!="path"||!drawn_path)&&G.parentNode.id!="selectorParentGroup"&&G.id!="svgcanvas"&&G.id!="svgroot"){c.setMode("select");ub([G],true)}}else if(s!=null){c.addedNew=true;v=0.2;var B;if(false.beginElement&&s.getAttribute("opacity")!=L.opacity){B=$(false).clone().attr({to:L.opacity,dur:v}).appendTo(s);try{B[0].beginElement()}catch(K){}}else v=0;setTimeout(function(){B&&B.remove();s.setAttribute("opacity",L.opacity);s.setAttribute("style","pointer-events:inherit");pa(s);if(Ba===
"path")Ma.toEditMode(s);else k.selectNew&&ub([s],true);xa(new Sa(s));N("changed",[s])},v*1E3)}Ua=null}}});$(a).bind("mousewheel DOMMouseScroll",function(v){if(v.shiftKey){v.preventDefault();pb=o.getScreenCTM().inverse();var E=O(v.pageX,v.pageY,pb);E={x:E.x,y:E.y,width:0,height:0};if(v.wheelDelta)if(v.wheelDelta>=120)E.factor=2;else{if(v.wheelDelta<=-120)E.factor=0.5}else if(v.detail)if(v.detail>0)E.factor=0.5;else if(v.detail<0)E.factor=2;E.factor&&N("zoomed",E)}})})();var Db=function(f){$(f).click(function(h){h.preventDefault()})},
eb=c.textActions=function(){function f(S){var U=J.value==="";$(J).focus();if(!arguments.length)if(U)S=0;else{if(J.selectionEnd!==J.selectionStart)return;S=J.selectionEnd}var Y;Y=s[S];U||J.setSelectionRange(S,S);G=oa("text_cursor");if(!G){G=document.createElementNS(b,"line");na(G,{id:"text_cursor",stroke:"#333","stroke-width":1});G=oa("selectorParentGroup").appendChild(G)}l||(l=setInterval(function(){var ha=G.getAttribute("display")==="none";G.setAttribute("display",ha?"inline":"none")},600));U=H(Y.x,
C.y);Y=H(Y.x,C.y+C.height);na(G,{x1:U.x,y1:U.y,x2:Y.x,y2:Y.y,visibility:"visible",display:"inline"});F&&F.setAttribute("d","M 0 0")}function h(S,U,Y){if(S===U)f(U);else{Y||J.setSelectionRange(S,U);F=oa("text_selectblock");if(!F){F=document.createElementNS(b,"path");na(F,{id:"text_selectblock",fill:"green",opacity:0.5,style:"pointer-events:none"});oa("selectorParentGroup").appendChild(F)}S=s[S];var ha=s[U];G.setAttribute("visibility","hidden");U=H(S.x,C.y);Y=H(S.x+(ha.x-S.x),C.y);var wa=H(S.x,C.y+
C.height);S=H(S.x+(ha.x-S.x),C.y+C.height);na(F,{d:"M"+U.x+","+U.y+" L"+Y.x+","+Y.y+" "+S.x+","+S.y+" "+wa.x+","+wa.y+"z",display:"inline"})}}function m(S,U){var Y=d.createSVGPoint();Y.x=S;Y.y=U;if(s.length==1)return 0;Y=E.getCharNumAtPosition(Y);if(Y<0){Y=s.length-2;if(S<=s[0].x)Y=0}else if(Y>=s.length-2)Y=s.length-2;var ha=s[Y];S>ha.x+ha.width/2&&Y++;return Y}function z(S,U,Y){var ha=J.selectionStart;S=m(S,U);h(Math.min(ha,S),Math.max(ha,S),!Y)}function w(S,U){var Y={x:S,y:U};Y.x/=q;Y.y/=q;if(B){var ha=
O(Y.x,Y.y,B.inverse());Y.x=ha.x;Y.y=ha.y}return Y}function H(S,U){var Y={x:S,y:U};if(B){var ha=O(Y.x,Y.y,B);Y.x=ha.x;Y.y=ha.y}Y.x*=q;Y.y*=q;return Y}function D(S){h(0,E.textContent.length);$(this).unbind(S)}function v(S){if(V&&E){var U=O(S.pageX,S.pageY,pb);U=w(U.x*q,U.y*q);U=m(U.x,U.y);var Y=E.textContent,ha=Y.substr(0,U).replace(/[a-z0-9]+$/i,"").length;Y=Y.substr(U).match(/^[a-z0-9]+/i);h(ha,(Y?Y[0].length:0)+U);$(S.target).click(D);setTimeout(function(){$(S.target).unbind("click",D)},300)}}var E,
J,G,F,l,s=[],C,B,K,P,V;return{select:function(S,U,Y){E=S;eb.toEditMode(U,Y)},start:function(S){E=S;eb.toEditMode()},mouseDown:function(S,U,Y,ha){S=w(Y,ha);J.focus();f(m(S.x,S.y));K=Y;P=ha},mouseMove:function(S,U){var Y=w(S,U);z(Y.x,Y.y)},mouseUp:function(S,U,Y){var ha=w(U,Y);z(ha.x,ha.y,true);S.target!==E&&U<K+2&&U>K-2&&Y<P+2&&Y>P-2&&eb.toSelectMode(true)},setCursor:f,toEditMode:function(S,U){ub([E],false);V=false;Ba="textedit";Da.requestSelector(E).showGrips(false);Da.requestSelector(E);eb.init();
$(E).css("cursor","text");if(arguments.length){var Y=w(S,U);f(m(Y.x,Y.y))}else f();setTimeout(function(){V=true},300)},toSelectMode:function(S){Ba="select";clearInterval(l);l=null;F&&$(F).attr("display","none");G&&$(G).attr("visibility","hidden");$(E).css("cursor","move");if(S){Pa();$(E).css("cursor","move");N("selected",[E]);Qa([E],true)}E&&!E.textContent.length&&c.deleteSelectedElements();$(J).blur();E=false},setInputElem:function(S){J=S},clear:function(){Ba=="textedit"&&eb.toSelectMode()},init:function(){if(E){if(!E.parentNode){E=
I[0];Da.requestSelector(E).showGrips(false)}var S=E.textContent.length,U=E.getAttribute("transform");C=svgedit.utilities.getBBox(E);B=U?fa(E):null;s=Array(S);J.focus();$(E).unbind("dblclick",v).dblclick(v);if(!S)var Y={x:C.x+C.width/2,width:0};for(U=0;U<S;U++){var ha=E.getStartPositionOfChar(U);Y=E.getEndPositionOfChar(U);if(!svgedit.browser.supportsGoodTextCharPos()){var wa=c.contentW*q;ha.x-=wa;Y.x-=wa;ha.x/=q;Y.x/=q}s[U]={x:ha.x,y:C.y,width:Y.x-ha.x,height:C.height}}s.push({x:Y.x,width:0});h(J.selectionStart,
J.selectionEnd,true)}}}}(),Ma=c.pathActions=function(){var f=false,h,m,z;svgedit.path.Path.prototype.endChanges=function(D){if(svgedit.browser.isWebkit()){var v=this.elem;v.setAttribute("d",Ma.convertPath(v))}D=new Fa(this.elem,{d:this.last_d},D);xa(D);N("changed",[this.elem])};svgedit.path.Path.prototype.addPtsToSelection=function(D){$.isArray(D)||(D=[D]);for(var v=0;v<D.length;v++){var E=D[v],J=this.segs[E];J.ptgrip&&this.selected_pts.indexOf(E)==-1&&E>=0&&this.selected_pts.push(E)}this.selected_pts.sort();
v=this.selected_pts.length;for(D=Array(v);v--;){J=this.segs[this.selected_pts[v]];J.select(true);D[v]=J.ptgrip}Ma.canDeleteNodes=true;Ma.closed_subpath=this.subpathIsClosed(this.selected_pts[0]);N("selected",D)};var w=h=null,H=false;this.lastCtrlPoint=[0,0];return{mouseDown:function(D,v,E,J){if(Ba==="path"){mouse_x=E;mouse_y=J;E=mouse_x/q;v=mouse_y/q;J=oa("path_stretch_line");m=[E,v];if(k.gridSnapping){E=ra(E);v=ra(v);mouse_x=ra(mouse_x);mouse_y=ra(mouse_y)}if(!J){J=document.createElementNS(b,"path");
na(J,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"});J=oa("selectorParentGroup").appendChild(J)}J.setAttribute("display","inline");this.stretchy=J;var G=null;if(w){G=w.pathSegList;for(var F=G.numberOfItems,l=6/q,s=false;F;){F--;var C=G.getItem(F),B=C.x;C=C.y;if(E>=B-l&&E<=B+l&&v>=C-l&&v<=C+l){s=true;break}}l=aa();svgedit.path.removePath_(l);l=oa(l);B=G.numberOfItems;if(s){if(F<=1&&B>=2){E=G.getItem(0).x;v=G.getItem(0).y;F=svgedit.path.first_grip?svgedit.path.first_grip[0]/
q:G.getItem(0).x;s=svgedit.path.first_grip?svgedit.path.first_grip[1]/q:G.getItem(0).y;D=J.pathSegList.getItem(1);D=D.pathSegType===4?w.createSVGPathSegLinetoAbs(E,v):w.createSVGPathSegCurvetoCubicAbs(E,v,D.x1/q,D.y1/q,F,s);E=w.createSVGPathSegClosePath();G.appendItem(D);G.appendItem(E)}else if(B<3)return G=false;$(J).remove();element=l;w=null;Ia=false;if(f){svgedit.path.path.matrix&&cb(l,{},svgedit.path.path.matrix.inverse());E=l.getAttribute("d");J=$(svgedit.path.path.elem).attr("d");$(svgedit.path.path.elem).attr("d",
J+E);$(l).remove();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();svgedit.path.path.init();Ma.toEditMode(svgedit.path.path.elem);svgedit.path.path.selectPt();return false}}else{if(!$.contains(a,Hb(D))){console.log("Clicked outside canvas");return false}G=w.pathSegList.numberOfItems;F=w.pathSegList.getItem(G-1);l=F.x;F=F.y;if(D.shiftKey){v=X(l,F,E,v);E=v.x;v=v.y}D=J.pathSegList.getItem(1);D=D.pathSegType===4?w.createSVGPathSegLinetoAbs(ab(E),ab(v)):w.createSVGPathSegCurvetoCubicAbs(ab(E),
ab(v),D.x1/q,D.y1/q,D.x2/q,D.y2/q);w.pathSegList.appendItem(D);E*=q;v*=q;J.setAttribute("d",["M",E,v,E,v].join(" "));J=svgedit.path.addCtrlGrip("1c1");D=svgedit.path.addCtrlGrip("0c2");l=svgedit.path.getCtrlLine(1);F=svgedit.path.getCtrlLine(2);J.setAttribute("cx",E);J.setAttribute("cy",v);D.setAttribute("cx",E);D.setAttribute("cy",v);l.setAttribute("x1",E);l.setAttribute("x2",E);l.setAttribute("y1",v);l.setAttribute("y2",v);F.setAttribute("x1",E);F.setAttribute("x2",E);F.setAttribute("y1",v);F.setAttribute("y2",
v);J=G;if(f)J+=svgedit.path.path.segs.length;svgedit.path.addPointGrip(J,E,v)}G=true}else{d_attr="M"+E+","+v+" ";w=W({element:"path",curStyles:true,attr:{d:d_attr,id:ka(),opacity:L.opacity/2}});J.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));J=f?svgedit.path.path.segs.length:0;svgedit.path.addPointGrip(J,mouse_x,mouse_y);svgedit.path.first_grip=null}}else if(svgedit.path.path){svgedit.path.path.storeD();l=D.target.id;if(l.substr(0,14)=="pathpointgrip_"){v=svgedit.path.path.cur_pt=
parseInt(l.substr(14));svgedit.path.path.dragging=[E,J];l=svgedit.path.path.segs[v];if(D.shiftKey)l.selected?svgedit.path.path.removePtFromSelection(v):svgedit.path.path.addPtsToSelection(v);else{if(svgedit.path.path.selected_pts.length<=1||!l.selected)svgedit.path.path.clearSelection();svgedit.path.path.addPtsToSelection(v)}}else if(l.indexOf("ctrlpointgrip_")==0){svgedit.path.path.dragging=[E,J];D=l.split("_")[1].split("c");v=D[0]-0;G=D=D[1]-0;F=svgedit.path.path.segs[v];svgedit.path.path.selectPt(v,
D);if(G==2){s=1;l=F.next}else{s=2;l=F.prev}if(!l)return;D=function(K,P){return Math.sqrt(Math.pow(K.x-P.x,2)+Math.pow(K.y-P.y,2))};v={x:F.item["x"+G],y:F.item["y"+G]};G=G==2?{x:F.item.x,y:F.item.y}:{x:l.item.x,y:l.item.y};F={x:l.item["x"+s],y:l.item["y"+s]};l=D(v,G);D=D(F,G);v=Math.abs(Math.round(Math.atan2(v.y-G.y,v.x-G.x)*(180/Math.PI),0)-Math.round(Math.atan2(F.y-G.y,F.x-G.x)*(180/Math.PI),0))==180;if(Math.abs(l-D)<5&&v){svgedit.path.setLinkControlPoints(true);svgedit.path.is_linked=true}else{svgedit.path.setLinkControlPoints(false);
svgedit.path.is_linked=false}}if(!svgedit.path.path.dragging){if(sa==null)sa=Da.getRubberBandBox();na(sa,{x:E*q,y:J*q,width:0,height:0,display:"inline"},100)}}},mouseMove:function(D,v,E){H=true;var J=!D.altKey;if(Ba==="path"){if(w){var G=w.pathSegList,F=G.numberOfItems-1,l=svgedit.path.addCtrlGrip("1c1"),s=svgedit.path.addCtrlGrip("0c2");if(m){var C=s.getAttribute("cx")/q||0,B=s.getAttribute("cy")/q||0;l.setAttribute("cx",v);l.setAttribute("cy",E);l.setAttribute("display","inline");D=m[0];l=m[1];
G.getItem(F);var K=v/q,P=E/q;C=J?D+(D-K):C;J=J?l+(l-P):B;s.setAttribute("cx",C*q);s.setAttribute("cy",J*q);s.setAttribute("display","inline");s=svgedit.path.getCtrlLine(1);B=svgedit.path.getCtrlLine(2);na(s,{x1:v,y1:E,x2:D*q,y2:l*q,display:"inline"});na(B,{x1:C*q,y1:J*q,x2:D*q,y2:l*q,display:"inline"});if(F===0)z=[v,E];else{G=G.getItem(F-1);v=G.x;E=G.y;if(G.pathSegType===6){v+=v-G.x2;E+=E-G.y2}else if(z){v=z[0]/q;E=z[1]/q}svgedit.path.replacePathSeg(6,F,[D,l,this.lastCtrlPoint[0]/q,this.lastCtrlPoint[1]/
q,C,J],w)}}else if(J=this.stretchy){F=G.getItem(F);G=v;l=E;if(D.target.id==="pathpointgrip_0"&&svgedit.path.first_grip){G=svgedit.path.first_grip[0];l=svgedit.path.first_grip[1]}if(F.pathSegType===6)svgedit.path.replacePathSeg(6,1,[v,E,(this.lastCtrlPoint[0]/q||F.x+(F.x-F.x2))*q,(this.lastCtrlPoint[1]/q||F.y+(F.y-F.y2))*q,G,l],J);else z?svgedit.path.replacePathSeg(6,1,[v,E,z[0],z[1],v,E],J):svgedit.path.replacePathSeg(4,1,[v,E],J)}}}else if(svgedit.path.path.dragging){G=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],
y:svgedit.path.path.dragging[1]},svgedit.path.path);D=svgedit.path.getPointFromGrip({x:v,y:E},svgedit.path.path);F=D.x-G.x;G=D.y-G.y;svgedit.path.path.dragging=[v,E];!J||!svgedit.path.is_linked?svgedit.path.setLinkControlPoints(false):svgedit.path.setLinkControlPoints(true);svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(F,G):svgedit.path.path.movePts(F,G)}else{svgedit.path.path.selected_pts=[];svgedit.path.path.eachSeg(function(){if(this.next||this.prev){var V=sa.getBBox(),S=svgedit.path.getGripPt(this);
V=svgedit.math.rectsIntersect(V,{x:S.x,y:S.y,width:0,height:0});this.select(V);V&&svgedit.path.path.selected_pts.push(this.index)}})}},mouseUp:function(D,v,E,J){var G=oa("ctrlpointgrip_1c1"),F=oa("ctrlpointgrip_0c2");this.lastCtrlPoint=G?[G.getAttribute("cx"),G.getAttribute("cy")]:[E,J];if(!svgedit.path.first_grip)svgedit.path.first_grip=F?[F.getAttribute("cx"),F.getAttribute("cy")]:[E,J];if(Ba==="path"){m=null;if(!w){v=oa(aa());Ia=false;z=null}return{keep:true,element:v}}if(svgedit.path.path.dragging){v=
svgedit.path.path.cur_pt;svgedit.path.path.dragging=false;svgedit.path.path.dragctrl=false;svgedit.path.path.update();H&&svgedit.path.path.endChanges("Move path point(s)");!D.shiftKey&&!H&&svgedit.path.path.selectPt(v)}else if(sa&&sa.getAttribute("display")!="none"){sa.setAttribute("display","none");sa.getAttribute("width")<=2&&sa.getAttribute("height")<=2&&Ma.toSelectMode(D.target)}else Ma.toSelectMode(D.target);H=false},toEditMode:function(D){svgedit.path.path=svgedit.path.getPath_(D);Ba="pathedit";
Pa();svgedit.path.path.show(true).update();svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem);f=false},toSelectMode:function(D){var v=D==svgedit.path.path.elem;Ba="select";svgedit.path.path.show(false);h=false;Pa();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();if(v){N("selected",[D]);Qa([D],true)}},addSubPath:function(D){if(D){Ba="path";f=true}else{Ma.clear(true);Ma.toEditMode(svgedit.path.path.elem)}},select:function(D){if(h===D){Ma.toEditMode(D);Ba="pathedit"}else h=
D},reorient:function(){var D=I[0];if(D)if(qa(D)!=0){var v=new ya("Reorient path"),E={d:D.getAttribute("d"),transform:D.getAttribute("transform")};v.addSubCommand(new Fa(D,E));Pa();this.resetOrientation(D);xa(v);svgedit.path.getPath_(D).show(false).matrix=null;this.clear();Qa([D],true);N("changed",I)}},clear:function(D){h=null;if(w){var v=oa(aa());$(oa("path_stretch_line")).remove();D&&$(v).remove();$(oa("pathpointgrip_container")).find("*").attr("display","none");w=z=null;Ia=false}else Ba=="pathedit"&&
this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(false)},resetOrientation:function(D){if(D==null||D.nodeName!="path")return false;var v=T(D),E=Z(v).matrix;v.clear();D.removeAttribute("transform");v=D.pathSegList;for(var J=v.numberOfItems,G=0;G<J;++G){var F=v.getItem(G),l=F.pathSegType;if(l!=1){var s=[];$.each(["",1,2],function(C,B){var K=F["x"+B],P=F["y"+B];if(K!==undefined&&P!==undefined){K=O(K,P,E);s.splice(s.length,0,K.x,K.y)}});svgedit.path.replacePathSeg(l,G,s,D)}}e(D,E)},
zoomChange:function(){Ba=="pathedit"&&svgedit.path.path.update()},getNodePoint:function(){if(svgedit.path.path){var D=svgedit.path.path.segs[svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1];return{x:D.item.x,y:D.item.y,type:D.type}}},linkControlPoints:function(D){svgedit.path.setLinkControlPoints(D)},clonePathNode:function(){svgedit.path.path.storeD();for(var D=svgedit.path.path.selected_pts,v=D.length,E=[];v--;){var J=D[v];svgedit.path.path.addSeg(J);E.push(J+v);E.push(J+
v+1)}svgedit.path.path.init().addPtsToSelection(E);svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var D=svgedit.path.path.selected_pts;if(D.length===1){var v=svgedit.path.path.elem,E=v.pathSegList,J=D[0],G=null,F=null;svgedit.path.path.eachSeg(function(B){if(this.type===2&&B<=J)F=this.item;if(B<=J)return true;if(this.type===2){G=B;return false}else if(this.type===1)return G=false});if(G==null)G=svgedit.path.path.segs.length-1;if(G!==false){var l=v.createSVGPathSegLinetoAbs(F.x,
F.y),s=v.createSVGPathSegClosePath();if(G==svgedit.path.path.segs.length){E.appendItem(l);E.appendItem(s)}else{svgedit.path.insertItemBefore(v,s,G);svgedit.path.insertItemBefore(v,l,G)}svgedit.path.path.init().selectPt(G+1)}else if(svgedit.path.path.segs[J].mate){E.removeItem(J);E.removeItem(J);svgedit.path.path.init().selectPt(J-1)}else{for(D=0;D<E.numberOfItems;D++){var C=E.getItem(D);if(C.pathSegType===2)l=D;else if(D===J)E.removeItem(l);else if(C.pathSegType===1&&J<D){s=D-1;E.removeItem(D);break}}for(D=
J-l-1;D--;)svgedit.path.insertItemBefore(v,E.getItem(l),s);v=E.getItem(l);svgedit.path.replacePathSeg(2,l,[v.x,v.y]);D=J;svgedit.path.path.init().selectPt(0)}}},deletePathNode:function(){if(Ma.canDeleteNodes){svgedit.path.path.storeD();for(var D=svgedit.path.path.selected_pts,v=D.length;v--;)svgedit.path.path.deleteSeg(D[v]);var E=function(){var J=svgedit.path.path.elem.pathSegList,G=J.numberOfItems,F=function(C,B){for(;B--;)J.removeItem(C)};if(G<=1)return true;for(;G--;){var l=J.getItem(G);if(l.pathSegType===
1){l=J.getItem(G-1);var s=J.getItem(G-2);if(l.pathSegType===2){F(G-1,2);E();break}else if(s.pathSegType===2){F(G-2,3);E();break}}else if(l.pathSegType===2)if(G>0){l=J.getItem(G-1).pathSegType;if(l===2){F(G-1,1);E();break}else if(l===1&&J.numberOfItems-1===G){F(G,1);E();break}}}return false};E();if(svgedit.path.path.elem.pathSegList.numberOfItems<=1){c.setMode("select");c.deleteSelectedElements()}else{svgedit.path.path.init();svgedit.path.path.clearSelection();if(window.opera){D=$(svgedit.path.path.elem);
D.attr("d",D.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}}},smoothPolylineIntoPath:function(D){var v=D.points,E=v.numberOfItems;if(E>=4){var J=v.getItem(0),G=null;D=[];D.push(["M",J.x,",",J.y," C"].join(""));for(var F=1;F<=E-4;F+=3){var l=v.getItem(F),s=v.getItem(F+1),C=v.getItem(F+2);if(G)if((J=svgedit.path.smoothControlPoints(G,l,J))&&J.length==2){l=D[D.length-1].split(",");l[2]=J[0].x;l[3]=J[0].y;D[D.length-1]=l.join(",");l=J[1]}D.push([l.x,l.y,s.x,s.y,C.x,C.y].join(","));J=
C;G=s}for(D.push("L");F<E;++F){s=v.getItem(F);D.push([s.x,s.y].join(","))}D=D.join(" ");D=W({element:"path",curStyles:true,attr:{id:aa(),d:D,fill:"none"}})}return D},setSegType:function(D){svgedit.path.path.setSegType(D)},moveNode:function(D,v){var E=svgedit.path.path.selected_pts;if(E.length){svgedit.path.path.storeD();E=svgedit.path.path.segs[E[0]];var J={x:0,y:0};J[D]=v-E.item[D];E.move(J.x,J.y);svgedit.path.path.endChanges("Move path point")}},fixEnd:function(D){for(var v=D.pathSegList,E=v.numberOfItems,
J,G=0;G<E;++G){var F=v.getItem(G);if(F.pathSegType===2)J=F;if(F.pathSegType===1){F=v.getItem(G-1);if(F.x!=J.x||F.y!=J.y){v=D.createSVGPathSegLinetoAbs(J.x,J.y);svgedit.path.insertItemBefore(D,v,G);Ma.fixEnd(D);break}}}svgedit.browser.isWebkit()&&D.setAttribute("d",Ma.convertPath(D))},convertPath:function(D,v){for(var E=D.pathSegList,J=E.numberOfItems,G=0,F=0,l="",s=null,C=0;C<J;++C){var B=E.getItem(C),K=B.x||0,P=B.y||0,V=B.x1||0,S=B.y1||0,U=B.x2||0,Y=B.y2||0,ha=B.pathSegType,wa=Na[ha]["to"+(v?"Lower":
"Upper")+"Case"](),Ea=function(ga,va,za){va=va?" "+va.join(" "):"";za=za?" "+svgedit.units.shortFloat(za):"";$.each(ga,function(Ga,Ja){ga[Ga]=svgedit.units.shortFloat(Ja)});l+=wa+ga.join(" ")+va+za};switch(ha){case 1:l+="z";break;case 12:K-=G;case 13:if(v){G+=K;wa="l"}else{K+=G;G=K;wa="L"}Ea([[K,F]]);break;case 14:P-=F;case 15:if(v){F+=P;wa="l"}else{P+=F;F=P;wa="L"}Ea([[G,P]]);break;case 2:case 4:case 18:K-=G;P-=F;case 5:case 3:if(s&&E.getItem(C-1).pathSegType===1&&!v){G=s[0];F=s[1]}case 19:if(v){G+=
K;F+=P}else{K+=G;P+=F;G=K;F=P}if(ha===3)s=[G,F];Ea([[K,P]]);break;case 6:K-=G;V-=G;U-=G;P-=F;S-=F;Y-=F;case 7:if(v){G+=K;F+=P}else{K+=G;V+=G;U+=G;P+=F;S+=F;Y+=F;G=K;F=P}Ea([[V,S],[U,Y],[K,P]]);break;case 8:K-=G;V-=G;P-=F;S-=F;case 9:if(v){G+=K;F+=P}else{K+=G;V+=G;P+=F;S+=F;G=K;F=P}Ea([[V,S],[K,P]]);break;case 10:K-=G;P-=F;case 11:if(v){G+=K;F+=P}else{K+=G;P+=F;G=K;F=P}Ea([[B.r1,B.r2]],[B.angle,B.largeArcFlag?1:0,B.sweepFlag?1:0],[K,P]);break;case 16:K-=G;U-=G;P-=F;Y-=F;case 17:if(v){G+=K;F+=P}else{K+=
G;U+=G;P+=F;Y+=F;G=K;F=P}Ea([[U,Y],[K,P]])}}return l}}}(),Ob=this.removeUnusedDefElems=function(){var f=o.getElementsByTagNameNS(b,"defs");if(!f||!f.length)return 0;for(var h=[],m=0,z=["fill","stroke","filter","marker-start","marker-mid","marker-end"],w=z.length,H=o.getElementsByTagNameNS(b,"*"),D=H.length,v=0;v<D;v++){for(var E=H[v],J=0;J<w;J++)if(E){var G=ia(E.getAttribute(z[J]));G&&h.push(G.substr(1))}(E=la(E))&&E.indexOf("#")===0&&h.push(E.substr(1))}f=$(f).find("linearGradient, radialGradient, filter, marker, svg, symbol");
defelem_ids=[];for(v=f.length;v--;){z=f[v];w=z.id;if(h.indexOf(w)<0){xb[w]=z;z.parentNode.removeChild(z);m++}}return m};this.svgCanvasToString=function(){for(;Ob()>0;);Ma.clear(true);$.each(o.childNodes,function(m,z){m&&z.nodeType===8&&z.data.indexOf("Created with")>=0&&o.insertBefore(z,o.firstChild)});if(M){Eb();ub([M])}$("#canvasGrid").attr("display","none");var f=[];$(o).find("g:data(gsvg)").each(function(){for(var m=this.attributes,z=m.length,w=0;w<z;w++)if(m[w].nodeName=="id"||m[w].nodeName==
"style")z--;if(z<=0){m=this.firstChild;f.push(m);$(this).replaceWith(m)}});var h=this.svgToString(o,0);f.length&&$(f).each(function(){ib(this)});return h};this.svgToString=function(f,h){var m=[],z=svgedit.utilities.toXml,w=k.baseUnit,H=RegExp("^-?[\\d\\.]+"+w+"$");if(f){pa(f);var D=f.attributes,v,E,J=f.childNodes;for(E=0;E<h;E++)m.push(" ");m.push("<");m.push(f.nodeName);if(f.id==="svgcontent"){E=Cb();if(w!=="px"){E.w=svgedit.units.convertUnit(E.w,w)+w;E.h=svgedit.units.convertUnit(E.h,w)+w}m.push(' width="'+
E.w+'" height="'+E.h+'" xmlns="'+b+'"');var G={};$(f).find("*").andSelf().each(function(){$.each(this.attributes,function(C,B){var K=B.namespaceURI;if(K&&!G[K]&&Ka[K]!=="xmlns"&&Ka[K]!=="xml"){G[K]=true;m.push(" xmlns:"+Ka[K]+'="'+K+'"')}})});E=D.length;for(w=["width","height","xmlns","x","y","viewBox","id","overflow"];E--;){v=D.item(E);var F=z(v.nodeValue);if(v.nodeName.indexOf("xmlns:")!==0)if(F!=""&&w.indexOf(v.localName)==-1)if(!v.namespaceURI||Ka[v.namespaceURI]){m.push(" ");m.push(v.nodeName);
m.push('="');m.push(F);m.push('"')}}}else{if(f.nodeName==="defs"&&!f.firstChild)return;var l=["-moz-math-font-style","_moz-math-font-style"];for(E=D.length-1;E>=0;E--){v=D.item(E);F=z(v.nodeValue);if(!(l.indexOf(v.localName)>=0))if(F!="")if(F.indexOf("pointer-events")!==0)if(!(v.localName==="class"&&F.indexOf("se_")===0)){m.push(" ");if(v.localName==="d")F=Ma.convertPath(f,true);if(isNaN(F)){if(H.test(F))F=svgedit.units.shortFloat(F)+w}else F=svgedit.units.shortFloat(F);if(db.apply&&f.nodeName===
"image"&&v.localName==="href"&&db.images&&db.images==="embed"){var s=Ya[F];if(s)F=s}if(!v.namespaceURI||v.namespaceURI==b||Ka[v.namespaceURI]){m.push(v.nodeName);m.push('="');m.push(F);m.push('"')}}}}if(f.hasChildNodes()){m.push(">");h++;D=false;for(E=0;E<J.length;E++){w=J.item(E);switch(w.nodeType){case 1:m.push("\n");m.push(this.svgToString(J.item(E),h));break;case 3:w=w.nodeValue.replace(/^\s+|\s+$/g,"");if(w!=""){D=true;m.push(z(w)+"")}break;case 4:m.push("\n");m.push(Array(h+1).join(" "));m.push("<![CDATA[");
m.push(w.nodeValue);m.push("]]\>");break;case 8:m.push("\n");m.push(Array(h+1).join(" "));m.push("<!--");m.push(w.data);m.push("--\>")}}h--;if(!D){m.push("\n");for(E=0;E<h;E++)m.push(" ")}m.push("</");m.push(f.nodeName);m.push(">")}else m.push("/>")}return m.join("")};this.embedImage=function(f,h){$(new Image).load(function(){var m=document.createElement("canvas");m.width=this.width;m.height=this.height;m.getContext("2d").drawImage(this,0,0);try{var z=";svgedit_url="+encodeURIComponent(f);z=m.toDataURL().replace(";base64",
z+";base64");Ya[f]=z}catch(w){Ya[f]=false}Aa=f;h&&h(Ya[f])}).attr("src",f)};this.setGoodImage=function(f){Aa=f};this.open=function(){};this.save=function(f){Pa();f&&$.extend(db,f);db.apply=true;f=this.svgCanvasToString();if(svgedit.browser.supportsBlobs()){f=new Blob([f],{type:"image/svg+xml;charset=utf-8"});saveAs(f,"method-draw-image.svg",true)}else N("saved",f)};this.rasterExport=function(){Pa();var f=[],h={feGaussianBlur:ob.exportNoBlur,foreignObject:ob.exportNoforeignObject,"[stroke-dasharray]":ob.exportNoDashArray},
m=$(o);if(!("font"in $("<canvas>")[0].getContext("2d")))h.text=ob.exportNoText;$.each(h,function(z,w){m.find(z).length&&f.push(w)});h=this.svgCanvasToString();N("exported",{svg:h,issues:f})};this.getSvgString=function(){db.apply=false;return this.svgCanvasToString()};this.randomizeIds=function(){arguments.length>0&&arguments[0]==false?svgedit.draw.randomizeIds(false,A()):svgedit.draw.randomizeIds(true,A())};var Ab=this.uniquifyElems=function(f){var h={},m=["filter","linearGradient","pattern","radialGradient",
"symbol","textPath","use"];svgedit.utilities.walkTree(f,function(v){if(v.nodeType==1){if(v.id){v.id in h||(h[v.id]={elem:null,attrs:[],hrefs:[]});h[v.id].elem=v}$.each(vb,function(J,G){var F=v.getAttributeNode(G);if(F){var l=svgedit.utilities.getUrlFromAttr(F.value);if(l=l?l.substr(1):null){l in h||(h[l]={elem:null,attrs:[],hrefs:[]});h[l].attrs.push(F)}}});var E=svgedit.utilities.getHref(v);if(E&&m.indexOf(v.nodeName)>=0)if(E=E.substr(1)){E in h||(h[E]={elem:null,attrs:[],hrefs:[]});h[E].hrefs.push(v)}}});
for(var z in h)if(z){var w=h[z].elem;if(w){f=ka();w.id=f;w=h[z].attrs;for(var H=w.length;H--;){var D=w[H];D.ownerElement.setAttribute(D.name,"url(#"+f+")")}w=h[z].hrefs;for(H=w.length;H--;)svgedit.utilities.setHref(w[H],"#"+f)}}},Ib=this.setUseData=function(f){var h=$(f);if(f.tagName!=="use")h=h.find("use");h.each(function(){var m=la(this).substr(1);if(m=oa(m)){$(this).data("ref",m);if(m.tagName=="symbol"||m.tagName=="svg")$(this).data("symbol",m).data("ref",m)}})},Kb=this.convertGradients=function(f){var h=
$(f).find("linearGradient, radialGradient");if(!h.length&&svgedit.browser.isWebkit())h=$(f).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0});h.each(function(){if($(this).attr("gradientUnits")==="userSpaceOnUse"){var m=$(o).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(m.length)if(m=svgedit.utilities.getBBox(m[0]))if(this.tagName==="linearGradient"){var z=$(this).attr(["x1","y1","x2","y2"]),w=this.gradientTransform.baseVal;if(w&&w.numberOfItems>0){var H=
Z(w).matrix;w=O(z.x1,z.y1,H);H=O(z.x2,z.y2,H);z.x1=w.x;z.y1=w.y;z.x2=H.x;z.y2=H.y;this.removeAttribute("gradientTransform")}$(this).attr({x1:(z.x1-m.x)/m.width,y1:(z.y1-m.y)/m.height,x2:(z.x2-m.x)/m.width,y2:(z.y2-m.y)/m.height});this.removeAttribute("gradientUnits")}}})},Pb=this.convertToGroup=function(f){f||(f=I[0]);var h=$(f),m=new ya,z;if(h.data("gsvg")){m=$(f.firstChild).attr(["x","y"]);$(f.firstChild.firstChild).unwrap();$(f).removeData("gsvg");z=T(f);var w=d.createSVGTransform();w.setTranslate(m.x,
m.y);z.appendItem(w);Ta(f);N("selected",[f])}else if(h.data("symbol")){f=h.data("symbol");z=h.attr("transform");w=h.attr(["x","y"]);var H=f.getAttribute("viewBox");if(H){H=H.split(" ");w.x-=+H[0];w.y-=+H[1]}z+=" translate("+(w.x||0)+","+(w.y||0)+")";w=h.prev();m.addSubCommand(new Ra(h[0],h[0].nextSibling,h[0].parentNode));h.remove();H=$(o).find("use:data(symbol)").length;h=g.createElementNS(b,"g");for(var D=f.childNodes,v=0;v<D.length;v++)h.appendChild(D[v].cloneNode(true));if(svgedit.browser.isGecko()){D=
$(lb()).children("linearGradient,radialGradient,pattern").clone();$(h).append(D)}z&&h.setAttribute("transform",z);z=f.parentNode;Ab(h);svgedit.browser.isGecko()&&$(lb()).append($(h).find("linearGradient,radialGradient,pattern"));h.id=ka();w.after(h);if(z){if(!H){w=f.nextSibling;z.removeChild(f);m.addSubCommand(new Ra(f,w,z))}m.addSubCommand(new Sa(h))}Ib(h);svgedit.browser.isGecko()?Kb(lb()):Kb(h);svgedit.utilities.walkTreePost(h,function(E){try{Ta(E)}catch(J){console.log(J)}});$(h).find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=
ka()});ub([h]);(f=Jb(h,true))&&m.addSubCommand(f);xa(m)}else console.log("Unexpected element to ungroup:",f)};this.setSvgString=function(f){try{var h=svgedit.utilities.text2xml(f);this.prepareSvg(h);var m=new ya("Change Source"),z=o.nextSibling,w=d.removeChild(o);m.addSubCommand(new Ra(w,z,d));o=g.adoptNode?g.adoptNode(h.documentElement):g.importNode(h.documentElement,true);d.appendChild(o);var H=$(o);c.current_drawing_=new svgedit.draw.Drawing(o,u);var D=A().getNonce();D?N("setnonce",D):N("unsetnonce");
H.find("image").each(function(){var B=this;Db(B);var K=la(this);if(K.indexOf("data:")===0){var P=K.match(/svgedit_url=(.*?);/);if(P){var V=decodeURIComponent(P[1]);$(new Image).load(function(){B.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",V)}).attr("src",V)}}c.embedImage(K)});H.find("svg").each(function(){if(!$(this).closest("defs").length){Ab(this);var B=this.parentNode;if(B.childNodes.length===1&&B.nodeName==="g"){$(B).data("gsvg",this);B.id=B.id||ka()}else ib(this)}});H.find("linearGradient, radialGradient, pattern").appendTo(lb());
Ib(H);Kb(H[0]);svgedit.utilities.walkTreePost(o,function(B){try{Ta(B)}catch(K){console.log(K)}});var v={id:"svgcontent",overflow:k.show_outside_canvas?"visible":"hidden"},E=false;if(H.attr("viewBox")){var J=H.attr("viewBox").split(" ");v.width=J[2];v.height=J[3]}else $.each(["width","height"],function(B,K){var P=H.attr(K);P||(P="100%");if((P+"").substr(-1)==="%")E=true;else v[K]=ta(K,P)});Fb();H.children().find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=
ka()});if(E){var G=getStrokedBBox();v.width=G.width+G.x;v.height=G.height+G.y}if(v.width<=0)v.width=200;if(v.height<=0)v.height=200;H.attr(v);this.contentW=v.width;this.contentH=v.height;$("#canvas_width").val(this.contentW);$("#canvas_height").val(this.contentH);var F=$("#canvas_background");if(F.length){var l=F.attr("fill-opacity");l=l?parseInt(l)*100:100;fill=this.getPaint(F.attr("fill"),l,"canvas")}else fill=this.getPaint("none",100,"canvas");methodDraw.paintBox.canvas.setPaint(fill);m.addSubCommand(new Sa(o));
var s=H.attr(["width","height"]);m.addSubCommand(new Fa(d,s));q=1;svgedit.transformlist.resetListMap();Pa();svgedit.path.clearData();d.appendChild(Da.selectorParentGroup);xa(m);N("changed",[o])}catch(C){console.log(C);return false}return true};this.getPaint=function(f,h,m){var z=null;if(f.indexOf("url(#")===0){f=(f=svgCanvas.getRefElem(f))?f.cloneNode(true):$("#"+m+"_color defs *")[0];z={alpha:h};z[f.tagName]=f}else z=f.indexOf("#")===0?{alpha:h,solidColor:f.substr(1)}:{alpha:h,solidColor:"none"};
return new $.jGraduate.Paint(z)};this.importSvgString=function(f){try{var h=svgedit.utilities.encode64(f.length+f).substr(0,32),m=false;if(rb[h])if($(rb[h].symbol).parents("#svgroot").length)m=true;var z=new ya("Import SVG");if(m)var w=rb[h].symbol,H=rb[h].xform;else{var D=svgedit.utilities.text2xml(f);this.prepareSvg(D);var v;v=g.adoptNode?g.adoptNode(D.documentElement):g.importNode(D.documentElement,true);Ab(v);var E=ta("width",v.getAttribute("width")),J=ta("height",v.getAttribute("height")),G=
v.getAttribute("viewBox"),F=G?G.split(" "):[0,0,E,J];for(f=0;f<4;++f)F[f]=+F[f];o.getAttribute("width");var l=+o.getAttribute("height");H=J>E?"scale("+l/3/F[3]+")":"scale("+l/3/F[2]+")";H="translate(0) "+H+" translate(0)";w=g.createElementNS(b,"symbol");var s=lb();for(svgedit.browser.isGecko()&&$(v).find("linearGradient, radialGradient, pattern").appendTo(s);v.firstChild;)w.appendChild(v.firstChild);var C=v.attributes;for(v=0;v<C.length;v++){var B=C[v];w.setAttribute(B.nodeName,B.nodeValue)}w.id=
ka();rb[h]={symbol:w,xform:H};lb().appendChild(w);z.addSubCommand(new Sa(w))}var K=g.createElementNS(b,"use");K.id=ka();ba(K,"#"+w.id);(M||A().getCurrentLayer()).appendChild(K);z.addSubCommand(new Sa(K));Pa();K.setAttribute("transform",H);Ta(K);$(K).data("symbol",w).data("ref",w);Qa([K]);xa(z);N("changed",[o])}catch(P){console.log(P);return false}return true};var Fb=c.identifyLayers=function(){Eb();A().identifyLayers()};this.createLayer=function(f){var h=new ya("Create Layer");f=A().createLayer(f);
h.addSubCommand(new Sa(f));xa(h);Pa();N("changed",[f])};this.cloneLayer=function(f){var h=new ya("Duplicate Layer"),m=g.createElementNS(b,"g"),z=g.createElementNS(b,"title");z.textContent=f;m.appendChild(z);z=A().getCurrentLayer();$(z).after(m);z=z.childNodes;for(var w=0;w<z.length;w++){var H=z[w];H.localName!="title"&&m.appendChild(ja(H))}Pa();Fb();h.addSubCommand(new Sa(m));xa(h);c.setCurrentLayer(f);N("changed",[m])};this.deleteCurrentLayer=function(){var f=A().getCurrentLayer(),h=f.nextSibling,
m=f.parentNode;if(f=A().deleteCurrentLayer()){var z=new ya("Delete Layer");z.addSubCommand(new Ra(f,h,m));xa(z);Pa();N("changed",[m]);return true}return false};this.setCurrentLayer=function(f){(f=A().setCurrentLayer(svgedit.utilities.toXml(f)))&&Pa();return f};this.renameCurrentLayer=function(f){var h=A();if(h.current_layer){var m=h.current_layer;if(!c.setCurrentLayer(f)){for(var z=new ya("Rename Layer"),w=0;w<h.getNumLayers();++w)if(h.all_layers[w][1]==m)break;var H=h.getLayerName(w);h.all_layers[w][0]=
svgedit.utilities.toXml(f);var D=m.childNodes.length;for(w=0;w<D;++w){var v=m.childNodes.item(w);if(v&&v.tagName=="title"){for(;v.firstChild;)v.removeChild(v.firstChild);v.textContent=f;z.addSubCommand(new Fa(v,{"#text":H}));xa(z);N("changed",[m]);return true}}}h.current_layer=m}return false};this.setCurrentLayerPosition=function(f){var h=A();if(h.current_layer&&f>=0&&f<h.getNumLayers()){for(var m=0;m<h.getNumLayers();++m)if(h.all_layers[m][1]==h.current_layer)break;if(m==h.getNumLayers())return false;
if(m!=f){var z=null,w=h.current_layer.nextSibling;if(f>m){if(f<h.getNumLayers()-1)z=h.all_layers[f+1][1]}else z=h.all_layers[f][1];o.insertBefore(h.current_layer,z);xa(new Ha(h.current_layer,w,o));Fb();c.setCurrentLayer(h.getLayerName(f));return true}}return false};this.setLayerVisibility=function(f,h){var m=A(),z=m.getLayerVisibility(f),w=m.setLayerVisibility(f,h);if(w)xa(new Fa(w,{display:z?"inline":"none"},"Layer Visibility"));else return false;if(w==m.getCurrentLayer()){Pa();Ma.clear()}return true};
this.moveSelectedToLayer=function(f){for(var h=null,m=A(),z=0;z<m.getNumLayers();++z)if(m.getLayerName(z)==f){h=m.all_layers[z][1];break}if(!h)return false;f=new ya("Move Elements to Layer");m=I;for(z=m.length;z--;){var w=m[z];if(w){var H=w.nextSibling,D=w.parentNode;h.appendChild(w);f.addSubCommand(new Ha(w,H,D))}}xa(f);return true};this.mergeLayer=function(f){var h=new ya("Merge Layer"),m=A(),z=$(m.current_layer).prev()[0];if(z){for(h.addSubCommand(new Ra(m.current_layer,m.current_layer.nextSibling,
o));m.current_layer.firstChild;){var w=m.current_layer.firstChild;if(w.localName=="title"){h.addSubCommand(new Ra(w,w.nextSibling,m.current_layer));m.current_layer.removeChild(w)}else{var H=w.nextSibling;z.appendChild(w);h.addSubCommand(new Ha(w,H,m.current_layer))}}o.removeChild(m.current_layer);if(!f){Pa();Fb();N("changed",[o]);xa(h)}m.current_layer=z;return h}};this.mergeAllLayers=function(){var f=new ya("Merge all Layers"),h=A();for(h.current_layer=h.all_layers[h.getNumLayers()-1][1];$(o).children("g").length>
1;)f.addSubCommand(c.mergeLayer(true));Pa();Fb();N("changed",[o]);xa(f)};var Eb=this.leaveContext=function(){var f=ua.length;if(f){for(var h=0;h<f;h++){var m=ua[h],z=gb(m,"orig_opac");z!==1?m.setAttribute("opacity",z):m.removeAttribute("opacity");m.setAttribute("style","pointer-events: inherit")}ua=[];Pa(true);N("contextset",null)}M=null},Qb=this.setContext=function(f){Eb();if(typeof f==="string")f=oa(f);M=f;$(f).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var h=this.getAttribute("opacity")||
1;gb(this,"orig_opac",h);this.setAttribute("opacity",h*0.33);this.setAttribute("style","pointer-events: none");ua.push(this)});Pa();N("contextset",M)};this.clear=function(){Ma.clear();Pa();c.clearSvgContentElement();c.current_drawing_=new svgedit.draw.Drawing(o);c.createLayer("Layer 1");c.undoMgr.resetUndoStack();Da.initGroup();sa=Da.getRubberBandBox();N("cleared")};this.linkControlPoints=Ma.linkControlPoints;this.getContentElem=function(){return o};this.getRootElem=function(){return d};this.getSelectedElems=
function(){return I};var Cb=this.getResolution=function(){var f=o.getAttribute("width")/q,h=o.getAttribute("height")/q;return{w:f,h:h,zoom:q}};this.getZoom=function(){return q};this.getVersion=function(){return"svgcanvas.js ($Rev: 2082 $)"};this.setUiStrings=function(f){$.extend(ob,f.notification)};this.setConfig=function(f){$.extend(k,f)};this.getTitle=function(f){if(f=f||I[0]){f=$(f).data("gsvg")||$(f).data("symbol")||f;f=f.childNodes;for(var h=0;h<f.length;h++)if(f[h].nodeName=="title")return f[h].textContent;
return""}};this.setGroupTitle=function(f){var h=I[0];h=$(h).data("gsvg")||h;var m=$(h).children("title"),z=new ya("Set Label");if(f.length)if(m.length){m=m[0];z.addSubCommand(new Fa(m,{"#text":m.textContent}));m.textContent=f}else{m=g.createElementNS(b,"title");m.textContent=f;$(h).prepend(m);z.addSubCommand(new Sa(m))}else{z.addSubCommand(new Ra(m[0],m.nextSibling,h));m.remove()}xa(z)};this.getDocumentTitle=function(){return c.getTitle(o)};this.setDocumentTitle=function(f){for(var h=o.childNodes,
m=false,z="",w=new ya("Change Image Title"),H=0;H<h.length;H++)if(h[H].nodeName=="title"){m=h[H];z=m.textContent;break}if(!m){m=g.createElementNS(b,"title");o.insertBefore(m,o.firstChild)}if(f.length)m.textContent=f;else m.parentNode.removeChild(m);w.addSubCommand(new Fa(m,{"#text":z}));xa(w)};this.getEditorNS=function(f){f&&o.setAttribute("xmlns:se","http://svg-edit.googlecode.com");return"http://svg-edit.googlecode.com"};this.setResolution=function(f,h){var m=Cb(),z=m.w;m=m.h;var w;if(f=="fit"){var H=
getStrokedBBox();if(H){w=new ya("Fit Canvas to Content");var D=tb();Qa(D);var v=[],E=[];$.each(D,function(){v.push(H.x*-1);E.push(H.y*-1)});D=c.moveSelectedElements(v,E,true);w.addSubCommand(D);Pa();f=Math.round(H.width);h=Math.round(H.height)}else return false}if(f!=z||h!=m){w||(w=new ya("Change Image Dimensions"));f=ta("width",f);h=ta("height",h);o.setAttribute("width",f);o.setAttribute("height",h);this.contentW=f;this.contentH=h;w.addSubCommand(new Fa(o,{width:z,height:m}));o.setAttribute("viewBox",
[0,0,f/q,h/q].join(" "));w.addSubCommand(new Fa(o,{viewBox:["0 0",z,m].join(" ")}));xa(w);if(background=document.getElementById("canvas_background")){background.setAttribute("x",-1);background.setAttribute("y",-1);background.setAttribute("width",f+2);background.setAttribute("height",h+2)}N("changed",[o])}return[f,h]};this.getOffset=function(){return $(o).attr(["x","y"])};this.setBBoxZoom=function(f,h,m){var z=0.85,w=function(H){if(!H)return false;var D=Math.min(Math.round(h/H.width*100*z)/100,Math.round(m/
H.height*100*z)/100);c.setZoom(D);return{zoom:D,bbox:H}};if(typeof f=="object"){f=f;if(f.width==0||f.height==0){c.setZoom(f.zoom?f.zoom:q*f.factor);return{zoom:q,bbox:f}}return w(f)}switch(f){case "selection":if(!I[0])return;f=$.map(I,function(H){if(H)return H});f=getStrokedBBox(f);break;case "canvas":f=Cb();z=0.95;f={width:f.w,height:f.h,x:0,y:0};break;case "content":f=getStrokedBBox();break;case "layer":f=getStrokedBBox(tb(A().getCurrentLayer()));break;default:return}return w(f)};this.setZoom=function(f){var h=
Cb();o.setAttribute("viewBox","0 0 "+h.w/f+" "+h.h/f);q=f;$.each(I,function(m,z){z&&Da.requestSelector(z).resize()});Ma.zoomChange();mb("zoomChanged",f)};this.getMode=function(){return Ba};this.setMode=function(f){Ma.clear();eb.clear();$("#workarea").attr("class",f);$a=I[0]&&I[0].nodeName=="text"?Xa:L;Ba=f};this.getColor=function(f){return $a[f]};this.setColor=function(f,h,m){L[f]=h;$a[f+"_paint"]={type:"solidColor"};for(var z=[],w=I.length;w--;){var H=I[w];if(H)if(H.tagName=="g")svgedit.utilities.walkTree(H,
function(D){D.nodeName!="g"&&z.push(D)});else if(f=="fill")H.tagName!="polyline"&&H.tagName!="line"&&z.push(H);else z.push(H)}if(z.length>0)if(m)Bb(f,h,z);else{jb(f,h,z);N("changed",z)}};var lb=function(){var f=o.getElementsByTagNameNS(b,"defs");if(f.length>0)f=f[0];else{f=g.createElementNS(b,"defs");o.firstChild?o.insertBefore(f,o.firstChild.nextSibling):o.appendChild(f)}return f},Mb=this.setGradient=function(f){if(!(!$a[f+"_paint"]||$a[f+"_paint"].type=="solidColor")){var h=c[f+"Grad"],m=Lb(h),
z=lb();if(m)h=m;else{h=z.appendChild(g.importNode(h,true));h.id=ka()}c.setColor(f,"url(#"+h.id+")");if(f=="canvas")(f=document.getElementById("canvas_background"))&&f.setAttribute("fill","url(#"+h.id+")")}},Lb=function(f){var h=lb();h=$(h).find("linearGradient, radialGradient");for(var m=h.length,z=["r","cx","cy","fx","fy"];m--;){var w=h[m];if(f.tagName=="linearGradient"){if(f.getAttribute("x1")!=w.getAttribute("x1")||f.getAttribute("y1")!=w.getAttribute("y1")||f.getAttribute("x2")!=w.getAttribute("x2")||
f.getAttribute("y2")!=w.getAttribute("y2"))continue}else{var H=$(f).attr(z),D=$(w).attr(z),v=false;$.each(z,function(s,C){if(H[C]!=D[C])v=true});if(v)continue}var E=f.getElementsByTagNameNS(b,"stop"),J=w.getElementsByTagNameNS(b,"stop");if(E.length==J.length){for(var G=E.length;G--;){var F=E[G],l=J[G];if(F.getAttribute("offset")!=l.getAttribute("offset")||F.getAttribute("stop-opacity")!=l.getAttribute("stop-opacity")||F.getAttribute("stop-color")!=l.getAttribute("stop-color"))break}if(G==-1)return w}}return null};
this.setPaint=function(f,h){var m=new $.jGraduate.Paint(h);this.setPaintOpacity(f,m.alpha/100,true);$a[f+"_paint"]=m;switch(m.type){case "solidColor":if(m.solidColor!="none"&&m.solidColor!="#none")this.setColor(f,"#"+m.solidColor);else{this.setColor(f,"none");document.querySelector(f=="fill"?"#fill_color rect":"#stroke_color rect").setAttribute("fill","none")}break;case "linearGradient":case "radialGradient":c[f+"Grad"]=m[m.type];Mb(f)}};this.getStrokeWidth=function(){return $a.stroke_width};this.setStrokeWidth=
function(f){if(f==0&&["line","path"].indexOf(Ba)>=0)c.setStrokeWidth(1);else{$a.stroke_width=f;for(var h=[],m=I.length;m--;){var z=I[m];if(z)z.tagName=="g"?svgedit.utilities.walkTree(z,function(w){w.nodeName!="g"&&h.push(w)}):h.push(z)}if(h.length>0){jb("stroke-width",f,h);N("changed",I)}}};this.setStrokeAttr=function(f,h){L[f.replace("-","_")]=h;for(var m=[],z=I.length;z--;){var w=I[z];if(w)w.tagName=="g"?svgedit.utilities.walkTree(w,function(H){H.nodeName!="g"&&m.push(H)}):m.push(w)}if(m.length>
0){jb(f,h,m);N("changed",I)}};this.getStyle=function(){return L};this.getOpacity=function(){return L.opacity};this.setOpacity=function(f){L.opacity=f;jb("opacity",f)};this.getFillOpacity=function(){return L.fill_opacity};this.getStrokeOpacity=function(){return L.stroke_opacity};this.setPaintOpacity=function(f,h,m){L[f+"_opacity"]=h;m?Bb(f+"-opacity",h):jb(f+"-opacity",h)};this.getBlur=function(f){var h=0;if(f)if(f.getAttribute("filter"))if(f=oa(f.id+"_blur"))h=f.firstChild.getAttribute("stdDeviation");
return h};(function(){function f(){var w=c.undoMgr.finishUndoableChange();h.addSubCommand(w);xa(h);m=h=null}var h=null,m=null,z=false;c.setBlurNoUndo=function(w){if(m)if(w===0){Bb("filter","");z=true}else{var H=I[0];z&&Bb("filter","url(#"+H.id+"_blur)");if(svgedit.browser.isWebkit()){H.removeAttribute("filter");H.setAttribute("filter","url(#"+H.id+"_blur)")}Bb("stdDeviation",w,[m.firstChild]);c.setBlurOffsets(m,w)}else c.setBlur(w)};c.setBlurOffsets=function(w,H){if(H>3)na(w,{x:"-50%",y:"-50%",width:"200%",
height:"200%"},100);else if(!svgedit.browser.isWebkit()){w.removeAttribute("x");w.removeAttribute("y");w.removeAttribute("width");w.removeAttribute("height")}};c.setBlur=function(w,H){if(h)f();else{var D=I[0],v=D.id;m=oa(v+"_blur");w-=0;var E=new ya;if(m){if(w===0)m=null}else{var J=W({element:"feGaussianBlur",attr:{"in":"SourceGraphic",stdDeviation:w}});m=W({element:"filter",attr:{id:v+"_blur"}});m.appendChild(J);lb().appendChild(m);E.addSubCommand(new Sa(m))}J={filter:D.getAttribute("filter")};if(w===
0){D.removeAttribute("filter");E.addSubCommand(new Fa(D,J))}else{jb("filter","url(#"+v+"_blur)");E.addSubCommand(new Fa(D,J));c.setBlurOffsets(m,w);h=E;c.undoMgr.beginUndoableChange("stdDeviation",[m?m.firstChild:null]);if(H){c.setBlurNoUndo(w);f()}}}}})();this.getBold=function(){var f=true;I.filter(Boolean).forEach(function(h){if(h.getAttribute("font-weight")!="bold")f=false});return f};this.setBold=function(f){var h=I.filter(Boolean);h.forEach(function(m){if(m!=null&&m.tagName=="text")jb("font-weight",
f?"bold":"normal")});h[0].textContent||eb.setCursor()};this.getItalic=function(){var f=true;I.filter(Boolean).forEach(function(h){if(h.getAttribute("font-style")!="italic")f=false});return f};this.setItalic=function(f){var h=I.filter(Boolean);h.forEach(function(m){if(m!=null&&m.tagName=="text")jb("font-style",f?"italic":"normal")});h[0].textContent||eb.setCursor()};this.getFontFamily=function(){return Xa.font_family};this.setFontFamily=function(f){Xa.font_family=f;jb("font-family",f);I[0]&&!I[0].textContent&&
eb.setCursor()};this.setFontColor=function(f){Xa.fill=f;jb("fill",f)};this.getFontSize=function(){return Xa.fill};this.getFontSize=function(){return Xa.font_size};this.setFontSize=function(f){Xa.font_size=f;jb("font-size",f);I[0].textContent||eb.setCursor()};this.getText=function(){var f=I[0];if(f==null)return"";return f.textContent};this.setTextContent=function(f){jb("#text",f);eb.init(f);eb.setCursor()};this.setImageURL=function(f){var h=I[0];if(h){var m=$(h).attr(["width","height"]);m=!m.width||
!m.height;var z=la(h);if(z!==f)m=true;else if(!m)return;var w=new ya("Change Image URL");ba(h,f);w.addSubCommand(new Fa(h,{"#href":z}));m?$(new Image).load(function(){var H=$(h).attr(["width","height"]);$(h).attr({width:this.width,height:this.height});Da.requestSelector(h).resize();w.addSubCommand(new Fa(h,H));xa(w);N("changed",[h])}).attr("src",f):xa(w)}};this.setLinkURL=function(f){var h=I[0];if(h){if(h.tagName!=="a"){h=$(h).parents("a");if(h.length)h=h[0];else return}var m=la(h);if(m!==f){var z=
new ya("Change Link URL");ba(h,f);z.addSubCommand(new Fa(h,{"#href":m}));xa(z)}}};this.elementsAreSame=function(f){return!f.length||f[0]==null?null:I.every(function(h){return h&&I[0]?h.nodeName==I[0].nodeName:null})};this.setRectRadius=function(f){c.elementsAreSame(I)&&I[0].tagName=="rect"&&I.forEach(function(h){var m=h.getAttribute("rx");if(m!=f){h.setAttribute("rx",f);h.setAttribute("ry",f);xa(new Fa(h,{rx:m,ry:m},"Radius"));N("changed",[h])}})};this.makeHyperlink=function(f){c.groupSelectedElements("a",
f)};this.removeHyperlink=function(){c.ungroupSelectedElement()};this.setSegType=function(f){Ma.setSegType(f)};this.convertToPath=function(f,h){if(f==null)$.each(I,function(V,S){S&&c.convertToPath(S)});else{if(!h)var m=new ya("Convert element to Path");var z=h?{}:{fill:L.fill,"fill-opacity":L.fill_opacity,stroke:L.stroke,"stroke-width":L.stroke_width,"stroke-dasharray":L.stroke_dasharray,"stroke-linejoin":L.stroke_linejoin,"stroke-linecap":L.stroke_linecap,"stroke-opacity":L.stroke_opacity,opacity:L.opacity,
visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){if(f.getAttribute(this))z[this]=f.getAttribute(this)});var w=W({element:"path",attr:z}),H=f.getAttribute("transform");H&&w.setAttribute("transform",H);var D=f.id,v=f.parentNode;f.nextSibling?v.insertBefore(w,f):v.appendChild(w);var E="",J=function(V){$.each(V,function(S,U){var Y=U[1];E+=U[0];for(var ha=0;ha<Y.length;ha+=2)E+=Y[ha]+","+Y[ha+1]+" "})},G=1.81;switch(f.tagName){case "ellipse":case "circle":var F=
$(f).attr(["rx","ry","cx","cy"]),l=F.cx,s=F.cy,C=F.rx;F=F.ry;if(f.tagName=="circle")C=F=$(f).attr("r");J([["M",[l-C,s]],["C",[l-C,s-F/G,l-C/G,s-F,l,s-F]],["C",[l+C/G,s-F,l+C,s-F/G,l+C,s]],["C",[l+C,s+F/G,l+C/G,s+F,l,s+F]],["C",[l-C/G,s+F,l-C,s+F/G,l-C,s]],["Z",[]]]);break;case "path":E=f.getAttribute("d");break;case "line":F=$(f).attr(["x1","y1","x2","y2"]);E="M"+F.x1+","+F.y1+"L"+F.x2+","+F.y2;break;case "polyline":case "polygon":E="M"+f.getAttribute("points");break;case "rect":F=$(f).attr(["rx",
"ry"]);C=F.rx;F=F.ry;var B=f.getBBox();l=B.x;s=B.y;var K=B.width;B=B.height;G=4-G;if(!C&&!F)J([["M",[l,s]],["L",[l+K,s]],["L",[l+K,s+B]],["L",[l,s+B]],["L",[l,s]],["Z",[]]]);else{F||(F=C);J([["M",[l,s+F]],["C",[l,s+F/G,l+C/G,s,l+C,s]],["L",[l+K-C,s]],["C",[l+K-C/G,s,l+K,s+F/G,l+K,s+F]],["L",[l+K,s+B-F]],["C",[l+K,s+B-F/G,l+K-C/G,s+B,l+K-C,s+B]],["L",[l+C,s+B]],["C",[l+C/G,s+B,l,s+B-F/G,l,s+B-F]],["L",[l,s+F]],["Z",[]]])}break;default:w.parentNode.removeChild(w)}E&&w.setAttribute("d",E);if(h){Ma.resetOrientation(w);
m=false;try{m=w.getBBox()}catch(P){}w.parentNode.removeChild(w);return m}else{if(H){H=T(w);ma(H)&&Ma.resetOrientation(w)}m.addSubCommand(new Ra(f,f.nextSibling,v));m.addSubCommand(new Sa(w));Pa();f.parentNode.removeChild(f);w.setAttribute("id",D);w.removeAttribute("visibility");Qa([w],true);xa(m)}}};var Bb=this.changeSelectedAttributeNoUndo=function(f,h,m){Ba=="pathedit"&&Ma.moveNode(f,h);m=m||I;for(var z=m.length,w=["g","polyline","path"];z--;){var H=m[z];if(H!=null){Ba==="textedit"&&f!=="#text"&&
H.textContent.length&&eb.toSelectMode(H);if((f==="x"||f==="y")&&w.indexOf(H.tagName)>=0){var D=getStrokedBBox([H]);c.moveSelectedElements((f==="x"?h-D.x:0)*q,(f==="y"?h-D.y:0)*q,true)}else{D=f==="#text"?H.textContent:H.getAttribute(f);if(D==null)D="";if(D!==String(h)){if(f=="#text"){svgedit.utilities.getBBox(H);H.textContent=h}else f=="#href"?ba(H,h):H.setAttribute(f,h);I.indexOf(H)>=0&&setTimeout(function(){H.parentNode&&Da.requestSelector(H).resize()},0);D=qa(H);if(D!=0&&f!="transform")for(var v=
T(H),E=v.numberOfItems;E--;)if(v.getItem(E).type==4){v.removeItem(E);var J=svgedit.utilities.getBBox(H),G=O(J.x+J.width/2,J.y+J.height/2,Z(v).matrix);J=G.x;G=G.y;var F=d.createSVGTransform();F.setRotate(D,J,G);v.insertItemBefore(F,E);break}}}}}},jb=this.changeSelectedAttribute=function(f,h,m){m=m||I;c.undoMgr.beginUndoableChange(f,m);Bb(f,h,m);f=c.undoMgr.finishUndoableChange();f.isEmpty()||xa(f)};this.deleteSelectedElements=function(){for(var f=new ya("Delete Elements"),h=I.length,m=[],z=0;z<h;++z){var w=
I[z];if(w==null)break;var H=w.parentNode,D=w;Da.releaseSelector(D);svgedit.path.removePath_(D.id);if(H.tagName==="a"&&H.childNodes.length===1){D=H;H=H.parentNode}var v=D.nextSibling;D=H.removeChild(D);m.push(w);I[z]=null;f.addSubCommand(new Ra(D,v,H))}f.isEmpty()||xa(f);N("changed",m);Pa()};this.cutSelectedElements=function(){for(var f=new ya("Cut Elements"),h=I.length,m=[],z=0;z<h;++z){var w=I[z];if(w==null)break;var H=w.parentNode,D=w;Da.releaseSelector(D);svgedit.path.removePath_(D.id);var v=D.nextSibling;
D=H.removeChild(D);m.push(w);I[z]=null;f.addSubCommand(new Ra(D,v,H))}f.isEmpty()||xa(f);N("changed",m);Pa();c.clipBoard=m};this.copySelectedElements=function(){c.clipBoard=$.merge([],I)};this.pasteElements=function(){var f=c.clipBoard,h=f.length;if(h){for(var m=[],z=new ya("Paste elements");h--;){var w=f[h];if(w){var H=ja(w);if(!oa(w.id))H.id=w.id;m.push(H);(M||A().getCurrentLayer()).appendChild(H);z.addSubCommand(new Sa(H))}}svgCanvas.clearSelection();setTimeout(function(){ub(m)},100);xa(z);N("changed",
m)}};this.groupSelectedElements=function(f){f||(f="g");var h="";switch(f){case "a":h="Make hyperlink";var m="";if(arguments.length>1)m=arguments[1];break;default:f="g";h="Group Elements"}h=new ya(h);var z=W({element:f,attr:{id:ka()}});f==="a"&&ba(z,m);h.addSubCommand(new Sa(z));for(m=I.length;m--;){var w=I[m];if(w!=null){if(w.parentNode.tagName==="a"&&w.parentNode.childNodes.length===1)w=w.parentNode;var H=w.nextSibling,D=w.parentNode;z.appendChild(w);h.addSubCommand(new Ha(w,H,D))}}h.isEmpty()||
xa(h);ub([z],true)};var Jb=this.pushGroupProperties=function(f,h){var m=f.childNodes,z=m.length,w=f.getAttribute("transform"),H=T(f),D=Z(H).matrix,v=new ya("Push group properties"),E=0,J=qa(f),G=$(f).attr(["filter","opacity"]),F,l;for(E=0;E<z;E++){var s=m[E];if(s.nodeType===1){if(G.opacity!==null&&G.opacity!==1){s.getAttribute("opacity");var C=Math.round((s.getAttribute("opacity")||1)*G.opacity*100)/100;jb("opacity",C,[s])}if(G.filter){var B=C=this.getBlur(s);l||(l=this.getBlur(f));if(C)C=l-0+(C-
0);else if(C===0)C=l;if(B)F=R(s.getAttribute("filter"));else if(F){F=ja(F);lb().appendChild(F)}else F=R(G.filter);F.id=s.id+"_"+(F.firstChild.tagName==="feGaussianBlur"?"blur":"filter");jb("filter","url(#"+F.id+")",[s]);if(C){jb("stdDeviation",C,[F.firstChild]);c.setBlurOffsets(F,C)}}C=T(s);if(~s.tagName.indexOf("Gradient"))C=null;if(C)if(s.tagName!=="defs")if(H.numberOfItems){if(J&&H.numberOfItems==1){var K=H.getItem(0).matrix,P=d.createSVGMatrix();if(B=qa(s))P=C.getItem(0).matrix;var V=svgedit.utilities.getBBox(s),
S=Z(C).matrix,U=O(V.x+V.width/2,V.y+V.height/2,S);V=J+B;S=d.createSVGTransform();S.setRotate(V,U.x,U.y);K=da(K,P,S.matrix.inverse());B&&C.removeItem(0);if(V)C.numberOfItems?C.insertItemBefore(S,0):C.appendItem(S);if(K.e||K.f){B=d.createSVGTransform();B.setTranslate(K.e,K.f);C.numberOfItems?C.insertItemBefore(B,0):C.appendItem(B)}}else{B=s.getAttribute("transform");K={};K.transform=B?B:"";B=d.createSVGTransform();K=Z(C).matrix;P=K.inverse();K=da(P,D,K);B.setMatrix(K);C.appendItem(B)}(s=Ta(s))&&v.addSubCommand(s)}}}if(w){K=
{};K.transform=w;f.setAttribute("transform","");f.removeAttribute("transform");v.addSubCommand(new Fa(f,K))}if(h&&!v.isEmpty())return v};this.ungroupSelectedElement=function(){var f=I[0];if($(f).data("gsvg")||$(f).data("symbol"))Pb(f);else if(f.tagName==="use"){var h=oa(la(f).substr(1));$(f).data("symbol",h).data("ref",h);Pb(f)}else{h=$(f).parents("a");if(h.length)f=h[0];if(f.tagName==="g"||f.tagName==="a"){h=new ya("Ungroup Elements");var m=Jb(f,true);m&&h.addSubCommand(m);m=f.parentNode;for(var z=
f.nextSibling,w=Array(f.childNodes.length),H=0;f.firstChild;){var D=f.firstChild,v=D.nextSibling,E=D.parentNode;if(D.tagName==="title"){h.addSubCommand(new Ra(D,D.nextSibling,E));E.removeChild(D)}else{w[H++]=D=m.insertBefore(D,z);h.addSubCommand(new Ha(D,v,E))}}Pa();z=f.nextSibling;f=m.removeChild(f);h.addSubCommand(new Ra(f,z,m));h.isEmpty()||xa(h);Qa(w)}}};this.moveToTopSelectedElement=function(){var f=I.filter(Boolean).reverse(),h=new ya("Move to top");f.forEach(function(m){m=m;var z=m.parentNode,
w=m.nextSibling;m=m.parentNode.appendChild(m);if(w!=m.nextSibling){h.addSubCommand(new Ha(m,w,z,"top"));N("changed",[m])}h.isEmpty()||xa(h)})};this.moveToBottomSelectedElement=function(){var f=I.filter(Boolean).reverse(),h=new ya("Move to top");f.forEach(function(m){m=m;var z=m.parentNode,w=m.nextSibling,H=m.parentNode.firstChild;if(H.tagName=="title")H=H.nextSibling;if(H.tagName=="defs")H=H.nextSibling;m=m.parentNode.insertBefore(m,H);if(w!=m.nextSibling){h.addSubCommand(new Ha(m,w,z,"bottom"));
N("changed",[m])}});h.isEmpty()||xa(h)};this.moveUpDownSelected=function(f){var h=I.filter(Boolean);f=="Down"&&h.reverse();var m=new ya("Move "+f);h.forEach(function(z){kb=[];var w,H,D=$(sb(getStrokedBBox([z]))).toArray();f=="Down"&&D.reverse();$.each(D,function(){if(H){w=this;return false}else if(this==z)H=true});if(w){D=z.parentNode;var v=z.nextSibling;$(w)[f=="Down"?"before":"after"](z);if(v!=z.nextSibling){m.addSubCommand(new Ha(z,v,D,"Move "+f));N("changed",[z])}}});m.isEmpty()||xa(m)};this.moveSelectedElements=
function(f,h,m){if(f.constructor!=Array){f/=q;h/=q}m=m||true;for(var z=new ya("position"),w=I.length;w--;){var H=I[w];if(H!=null){var D=d.createSVGTransform(),v=T(H);f.constructor==Array?D.setTranslate(f[w],h[w]):D.setTranslate(f,h);v.numberOfItems?v.insertItemBefore(D,0):v.appendItem(D);(D=Ta(H))&&z.addSubCommand(D);Da.requestSelector(H).resize()}}if(!z.isEmpty()){m&&xa(z);N("changed",I);return z}};this.cloneSelectedElements=function(f,h,m){for(var z=new ya("Clone Elements"),w=I.length,H=0;H<w;++H){var D=
I[H];if(D==null)break}w=I.slice(0,H);this.clearSelection(true);H=w.length;for(clones=[];H--;){D=w[H];var v=ja(w[H]),E=M||A().getCurrentLayer();if(m){tlist=T(v);tlist.removeItem(0);Ta(v);E.insertBefore(v,D)}else E.appendChild(v);clones.push(v);z.addSubCommand(new Sa(v))}if(!z.isEmpty()){Qa(w.reverse());m||this.moveSelectedElements(f,h,false);xa(z)}return clones};this.alignSelectedElements=function(f,h){var m=[],z=Number.MAX_VALUE,w=Number.MIN_VALUE,H=Number.MAX_VALUE,D=Number.MIN_VALUE,v=Number.MIN_VALUE,
E=Number.MIN_VALUE,J=I.length;if(J){for(var G=0;G<J;++G){if(I[G]==null)break;m[G]=getStrokedBBox([I[G]]);switch(h){case "smallest":if((f=="l"||f=="c"||f=="r")&&(v==Number.MIN_VALUE||v>m[G].width)||(f=="t"||f=="m"||f=="b")&&(E==Number.MIN_VALUE||E>m[G].height)){z=m[G].x;H=m[G].y;w=m[G].x+m[G].width;D=m[G].y+m[G].height;v=m[G].width;E=m[G].height}break;case "largest":if((f=="l"||f=="c"||f=="r")&&(v==Number.MIN_VALUE||v<m[G].width)||(f=="t"||f=="m"||f=="b")&&(E==Number.MIN_VALUE||E<m[G].height)){z=m[G].x;
H=m[G].y;w=m[G].x+m[G].width;D=m[G].y+m[G].height;v=m[G].width;E=m[G].height}break;default:if(m[G].x<z)z=m[G].x;if(m[G].y<H)H=m[G].y;if(m[G].x+m[G].width>w)w=m[G].x+m[G].width;if(m[G].y+m[G].height>D)D=m[G].y+m[G].height}}if(h=="page"){H=z=0;w=c.contentW;D=c.contentH}v=Array(J);E=Array(J);for(G=0;G<J;++G){if(I[G]==null)break;var F=m[G];v[G]=0;E[G]=0;switch(f){case "l":v[G]=z-F.x;break;case "c":v[G]=(z+w)/2-(F.x+F.width/2);break;case "r":v[G]=w-(F.x+F.width);break;case "t":E[G]=H-F.y;break;case "m":E[G]=
(H+D)/2-(F.y+F.height/2);break;case "b":E[G]=D-(F.y+F.height)}}this.moveSelectedElements(v,E)}};this.contentW=Cb().w;this.contentH=Cb().h;this.updateCanvas=function(f,h){d.setAttribute("width",f);d.setAttribute("height",h);var m=$("#canvasBackground")[0],z=o.getAttribute("x"),w=o.getAttribute("y"),H=f/2-this.contentW*q/2,D=h/2-this.contentH*q/2;na(o,{width:this.contentW*q,height:this.contentH*q,x:H,y:D,viewBox:"0 0 "+this.contentW+" "+this.contentH});na(m,{width:o.getAttribute("width"),height:o.getAttribute("height"),
x:H,y:D});(m=oa("background_image"))&&na(m,{width:"100%",height:"100%"});Da.selectorParentGroup.setAttribute("transform","translate("+H+","+D+")");return{x:H,y:D,old_x:z,old_y:w,d_x:H-z,d_y:D-w}};this.setBackground=function(f,h){var m=oa("canvasBackground"),z=$(m).find("rect")[0],w=oa("background_image");z.setAttribute("fill",f);if(h){if(!w){w=g.createElementNS(b,"image");na(w,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})}ba(w,h);m.appendChild(w)}else w&&
w.parentNode.removeChild(w)};this.cycleElement=function(f){var h=I[0],m=false,z=tb(M||A().getCurrentLayer());if(z.length){if(h==null){f=f?z.length-1:0;m=z[f]}else for(var w=z.length;w--;)if(z[w]==h){f=f?w-1:w+1;if(f>=z.length)f=0;else if(f<0)f=z.length-1;m=z[f];break}ub([m],true);N("selected",I)}};this.clear();this.getPrivateMethods=function(){return{addCommandToHistory:xa,setGradient:Mb,addSvgElementFromJson:W,assignAttributes:na,BatchCommand:ya,call:N,ChangeElementCommand:Fa,copyElem:ja,ffClone:ca,
findDefs:lb,findDuplicateGradient:Lb,getElem:oa,getId:aa,getIntersectionList:sb,getMouseTarget:Hb,getNextId:ka,getPathBBox:ea,getUrlFromAttr:ia,hasMatrixTransform:ma,identifyLayers:Fb,InsertElementCommand:Sa,isIdentity:svgedit.math.isIdentity,logMatrix:Za,matrixMultiply:da,MoveElementCommand:Ha,preventClickDefault:Db,recalculateAllSelectedDimensions:Ca,recalculateDimensions:Ta,remapElement:cb,RemoveElementCommand:Ra,removeUnusedDefElems:Ob,round:ab,runExtensions:mb,sanitizeSvg:La,SVGEditTransformList:svgedit.transformlist.SVGTransformList,
toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:Z,transformPoint:O,walkTree:svgedit.utilities.walkTree}}};(function(){document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",touchHandler,true);if(!window.methodDraw)window.methodDraw=function(a){function n(d,o){var u=e.setSvgString(d)!==false;o=o||a.noop;u?o(true):a.alert(uiStrings.notification.errorLoadingSVG,function(){o(false)})}var e,b={},k=false;curConfig={canvas_expansion:1,dimensions:[580,400],
initFill:{color:"fff",opacity:1},initStroke:{width:1.5,color:"000",opacity:1},initOpacity:1,imgPath:"images/",extPath:"extensions/",jGraduatePath:"lib/jgraduate/images/",extensions:[],initTool:"select",wireframe:false,colorPickerCSS:false,gridSnapping:false,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:svgedit.browser.isTouch()?false:true,show_outside_canvas:false,no_save_warning:true,initFont:"Helvetica, Arial, sans-serif"};uiStrings=b.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",
key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"<strong>Do you want to clear the drawing?</strong>\nThis will also erase your undo history",
QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",
saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...'}};var p={},c={};b.curConfig=curConfig;b.tool_scale=1;b.setConfig=function(d){a.extend(true,curConfig,d);if(d.extensions)curConfig.extensions=d.extensions};
b.setCustomHandlers=function(d){b.ready(function(){if(d.open){a('#tool_open > input[type="file"]').remove();a("#tool_open").show();e.open=d.open}if(d.save){b.show_save_warning=false;e.bind("saved",d.save)}d.pngsave&&e.bind("exported",d.pngsave);c=d})};b.randomizeIds=function(){e.randomizeIds(arguments)};b.init=function(){(function(){var l=window.opener;if(l)try{var s=l.document.createEvent("Event");s.initEvent("methodDrawReady",true,true);l.document.documentElement.dispatchEvent(s)}catch(C){}})();
a("body").toggleClass("touch",svgedit.browser.isTouch());a("#canvas_width").val(curConfig.dimensions[0]);a("#canvas_height").val(curConfig.dimensions[1]);var d=function(){a.each(curConfig.extensions,function(){var l=this;a.getScript(curConfig.extPath+l,function(s){if(!s){s=document.createElement("script");s.src=curConfig.extPath+l;document.querySelector("head").appendChild(s)}})})};document.location.protocol==="file:"?setTimeout(d,100):d();a.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:27,h:27,
id_match:false,no_img:true,fallback_path:curConfig.imgPath,fallback:{logo:"logo.png",select:"select.png",select_node:"select_node.png",pencil:"pencil.png",pen:"line.png",rect:"square.png",ellipse:"ellipse.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png","delete":"delete.png",spapelib:"shapelib.png",node_delete:"node_delete.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",
arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_node_clone":"node_clone","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath","#tool_openclose_path":"open_path","#tool_alignleft, #tool_posleft":"align_left",
"#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#zoomLabel":"zoom"},resize:{"#logo .svg_icon":15,".flyout_arrow_horiz .svg_icon":5,"#fill_bg .svg_icon, #stroke_bg .svg_icon":svgedit.browser.isTouch()?24:24,".palette_item:first .svg_icon":svgedit.browser.isTouch()?30:16,"#zoomLabel .svg_icon":16,
"#zoom_dropdown .svg_icon":7},callback:function(){a(".toolbar_button button > svg, .toolbar_button button > img").each(function(){a(this).parent().prepend(this)});a(".tool_button, .tool_button_current").addClass("loaded");var l=a("#tools_left");if(l.length!=0){l.offset();l.outerHeight()}a(".tools_flyout").each(function(){var s=a("#"+this.id+"_show"),C=s.attr("data-curopt");if(!s.children("svg, img").length){C=a(C).children().clone();if(C.length){C[0].removeAttribute("style");s.append(C)}}});methodDraw.runCallbacks();
setTimeout(function(){a(".flyout_arrow_horiz:empty").each(function(){a(this).append(a.getSvgIcon("arrow_right").width(5).height(5))})},1)}});a("#rulers").on("dblclick",function(l){a("#base_unit_container").css({top:l.pageY-10,left:l.pageX-50,display:"block"})});a("#base_unit_container").on("mouseleave mouseenter",function(){t=setTimeout(function(){a("#base_unit_container").fadeOut(500)},200);event.type=="mouseover"&&clearTimeout(t)});a("#base_unit").on("change",function(){savePreferences()});b.canvas=
e=new a.SvgCanvas(document.getElementById("svgcanvas"),curConfig);b.show_save_warning=false;b.paintBox={fill:null,stroke:null,canvas:null};d=navigator.platform.indexOf("Mac")>=0;var o=navigator.userAgent.indexOf("AppleWebKit")>=0,u=d?"meta+":"ctrl+",A=e.pathActions,q=e.undoMgr,M=svgedit.utilities,Q=curConfig.imgPath+"placeholder.svg",L=a("#workarea"),I=a("#cmenu_canvas"),W=null,T=1,O="toolbars",da="";d||a(".shortcut").each(function(){var l=a(this).text();a(this).text(l.split("\u2318").join("Ctrl+"))});
(function(){a("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var l=a("#dialog_box"),s=a("#dialog_buttons"),C=function(B,K,P,V){a("#dialog_content").html("<p>"+K.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt",B=="prompt");s.empty();var S=a('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(s);B!="alert"&&a('<input type="button" value="'+uiStrings.common.cancel+'">').appendTo(s).on("click touchstart",function(){l.hide();P(false)});
if(B=="prompt"){var U=a('<input type="text">').prependTo(s);U.val(V||"");U.bind("keydown","return",function(){S.trigger("click touchstart")})}B=="process"&&S.hide();l.show();S.on("click touchstart",function(){l.hide();var Y=B=="prompt"?U.val():true;P&&P(Y)}).focus();B=="prompt"&&U.focus()};a.alert=function(B,K){C("alert",B,K)};a.confirm=function(B,K){C("confirm",B,K)};a.process_cancel=function(B,K){C("process",B,K)};a.prompt=function(B,K,P){C("prompt",B,P,K)}})();var ma=function(){var l=a(".tool_button_current");
if(l.length&&l[0].id!=="tool_select"){l.removeClass("tool_button_current").addClass("tool_button");a("#tool_select").addClass("tool_button_current").removeClass("tool_button")}e.setMode("select")},Z=null,X=false,fa=false,ta="",ia=false,la=function(l,s){var C=e.getResolution(),B=L;a("#svgcanvas").position();if(B=e.setBBoxZoom(s,B.width()-15,B.height()-15)){var K=B.zoom;B=B.bbox;if(K<0.001)Da({value:0.1});else{typeof animatedZoom!="undefined"&&l.cancelAnimationFrame(animatedZoom);var P=Date.now(),V=
K-C.zoom;a("#zoom");var S=C.zoom,U=function(){var Y=(Date.now()-P)/500;Y=Math.pow(Y-1,3)+1;e.setZoom(S+V*Y);E();if(Y<1&&Y>-0.9)l.animatedZoom=requestAnimationFrame(U);else{a("#zoom").val(parseInt(K*100));a("option","#zoom_select").removeAttr("selected");a("option[value="+parseInt(K*100)+"]","#zoom_select").attr("selected","selected")}};U();e.getMode()=="zoom"&&B.width&&ma();Eb()}}};a("#cur_context_panel").delegate("a","click",function(){var l=a(this);l.attr("data-root")?e.leaveContext():e.setContext(l.text());
e.clearSelection();return false});var ba=function(){b.paintBox.fill.prep();b.paintBox.stroke.prep()},ea={},qa=function(l){a.each(l,function(s,C){var B=a(s).children(),K=s+"_show",P=a(K),V=false;B.addClass("tool_button").unbind("click mousedown mouseup").each(function(Y){var ha=C[Y];ea[ha.sel]=ha.fn;if(ha.isDefault)V=Y;Y=function(wa){var Ea=ha;if(wa.type==="keydown"){var ga=a(Ea.parent+"_show").hasClass("tool_button_current"),va=a(Ea.parent+"_show").attr("data-curopt");a.each(l[ha.parent],function(Ga,
Ja){if(Ja.sel==va)Ea=!wa.shiftKey||!ga?Ja:l[ha.parent][Ga+1]||l[ha.parent][0]})}if(a(this).hasClass("disabled"))return false;ra(K)&&Ea.fn();var za=Ea.icon?a.getSvgIcon(Ea.icon,true):a(Ea.sel).children().eq(0).clone();za[0].setAttribute("width",P.width());za[0].setAttribute("height",P.height());P.children(":not(.flyout_arrow_horiz)").remove();P.append(za).attr("data-curopt",Ea.sel)};a(this).mouseup(Y);ha.key&&a(document).bind("keydown",ha.key[0]+" shift+"+ha.key[0],Y)});if(V)P.attr("data-curopt",C[V].sel);
else P.attr("data-curopt")||P.attr("data-curopt",C[0].sel);var S,U=a(K).position();a(s).css({left:U.left+34,top:U.top+77});P.mousedown(function(Y){a("#workarea").one("mousedown",function(){a("#tools_shapelib").hide()});a("#tools_shapelib").is(":visible")&&ra(K,false);if(P.hasClass("disabled"))return false;var ha=a(s),wa=U.left+34,Ea=ha.width()*-1,ga=ha.data("shown_popop")?200:0;S=setTimeout(function(){P.data("isLibrary")?ha.css("left",wa).show():ha.css("left",Ea).show().animate({left:wa},50);ha.data("shown_popop",
true)},ga);Y.preventDefault()}).mouseup(function(){clearTimeout(S);var Y=a(this).attr("data-curopt");if(P.data("isLibrary")&&a(K.replace("_show","")).is(":visible"))ra(K,true);else ra(K)&&Y in ea&&ea[Y]()})});pa()},oa=function(l,s){return a("<div>",{"class":"tools_flyout",id:l}).appendTo("#svg_editor").append(s)},na=function(){a(".tools_flyout").each(function(){var l=a("#"+this.id+"_show"),s=l.offset();l=l.outerWidth();a(this).css({left:(s.left+l)*T,top:s.top})})},pa=function(){a(".tools_flyout").each(function(){var l=
a("#"+this.id+"_show");if(!l.data("isLibrary")){var s=[];a(this).children().each(function(){s.push(this.title)});l[0].title=s.join(" / ")}})},Ka,La=function(l,s,C){var B=null;if(l.indexOf("url(#")===0){l=(l=e.getRefElem(l))?l.cloneNode(true):a("#"+C+"_color defs *")[0];B={alpha:s};B[l.tagName]=l}else B=l.indexOf("#")===0?{alpha:s,solidColor:l.substr(1)}:{alpha:s,solidColor:"none"};return new a.jGraduate.Paint(B)},Ha=e.getResolution();if(curConfig.baseUnit!=="px"){Ha.w=svgedit.units.convertUnit(Ha.w)+
curConfig.baseUnit;Ha.h=svgedit.units.convertUnit(Ha.h)+curConfig.baseUnit}var Sa=function(l){e.createLayer("background");cur_shape=e.addSvgElementFromJson({element:"rect",attr:{x:-1,y:-1,width:Ha.w+2,height:Ha.h+2,stroke:"none",id:"canvas_background",opacity:1,fill:l||"#fff",style:"pointer-events:none"}});e.setCurrentLayer("Layer 1");e.setCurrentLayerPosition("1")};document.getElementById("canvas_background")||Sa();document.getElementById("canvas_background").getAttribute("fill");var Ra=b.setImageURL=
function(l){l||(l=Q);e.setImageURL(l);a("#image_url").val(l)},Fa=function(){var l=Z;if(l!=null&&!l.parentNode)l=null;if(X&&X[0]!=null&&!X[0].parentNode)X=false;var s=e.getCurrentDrawing().getCurrentLayerName(),C=e.getMode(),B=curConfig.baseUnit!=="px"?curConfig.baseUnit:null,K=C=="pathedit";if(K){a(".context_panel").hide();a("#path_node_panel").show();a("#stroke_panel").hide();s=A.getNodePoint();a("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button");a("#tool_node_delete").toggleClass("disabled",
!A.canDeleteNodes);Lb("#tool_openclose_path",A.closed_subpath?"open_path":"close_path");if(s){K=a("#seg_type");if(B){s.x=svgedit.units.convertUnit(s.x);s.y=svgedit.units.convertUnit(s.y)}a("#path_node_x").val(Math.round(s.x));a("#path_node_y").val(Math.round(s.y));if(s.type){K.val(s.type).removeAttr("disabled");a("#seg_type_label").html(s.type==4?"Straight":"Curve")}else K.val(4).attr("disabled","disabled")}a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").hide()}else{var P=
a("#cmenu_canvas li");a(".context_panel").hide();a(".menu_item","#edit_menu").addClass("disabled");a(".menu_item","#object_menu").addClass("disabled");if(X){X=X.filter(Boolean);(l=e.elementsAreSame(X)?X[0]:null)&&a("#tools_top").addClass("multiselected")}if(!l&&!X){a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").show()}if(l!=null){a("#stroke_panel").show();var V=l.nodeName,S=e.getRotationAngle(l);a("#angle").val(Math.round(S));S=e.getBlur(l);a("#blur").val(S);
if(!K&&C!="pathedit"){a("#selected_panel").show();a(".action_selected").removeClass("disabled");var U,Y;if(["g","polyline","path"].indexOf(V)>=0)if(C=e.getStrokedBBox([l])){U=C.x;Y=C.y}if(B){U=svgedit.units.convertUnit(U);Y=svgedit.units.convertUnit(Y)}a("#"+V+"_x").val(Math.round(U));a("#"+V+"_y").val(Math.round(Y));if(V==="polyline"){a("#path_x").val(Math.round(U));a("#path_y").val(Math.round(Y))}["image","text","path","g","use"].indexOf(V)==-1&&a(".action_path_convert_selected").removeClass("disabled");
V==="path"&&a(".action_path_selected").removeClass("disabled")}B=null;if(ha==="a"){B=e.getHref(l);a("#g_panel").show()}if(l.parentNode.tagName==="a")if(!a(l).siblings().length){a("#a_panel").show();B=e.getHref(l.parentNode)}a("#tool_make_link, #tool_make_link").toggle(!B);B&&a("#link_url").val(B);B={g:[],a:[],rect:["rx","width","height","x","y"],image:["width","height","x","y"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:["x","y"],use:[],path:[]};var ha=l.tagName;
a(l).data("gsvg")&&a("#g_panel").show();if(ha=="path"||ha=="polyline")a("#path_panel").show();if(B[ha]){B=B[ha];a("#"+ha+"_panel").show();ha=="rect"?a("#cornerRadiusLabel").show():a("#cornerRadiusLabel").hide();a.each(B,function(wa,Ea){var ga=l.getAttribute(Ea);if(curConfig.baseUnit!=="px"&&l[Ea])ga=svgedit.units.convertUnit(l[Ea].baseVal.value);var va=document.getElementById(ha+"_"+Ea);va.value=Math.round(ga)||0;va.getAttribute("data-cursor")==="true"&&a.fn.dragInput.updateCursor(va)});if(ha=="text"){B=
l.getAttribute("font-family");document.getElementById("font_family_dropdown").selectedIndex=3;a("#text_panel").css("display","inline");a("#tool_italic").toggleClass("active",e.getItalic());a("#tool_bold").toggleClass("active",e.getBold());a("#font_family").val(B);a("#font_size").val(l.getAttribute("font-size"));a("#text").val(l.textContent);a("#preview_font").text(B.split(",")[0].replace(/'/g,"")).css("font-family",B);e.addedNew&&setTimeout(function(){a("#text").focus().select()},100)}else if(ha==
"image")Ra(e.getHref(l));else if(ha==="g"||ha==="use"){a("#container_panel").show();a(".action_group_selected").removeClass("disabled");e.getTitle()}}P[(ha==="g"?"en":"dis")+"ableContextMenuItems"]("#ungroup");P[(ha==="g"||!X?"dis":"en")+"ableContextMenuItems"]("#group")}if(X){a("#multiselected_panel").show();a(".action_multi_selected").removeClass("disabled");P.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")}l||P.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");
q.getUndoStackSize()>0?a("#tool_undo").removeClass("disabled"):a("#tool_undo").addClass("disabled");q.getRedoStackSize()>0?a("#tool_redo").removeClass("disabled"):a("#tool_redo").addClass("disabled");e.addedNew=false;if(l&&!K||X){a("#selLayerNames").removeAttr("disabled").val(s);I.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")}}};a("#text").on("focus",function(){});a("#text").on("blur",function(){});e.bind("selected",function(l,s){var C=e.getMode();C==="select"&&
ma();if(C==="pathedit")return Fa();Z=s.length==1||s[1]==null?s[0]:null;s=s.filter(Boolean);X=s.length>=2?s:false;if(e.elementsAreSame(X))Z=X[0];if(Z!=null){a("#topic_input").val(e.getTopic()||"");a("#multiselected_panel").hide();if(Z!=null)switch(Z.tagName){case "use":a(".context_panel").hide();a("#use_panel").show();break;case "image":a(".context_panel").hide();a("#image_panel").show();break;case "foreignObject":a(".context_panel").hide();break;case "g":case "a":C=null;for(var B=Z.getElementsByTagName("*"),
K=0,P=B.length;K<P;K++){var V=B[K].getAttribute("stroke-width");if(K===0)C=V;else if(C!==V)C=null}a("#stroke_width").val(C===null?"0":C);Fa();break;default:a("#stroke_width").val(Z.getAttribute("stroke-width")||0);C=Z.getAttribute("stroke-dasharray")||"none";a("option","#stroke_style").removeAttr("selected");a('#stroke_style option[value="'+C+'"]').attr("selected","selected");a("#stroke_style").trigger("change");a.fn.dragInput.updateCursor(a("#stroke_width")[0]);a.fn.dragInput.updateCursor(a("#blur")[0])}if(Z!=
null){C=(Z.getAttribute("opacity")||1)*100;a("#group_opacity").val(C);a.fn.dragInput.updateCursor(a("#group_opacity")[0])}X.length&&a("#tools_top").addClass("multiselected")}else if(X.length){a(".context_panel").hide();a("#tools_top").removeClass("multiselected");a("#multiselected_panel").show()}else{a(".context_panel").hide();a("#canvas_panel").show();a("#tools_top").removeClass("multiselected")}e.runExtensions("selectedChanged",{elems:s,selectedElement:Z,multiselected:X})});e.bind("transition",
function(l,s){var C=e.getMode(),B=s[0];if(B){X=s.length>=2&&s[1]!=null?s:null;if(!X)switch(C){case "rotate":C=e.getRotationAngle(B);a("#angle").val(Math.round(C));rotateCursor(C);a("#tool_reorient").toggleClass("disabled",C==0)}e.runExtensions("elementTransition",{elems:s})}});e.bind("changed",function(l,s){var C=e.getMode();C==="select"&&ma();for(var B=0;B<s.length;++B){var K=s[B];if(K&&K.tagName==="svg")E();else if(K&&Z&&Z.parentNode==null)Z=K}b.show_save_warning=true;Fa();if(Z&&C==="select"){b.paintBox.fill.update();
b.paintBox.stroke.update()}e.runExtensions("elementChanged",{elems:s})});e.bind("saved",function(l,s){b.show_save_warning=false;s='<?xml version="1.0"?>\n'+s;var C=navigator.userAgent;if(~C.indexOf("MSIE"))lb(0,true);else{var B=l.open("data:image/svg+xml;base64,"+M.encode64(s)),K=a.pref("save_notice_done");if(K!=="all"){var P=uiStrings.notification.saveFromBrowser.replace("%s","SVG");if(C.indexOf("Gecko/")!==-1)if(s.indexOf("<defs")!==-1){P+="\n\n"+uiStrings.notification.defsFailOnSave;a.pref("save_notice_done",
"all");K="all"}else a.pref("save_notice_done","part");else a.pref("save_notice_done","all");K!=="part"&&B.alert(P)}}});e.bind("exported",function(l,s){var C=s.issues;a("#export_canvas").length||a("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var B=a("#export_canvas")[0];B.width=e.contentW;B.height=e.contentH;canvg(B,s.svg,{renderCallback:function(){var K=B.toDataURL("image/png");W.location.href=K;if(a.pref("export_notice_done")!=="all"){K=uiStrings.notification.saveFromBrowser.replace("%s",
"PNG");if(C.length)K+="\n\n"+uiStrings.notification.noteTheseIssues+"\n \u2022 "+C.join("\n \u2022 ");a.pref("export_notice_done","all");W.alert(K)}}})});e.bind("zoomed",la);e.bind("contextset",function(l,s){var C="";if(s){var B="";C='<a href="#" data-root="y">'+e.getCurrentDrawing().getCurrentLayerName()+"</a>";a(s).parentsUntil("#svgcontent > g").andSelf().each(function(){if(this.id){B+=" > "+this.id;C+=this!==s?' > <a href="#">'+this.id+"</a>":" > "+this.id}});ta=B}else ta=null;a("#cur_context_panel").toggle(!!s).html(C)});
e.bind("extension_added",function(l,s){function C(){if(Ka){clearTimeout(Ka);Ka=null}K||(Ka=setTimeout(function(){K=true;Jb(p.iconsize)},50))}var B=false,K=false,P=true,V=function(){if(s.callback&&!B&&P){B=true;s.callback()}},S=[];s.context_tools&&a.each(s.context_tools,function(Ea,ga){var va=ga.container_id?' id="'+ga.container_id+'"':"",za=a("#"+ga.panel);za.length||(za=a("<div>",{id:ga.panel}).appendTo("#tools_top").hide());switch(ga.type){case "tool_button":var Ga='<div class="tool_button">'+ga.id+
"</div>",Ja=a(Ga).appendTo(za);ga.events&&a.each(ga.events,function(Oa,nb){a(Ja).bind(Oa,nb)});break;case "select":Ga="<label"+va+'><select id="'+ga.id+'">';a.each(ga.options,function(Oa,nb){Ga+='<option value="'+Oa+'"'+(Oa==ga.defval?" selected":"")+">"+nb+"</option>"});Ga+="</select></label>";var bb=a(Ga).appendTo(za).find("select");a.each(ga.events,function(Oa,nb){a(bb).bind(Oa,nb)});break;case "button-select":Ga='<div id="'+ga.id+'" class="dropdown toolset" title="'+ga.title+'"><div id="cur_'+
ga.id+'" class="icon_label"></div><button></button></div>';va=a('<ul id="'+ga.id+'_opts"></ul>').appendTo("#option_lists");ga.colnum&&va.addClass("optcols"+ga.colnum);a(Ga).appendTo(za).children();S.push({elem:"#"+ga.id,list:"#"+ga.id+"_opts",title:ga.title,callback:ga.events.change,cur:"#cur_"+ga.id});break;case "input":Ga="<label"+va+'><span id="'+ga.id+'_label">'+ga.label+':</span><input id="'+ga.id+'" title="'+ga.title+'" size="'+(ga.size||"4")+'" value="'+(ga.defval||"")+'" type="text"/></label>';
var Wa=a(Ga).appendTo(za).find("input");ga.spindata&&Wa.SpinButton(ga.spindata);ga.events&&a.each(ga.events,function(Oa,nb){Wa.bind(Oa,nb)})}});if(s.buttons){var U={},Y={},ha=s.svgicons,wa={};a.each(s.buttons,function(Ea,ga){for(var va,za=ga.id,Ga=Ea;a("#"+za).length;)za=ga.id+"_"+ ++Ga;if(ha){U[za]=ga.icon;Ga=ga.svgicon?ga.svgicon:ga.id;if(ga.type=="app_menu")Y["#"+za+" > div"]=Ga;else Y["#"+za]=Ga}else va=ga.type=="menu"?"":a('<img src="'+ga.icon+'">');var Ja,bb;switch(ga.type){case "mode_flyout":case "mode":Ja=
"tool_button";if(ga.cls)Ja+=" "+ga.cls;bb="#tools_left";break;case "context":Ja="tool_button";bb="#"+ga.panel;a(bb).length||a("<div>",{id:ga.panel}).appendTo("#tools_top");break;case "menu":Ja="menu_item tool_button";bb="#"+(ga.after||ga.panel);break;case "app_menu":Ja="";bb=ga.parent||"#main_menu ul";a(bb).length||a("<div>",{id:ga.panel}).appendTo("#tools_top")}var Wa=a(ga.list||ga.type=="app_menu"?"<li/>":"<div/>").attr("id",za).attr("title",ga.title).addClass(Ja);if(!ga.includeWith&&!ga.list){if("position"in
ga)a(bb).children().eq(ga.position).before(Wa);else ga.type!="menu"||!ga.after?Wa.appendTo(bb):a(bb).after(Wa);if(ga.type=="mode_flyout"){Ga=a(Wa);Ja=Ga.parent();if(!Ga.parent().hasClass("tools_flyout")){var Oa=Ga[0].id.replace("tool_","tools_"),nb=Ga.clone().attr("id",Oa+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));Ga.before(nb);Ja=oa(Oa,Ga);Ja.data("isLibrary",true);nb.data("isLibrary",true)}Y["#"+Oa+"_show"]=ga.id;za=wa["#"+Ja[0].id]=[{sel:"#"+za,fn:ga.events.click,icon:ga.id,isDefault:true},
zb]}else if(ga.type=="app_menu"||ga.type=="menu")Wa.append(ga.title)}else if(ga.list){Wa.addClass("push_button");a("#"+ga.list+"_opts").append(Wa);if(ga.isDefault){a("#cur_"+ga.list).append(Wa.children().clone());Ga=ga.svgicon?ga.svgicon:ga.id;Y["#cur_"+ga.list]=Ga}}else if(ga.includeWith){bb=ga.includeWith;Ga=a(bb.button);Ja=Ga.parent();if(!Ga.parent().hasClass("tools_flyout")){Oa=Ga[0].id.replace("tool_","tools_");nb=Ga.clone().attr("id",Oa+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));
Ga.before(nb);Ja=oa(Oa,Ga)}var zb=D.getButtonData(bb.button);if(bb.isDefault)Y["#"+Oa+"_show"]=ga.id;za=wa["#"+Ja[0].id]=[{sel:"#"+za,fn:ga.events.click,icon:ga.id,key:ga.key,isDefault:ga.includeWith?ga.includeWith.isDefault:0},zb];Oa="position"in bb?bb.position:"last";zb=Ja.children().length;if(!isNaN(Oa)&&Oa>=0&&Oa<zb)Ja.children().eq(Oa).before(Wa);else{Ja.append(Wa);za.reverse()}}ha||Wa.append(va);ga.list||a.each(ga.events,function(Gb,Nb){if(Gb=="click")if(ga.type=="mode"){ga.includeWith?Wa.bind(Gb,
Nb):Wa.bind(Gb,function(){ra(Wa)&&Nb()});if(ga.key){a(document).bind("keydown",ga.key,Nb);ga.title&&Wa.attr("title",ga.title+" ["+ga.key+"]")}}else Wa.bind(Gb,Nb);else Wa.bind(Gb,Nb)});qa(wa)});a.each(S,function(){gb(this.elem,this.list,this.callback,{seticon:true})});if(ha)P=false;a.svgIcons(ha,{w:27,h:27,id_match:false,no_img:!o,fallback:U,placement:Y,callback:function(){p.iconsize&&p.iconsize!="m"&&C();P=true;V()}})}V()});e.textActions.setInputElem(a("#text")[0]);var ya='<div class="palette_item transparent" data-rgb="none"></div>                <div class="palette_item black" data-rgb="#000000"></div>                <div class="palette_item white" data-rgb="#ffffff"></div>';
["#444444","#482816","#422C10","#3B2F0E","#32320F","#293414","#1F361B","#153723","#0C372C","#083734","#0E353B","#1A333F","#273141","#332D40","#3E2A3C","#462735","#4B252D","#4D2425","#4C261D","#666666","#845335","#7B572D","#6F5C2A","#62612C","#546433","#46673D","#396849","#306856","#2D6862","#33666C","#426373","#535F75","#645A73","#74556D","#805064","#884D58","#8B4D4B","#894F3F","#999999","#C48157","#B8874D","#A98E49","#97944B","#849854","#729C62","#619E73","#559E84","#529D94","#5B9BA2","#6D97AB",
"#8391AE","#9A8AAB","#AF84A3","#BF7E96","#C97A86","#CE7975","#CC7C65","#BBBBBB","#FFB27C","#FABA6F","#E6C36A","#CFCA6D","#B8D078","#A0D58A","#8CD79F","#7DD8B5","#7AD6CA","#84D3DB","#9ACEE6","#B6C7EA","#D3BEE7","#EDB6DC","#FFAFCC","#FFAAB8","#FFA9A2","#FFAC8D","#DDDDDD","#FFE7A2","#FFF093","#FFFA8D","#FFFF91","#EEFF9F","#D1FFB4","#B9FFCE","#A8FFE9","#A4FFFF","#B1FFFF","#CBFFFF","#EDFFFF","#FFF5FF","#FFEBFF","#FFE2FF","#FFDCEC","#FFDBD2","#FFDFB8"].forEach(function(l){ya+='<div class="palette_item" style="background-color: '+
l+';" data-rgb="'+l+'"></div>'});a("#palette").append(ya);var xa=a("#tool_angle_indicator");a("#tool_reorient");rotateCursor=function(l){l="rotate("+l+"deg)";xa.css({"-webkit-transform":l,"-moz-transform":l,"-o-transform":l,"-ms-transform":l,transform:l})};var Da=function(l){var s=l.value/100;if(s<0.001)l.value=0.1;else{l=e.getZoom();var C=L;la(window,{width:0,height:0,x:(C[0].scrollLeft+C.width()/2)/l,y:(C[0].scrollTop+C.height()/2)/l,zoom:s},true)}};a("#stroke_style").change(function(){e.setStrokeAttr("stroke-dasharray",
a(this).val());a("#stroke_style_label").html(this.options[this.selectedIndex].text);window.opera&&a("<p/>").hide().appendTo("body").remove()});a("#seg_type").change(function(){e.setSegType(a(this).val());a("#seg_type_label").html(this.options[this.selectedIndex].text)});a("select").change(function(){a(this).blur()});a("#font_family").change(function(){e.setFontFamily(this.value)});a("#text").keyup(function(){e.setTextContent(this.value)});changeAttribute=function(l){var s=l.getAttribute("data-attr"),
C=l.getAttribute("data-multiplier")||1;C=parseFloat(C);C=l.value*C;if(!svgedit.units.isValidUnit(s,C,Z)){a.alert(uiStrings.notification.invalidAttrValGiven);l.value=Z.getAttribute(s);return false}e.changeSelectedAttributeNoUndo(s,C)};picking=false;a(document).on("mouseup",function(){picking=false});a("#palette").on("mousemove mousedown touchstart touchmove",".palette_item",function(l){l.preventDefault();if(l.type=="mousedown")picking=true;if(picking){var s=a("#tool_stroke").hasClass("active"),C=s?
"stroke":"fill",B=a(this).attr("data-rgb"),K=null,P=true;if(l.type=="mousedown")P=false;if(B==="transparent"||B==="initial"||B==="#none"){B="none";K=new a.jGraduate.Paint}else K=new a.jGraduate.Paint({alpha:100,solidColor:B.substr(1)});b.paintBox[C].setPaint(K);if(s){e.setColor("stroke",B,P);B!="none"&&e.getStrokeOpacity()!=1&&e.setPaintOpacity("stroke",1)}else{e.setColor("fill",B,P);B!="none"&&e.getFillOpacity()!=1&&e.setPaintOpacity("fill",1)}}}).bind("contextmenu",function(l){l.preventDefault()});
a("#toggle_stroke_tools").toggle(function(){a(".stroke_tool").css("display","table-cell");a(this).addClass("expanded");m()},function(){a(".stroke_tool").css("display","none");a(this).removeClass("expanded");m()});var ra=function(l,s){if(a(l).hasClass("disabled"))return false;if(a(l).parent().hasClass("tools_flyout"))return true;var C=C||"normal";s||a(".tools_flyout").fadeOut(C);a("#styleoverrides").text("");a(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");a(l).addClass("tool_button_current").removeClass("tool_button");
return true};(function(){var l=null,s=null,C=L[0],B=false,K=false;a("#svgcanvas").on("mousemove mouseup touchend",function(P){if(B!==false){C.scrollLeft-=P.clientX-l;C.scrollTop-=P.clientY-s;l=P.clientX;s=P.clientY;if(P.type==="mouseup"||P.type==="touchend")B=false;return false}}).on("mousedown touchmove",function(P){if(P.button===1||K===true||P.originalEvent.touches&&P.originalEvent.touches.length>=2){B=true;l=P.clientX;s=P.clientY;return false}});a(window).mouseup(function(){B=false});a(document).bind("keydown",
"space",function(P){P.preventDefault();e.spaceKey=K=true}).bind("keyup","space",function(P){P.preventDefault();e.spaceKey=K=false}).bind("keydown","alt",function(){e.getMode()==="zoom"&&L.addClass("out")}).bind("keyup","alt",function(){e.getMode()==="zoom"&&L.removeClass("out")})})();var ob=a(".menu"),vb=function(l){l.target.style.background="#fff";setTimeout(function(){l.target.style.background="#ddd"},50);setTimeout(function(){l.target.style.background="#fff"},150);setTimeout(function(){l.target.style.background=
"#ddd"},200);setTimeout(function(){l.target.style.background=""},200);setTimeout(function(){a("#menu_bar").removeClass("active")},220);return false};a(".menu_item").on("mousedown touchstart",function(l){vb(l)});a("svg, body").on("mousedown  touchstart",function(l){if(!(l.target.nodeName&&l.target.nodeName.toLowerCase()==="input"))if(!a(l.target).hasClass("menu_title")&&!a(l.target).parent().hasClass("menu_title"))!a(l.target).hasClass("disabled")&&a(l.target).hasClass("menu_item")?vb(l):a("#menu_bar").removeClass("active")});
a("#workarea").on("mousewheel",function(l,s,C,B){if(l.altKey||l.ctrlKey){l.preventDefault();zoom=parseInt(a("#zoom").val());a("#zoom").val(parseInt(zoom+B*(l.altKey?10:5))).change()}});a(".menu_title").on("mousedown",function(){a("#tools_shapelib").hide();a("#menu_bar").toggleClass("active");ob.removeClass("open");a(this).parent().addClass("open")}).on("mouseover",function(){ob.removeClass("open");a(this).parent().addClass("open")});b.addDropDown=function(l,s,C){if(a(l).length!=0){var B=a(l).find("button"),
K=a(l).find("ul").attr("id",a(l)[0].id+"-list");C||a("#option_lists").append(K);var P=false;C&&a(l).addClass("dropup");K.find("li").bind("mouseup",s);a(window).mouseup(function(){if(!P){B.removeClass("down");K.hide()}P=false});B.bind("mousedown",function(){if(B.hasClass("down")){B.removeClass("down");K.hide()}else{B.addClass("down");if(!C){var V=a(l).offset();K.css({top:V.top,left:V.left-110})}K.show();P=true}}).hover(function(){P=true}).mouseout(function(){P=false})}};var gb=function(l,s,C,B){var K=
a(l);s=a(s);var P=false,V=B.dropUp;V&&a(l).addClass("dropup");s.find("li").bind("mouseup",function(){if(B.seticon){Lb("#cur_"+K[0].id,a(this).children());a(this).addClass("current").siblings().removeClass("current")}C.apply(this,arguments)});a(window).mouseup(function(){if(!P){K.removeClass("down");s.hide();s.css({top:0,left:0})}P=false});s.height();a(l).bind("mousedown",function(){var S=a(l).offset();if(V){S.top-=s.height();S.left+=8}else S.top+=a(l).height();a(s).offset(S);if(K.hasClass("down")){K.removeClass("down");
s.hide();s.css({top:0,left:0})}else{K.addClass("down");s.show();P=true;return false}}).hover(function(){P=true}).mouseout(function(){P=false});B.multiclick&&s.mousedown(function(){P=true})};a("#font_family_dropdown").change(function(){var l=this.options[this.selectedIndex].value,s=this.options[this.selectedIndex].text;a("#preview_font").html(s).css("font-family",l);a("#font_family").val(l).change()});a("div","#position_opts").each(function(){this.addEventListener("mouseup",function(){var l=this.id.replace("tool_pos",
"").charAt(0);e.alignSelectedElements(l,"page")})});(function(){var l,s=function(){a(l).blur()};a("#svg_editor").find("button, select, input:not(#text)").focus(function(){l=this;O="toolbars";L.mousedown(s)}).blur(function(){O="canvas";L.unbind("mousedown",s);e.getMode()=="textedit"&&a("#text").focus()})})();var Va=function(){ra("#tool_select")&&e.setMode("select")},Ya=function(){ra("#tool_fhpath")&&e.setMode("fhpath")},Aa=function(){ra("#tool_line")&&e.setMode("line")},ua=function(){ra("#tool_rect")&&
e.setMode("rect")},db=function(){ra("#tool_ellipse")&&e.setMode("ellipse")},Ia=function(){ra("#tool_image")&&e.setMode("image")},Ua=function(){ra("#tool_zoom")&&e.setMode("zoom")},Ba=function(){if(ra("#tool_zoom")){Ab();ma()}},hb=function(){ra("#tool_text")&&e.setMode("text")},rb=function(){ra("#tool_path")&&e.setMode("path")},Xa=function(){if(Z!=null||X)e.deleteSelectedElements();A.getNodePoint()&&A.deletePathNode()},$a=function(){if(Z!=null||X){Qa(a("#edit_menu"));e.cutSelectedElements()}},wb=function(){if(Z!=
null||X){Qa(a("#edit_menu"));e.copySelectedElements()}},sa=function(){Qa(a("#edit_menu"));var l=e.getZoom(),s=(L[0].scrollLeft+L.width()/2)/l-e.contentW;l=(L[0].scrollTop+L.height()/2)/l-e.contentH;e.pasteElements("point",s,l)},kb=function(){if(Z!=null){Qa(a("#object_menu"));e.moveToTopSelectedElement()}},fb=function(){if(Z!=null){Qa(a("#object_menu"));e.moveToBottomSelectedElement()}},xb=function(){if(Z!=null){Qa(a("#object_menu"));e.moveUpDownSelected("Up")}},mb=function(){if(Z!=null){Qa(a("#object_menu"));
e.moveUpDownSelected("Down")}},ab=function(l){if(Z!=null){Qa(a("#object_menu"));e.moveUpDownSelected(l)}},sb=function(){if(Z!=null){e.convertToPath();var l=e.getSelectedElems();e.selectorManager.requestSelector(l[0]).reset(l[0]);e.selectorManager.requestSelector(l[0]).selectorRect.setAttribute("display","none");e.setMode("pathedit");A.toEditMode(l[0]);e.clearSelection();Fa()}},tb=function(){Z!=null&&A.reorient()},yb=function(){if(Z!=null||X)a.prompt(uiStrings.notification.enterNewLinkURL,"http://",
function(l){l&&e.makeHyperlink(l)})},ib=function(l,s){if(Z!=null||X){if(curConfig.gridSnapping){var C=e.getZoom()*curConfig.snappingStep;l*=C;s*=C}a("input").blur();e.moveSelectedElements(l,s)}},ja=function(){},aa=function(){A.getNodePoint()&&A.clonePathNode()},ka=function(){A.getNodePoint()&&A.deletePathNode()},N=function(){var l=a("#tool_add_subpath"),s=!l.hasClass("push_button_pressed");s?l.addClass("push_button_pressed").removeClass("tool_button"):l.removeClass("push_button_pressed").addClass("tool_button");
A.addSubPath(s)},R=function(){A.opencloseSubPath()},ca=function(){e.cycleElement(1)},Ca=function(){e.cycleElement(0)},Na=function(l,s){if(!(Z==null||X)){l||(s*=-1);var C=a("#angle").val()*1+s;e.setRotationAngle(C);Fa()}},Za=function(){var l=curConfig.dimensions;a.confirm(uiStrings.notification.QwantToClear,function(s){if(s){ma();e.deleteSelectedElements();e.clear();e.setResolution(l[0],l[1]);E(true);Sa();Ab();Fa();ba();e.runExtensions("onNewDocument")}})},cb=function(){e.setBold(!e.getBold());Fa()},
qb=function(){e.setItalic(!e.getItalic());Fa()},Ta=function(){if(!c.pngsave){var l=uiStrings.notification.loadingImage;W=window.open("data:text/html;charset=utf-8,<title>"+l+"</title><h1>"+l+"</h1>")}window.canvg?e.rasterExport():a.getScript("canvg/rgbcolor.js",function(){a.getScript("canvg/canvg.js",function(){e.rasterExport()})})},pb=function(){e.open()},Pa=function(){},Qa=function(l){var s=l.prev();s.css({background:"white",color:"black"});setTimeout(function(){s.removeAttr("style")},200)},ub=
function(){if(q.getUndoStackSize()>0){Qa(a("#edit_menu"));q.undo()}},Hb=function(){if(q.getRedoStackSize()>0){Qa(a("#edit_menu"));q.redo()}},Db=function(){if(X){Qa(a("#object_menu"));e.groupSelectedElements()}else if(Z){Qa(a("#object_menu"));e.ungroupSelectedElement()}},eb=function(){Qa(a("#edit_menu"));e.cloneSelectedElements(20,20)},Ma=function(){var l=this.id.replace("tool_align","").charAt(0);e.alignSelectedElements(l,a("#align_relative_to").val())},Ob=function(){var l=document.querySelector("#tool_stroke rect");
a("#tool_stroke").toggleClass("active");a("#tool_fill").toggleClass("active");var s=document.querySelector("#tool_fill rect"),C=s.getAttribute("fill"),B=l.getAttribute("fill");l=parseFloat(l.getAttribute("stroke-opacity"));if(isNaN(l))l=100;s=parseFloat(s.getAttribute("fill-opacity"));if(isNaN(s))s=100;B=La(B,l,"stroke");C=La(C,s,"fill");b.paintBox.fill.setPaint(B,true);b.paintBox.stroke.setPaint(C,true)},Ab=function(l){var s=e.getResolution();l=l?s.zoom*l:1;a("#zoom").val(l*100);e.setZoom(l);Eb();
E(true)},Ib=function(){Qa(a("#view_menu"));!a("#tool_wireframe").hasClass("push_button_pressed")?a("#tool_wireframe").addClass("push_button_pressed"):a("#tool_wireframe").removeClass("push_button_pressed");L.toggleClass("wireframe");if(!w){var l=a("#wireframe_rules");l.length?l.empty():a('<style id="wireframe_rules"></style>').appendTo("head");Eb()}},Kb=function(){Qa(a("#view_menu"));var l=!a("#tool_snap").hasClass("push_button_pressed");l?a("#tool_snap").addClass("push_button_pressed"):a("#tool_snap").removeClass("push_button_pressed");
curConfig.gridSnapping=l},Pb=function(){window.self!=window.top&&top.exit_fullscreen()},Fb=function(){Qa(a("#view_menu"));if(a("#tool_rulers").hasClass("push_button_pressed")){a("#tool_rulers").removeClass("push_button_pressed");a("#show_rulers").attr("checked",false);curConfig.showRulers=false}else{a("#tool_rulers").addClass("push_button_pressed");a("#show_rulers").attr("checked",true);curConfig.showRulers=true}a("#rulers").toggle(!!curConfig.showRulers)},Eb=function(){if(!w){var l="#workarea.wireframe #svgcontent * { stroke-width: "+
1/e.getZoom()+"px; }";a("#wireframe_rules").text(L.hasClass("wireframe")?l:"")}},Qb=function(){if(!ia){Qa(a("#view_menu"));ia=true;a("#tool_source_back").toggle(!ia);a("#svg_iframe").attr("src",e.getSvgString());a("#svg_iframe_view").fadeIn();a("#svg_iframe_textarea").focus().select()}},Cb=function(){a("#svg_iframe_view").hide();ia=false;a("#svg_iframe_textarea").blur()};Cb();var lb=function(l,s){if(!fa){Qa(a("#view_menu"));fa=true;a("#save_output_btns").toggle(!!s);a("#tool_source_back").toggle(!s);
var C=da=e.getSvgString();a("#svg_source_textarea").val(C);a("#svg_source_editor").fadeIn();a("#svg_source_textarea").focus().select()}},Mb=function(){if(fa){if(e.setSvgString(a("#svg_source_textarea").val())){e.clearSelection();h();Ab();ba()}else a.confirm(uiStrings.notification.QerrorsRevertToSource,function(l){if(!l)return false;e.clearSelection();h();Ab();ba()});ma()}},Lb=b.setIcon=function(l,s){var C=typeof s==="string"?a.getSvgIcon(s,true):s.clone();C?a(l).find("img").replaceWith(C):console.log("NOTE: Icon image missing: "+
s)},Bb;Bb=function(){var l=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,s=document.getElementsByTagName("script")[0],C;for(C in s.style)if(l.test(C))return C.match(l)[0];if("WebkitOpacity"in s.style)return"Webkit";if("KhtmlOpacity"in s.style)return"Khtml";return""}();var jb=function(l,s){Bb.toLowerCase();var C=["top","left","bottom","right"];l.each(function(){for(var B=a(this),K=B.outerWidth()*(s-1),P=B.outerHeight()*(s-1),V=0;V<4;V++){var S=C[V],U=B.data("orig_margin-"+S);if(U==null){U=parseInt(B.css("margin-"+
S));B.data("orig_margin-"+S,U)}U=U*s;if(S==="right")U+=K;else if(S==="bottom")U+=P;B.css("margin-"+S,U)}})},Jb=b.setIconSize=function(l,s){if(!(l==p.size&&!s)){var C=a("#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout"),B=1;B=typeof l=="number"?l:{s:0.75,m:1,l:1.25,xl:1.5}[l];b.tool_scale=T=B;na();var K=C.parents(":hidden");K.css("visibility","hidden").show();
jb(C,B);K.css("visibility","visible").hide();C=a("#tool_size_rules");if(C.length)C.empty();else C=a('<style id="tool_size_rules"></style>').appendTo("head");if(l!="m"){var P="";a.each(cssResizeRules,function(V,S){V="#svg_editor "+V.replace(/,/g,", #svg_editor");P+=V+"{";a.each(S,function(U,Y){if(typeof Y==="number")var ha=Y*B+"px";else if(Y[l]||Y.all)ha=Y[l]||Y.all;P+=U+":"+ha+";"});P+="}"});K="-"+Bb.toLowerCase()+"-";P+="#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout{"+
K+"transform: scale("+B+");} #svg_editor div.toolset .toolset {"+K+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+K+"transform: scale("+1/B+");}";C.text(P)}na()}},f=function(){a("#dialog_box").hide();if(fa){if(fa)da!==a("#svg_source_textarea").val()?a.confirm(uiStrings.notification.QignoreSourceChanges,function(l){l&&h()}):h();m()}else ta&&e.leaveContext()},h=function(){a("#svg_source_editor").hide();fa=false;a("#svg_source_textarea").blur()};a(window).width();a(window).height();
var m=a.noop;a(window).resize(function(){E()});(function(){L.scroll(function(){if(a("#ruler_x").length!=0)a("#ruler_x")[0].scrollLeft=L[0].scrollLeft;if(a("#ruler_y").length!=0)a("#ruler_y")[0].scrollTop=L[0].scrollTop})})();a("#url_notice").click(function(){a.alert(this.title)});a("#change_image_url").click(function(){var l=e.getHref(Z);l=l.indexOf("data:")===0?"":l;a.prompt(uiStrings.notification.enterNewImgURL,l,function(s){s&&Ra(s)})});var z=function(l){var s=l[0].id=="stroke_color"?"stroke":
"fill",C=l[0].id=="canvas_color";if(C)s="canvas";var B=b.paintBox[s].paint;l=s=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity";C=C?{right:175,top:50}:{left:50,bottom:50};a("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",containment:"window"}).removeAttr("style").css(C).jGraduate({paint:B,window:{pickerTitle:l},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(K){B=new a.jGraduate.Paint(K);b.paintBox[s].setPaint(B);
e.setPaint(s,B);a("#color_picker").hide()},function(){a("#color_picker").hide()})};d=function(l,s){var C=document.getElementById("canvas_background"),B={color:"fff",opacity:1};if(s=="stroke")B=curConfig.initStroke;if(s=="fill")B=curConfig.initFill;if(s=="canvas"&&C)if(C=C.getAttribute("fill").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))B={color:("0"+parseInt(C[1],10).toString(16)).slice(-2)+("0"+parseInt(C[2],10).toString(16)).slice(-2)+("0"+parseInt(C[3],10).toString(16)).slice(-2),opacity:1};C=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"          fill="#'+
B.color+'" opacity="'+B.opacity+'"/>          <defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;C=a(l)[0].appendChild(document.importNode(C,true));s==="canvas"?C.setAttribute("width",60.5):C.setAttribute("width","100%");this.rect=C.firstChild;this.defs=C.getElementsByTagName("defs")[0];this.grad=this.defs.firstChild;this.paint=new a.jGraduate.Paint({solidColor:B.color});this.type=s;this.setPaint=function(K,P){this.paint=K;var V="none",S=K.type,U=K.alpha/100;switch(S){case "solidColor":V=
K[S]=="none"||K[S]=="one"?"none":"#"+K[S];break;case "linearGradient":case "radialGradient":this.defs.removeChild(this.grad);this.grad=this.defs.appendChild(K[S]);V="url(#"+(this.grad.id="gradbox_"+this.type)+")"}this.rect.setAttribute("fill",V);this.rect.setAttribute("opacity",U);if(this.type=="canvas")if(S=document.getElementById("canvas_background")){Ha=e.getResolution();S.setAttribute("x",-1);S.setAttribute("y",-1);S.setAttribute("width",Ha.w+2);S.setAttribute("height",Ha.h+2);V.indexOf("url")==
-1&&S.setAttribute("fill",V)}else Sa(V);if(P){e.setColor(this.type,V,true);e.setPaintOpacity(this.type,U,true)}};this.update=function(K){if(Z){var P=this.type;switch(Z.tagName){case "use":case "image":case "foreignObject":return;case "g":case "a":for(var V=null,S=Z.getElementsByTagName("*"),U=0,Y=S.length;U<Y;U++){var ha=S[U].getAttribute(P);if(U===0)V=ha;else if(V!==ha){V=null;break}}if(V===null){S=null;return}S=V;V=1;break;default:V=parseFloat(Z.getAttribute(P+"-opacity"));if(isNaN(V))V=1;S=P===
"fill"?"black":"none";S=Z.getAttribute(P)||S}if(K){e.setColor(P,S,true);e.setPaintOpacity(P,V,true)}V*=100;this.setPaint(La(S,V,P))}};this.prep=function(){switch(this.paint.type){case "linearGradient":case "radialGradient":var K=new a.jGraduate.Paint({copy:this.paint});e.setPaint(s,K)}}};b.paintBox.fill=new d("#fill_color","fill");b.paintBox.stroke=new d("#stroke_color","stroke");b.paintBox.canvas=new d("#canvas_color","canvas");a("#stroke_width").val(curConfig.initStroke.width);a("#group_opacity").val(curConfig.initOpacity*
100);d=b.paintBox.fill.rect.cloneNode(false);d.setAttribute("style","vector-effect:non-scaling-stroke");var w=d.style.vectorEffect==="non-scaling-stroke";d.removeAttribute("style");d=b.paintBox.fill.rect.ownerDocument.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");typeof d.stdDeviationX==="undefined"&&a("#tool_blur").hide();a(d).remove();setTimeout(function(){e.embedImage("images/placeholder.svg",function(l){if(!l){a("#image_save_opts [value=embed]").attr("disabled","disabled");a("#image_save_opts input").val(["ref"]);
p.img_save="ref";a("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported)}})},1E3);a("#tool_fill").click(function(){if(a("#tool_fill").hasClass("active"))z(a("#fill_color"));else{a("#tool_fill").addClass("active");a("#tool_stroke").removeClass("active")}});a("#tool_stroke").on("click",function(){if(a("#tool_stroke").hasClass("active"))z(a("#stroke_color"));else{a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active")}});a("#tool_canvas").on("click touchstart",
function(){z(a("#canvas_color"))});a("#tool_stroke").on("touchstart",function(){a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active");z(a("#stroke_color"))});a("#tool_fill").on("touchstart",function(){a("#tool_fill").addClass("active");a("#tool_stroke").removeClass("active");z(a("#fill_color"))});a("#zoom_select").on("change",function(){var l=this.options[this.selectedIndex].text;l=l.split("%")[0];a("#zoom").val(l).trigger("change")});a(".push_button").mousedown(function(){a(this).hasClass("disabled")||
a(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){a(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){a(this).removeClass("push_button_pressed").addClass("push_button")});a(window).bind("load resize",function(){L.css("line-height",L.height()+"px")});var H=function(){var l=a("#canvas_width"),s=a("#canvas_height"),C=l.val(),B=s.val();if(C!="fit"&&!svgedit.units.isValidUnit("width",C)){a.alert(uiStrings.notification.invalidAttrValGiven);
l.parent().addClass("error");return false}l.parent().removeClass("error");if(B!="fit"&&!svgedit.units.isValidUnit("height",B)){a.alert(uiStrings.notification.invalidAttrValGiven);s.parent().addClass("error");return false}s.parent().removeClass("error");if(!e.setResolution(C,B)){a.alert(uiStrings.notification.noContentToFitTo);C=e.getResolution();l.val(C.w);s.val(C.h);return false}E()};a("#resolution").change(function(){var l=a("#canvas_width")[0],s=a("#canvas_height")[0];if(this.selectedIndex)if(this.value==
"content"){l.value="fit";s.value="fit";H();var C=e.getResolution();l.value=C.w;s.value=C.h}else{var B=this.value.split("x");B[0]=parseInt(B[0]);B[1]=parseInt(B[1]);var K=B[0]-l.value,P=B[1]-s.value,V=Date.now(),S=function(){var U=(Date.now()-V)/1E3;U=Math.pow(U-1,3)+1;l.value=(B[0]-K+U*K).toFixed(0);s.value=(B[1]-P+U*P).toFixed(0);H();if(U>=1){U=e.getResolution();a("#canvas_width").val(U.w.toFixed());a("#canvas_height").val(U.h.toFixed());a("#resolution_label").html("<div class='pull'>"+U.w+"<span>\u00d7</span></br>"+
U.h+"</div>")}else requestAnimationFrame(S)};S()}else{a("#resolution_label").html("Custom");l.removeAttribute("readonly");l.focus();l.select();if(l.value=="fit"){l.value=100;s.value=100}}});a("#zoom").change(function(){Da(this)});a("input,select").attr("autocomplete","off");var D=function(){var l=[{sel:"#tool_select",fn:Va,evt:"click",key:["V",true]},{sel:"#tool_fhpath",fn:Ya,evt:"click",key:["Q",true]},{sel:"#tool_line",fn:Aa,evt:"click",key:["L",true]},{sel:"#tool_rect",fn:ua,evt:"click",key:["R",
true],icon:"rect"},{sel:"#tool_ellipse",fn:db,evt:"mouseup",key:["C",true],icon:"ellipse"},{sel:"#tool_path",fn:rb,evt:"click",key:["P",true]},{sel:"#tool_text",fn:hb,evt:"click",key:["T",true]},{sel:"#tool_image",fn:Ia,evt:"mouseup"},{sel:"#tool_zoom",fn:Ua,evt:"mouseup",key:["Z",true]},{sel:"#tool_clear",fn:Za,evt:"mouseup",key:[u+"N",true]},{sel:"#tool_save",fn:function(){if(fa)Mb();else{Qa(a("#file_menu"));e.save({images:p.img_save,round_digits:6})}},evt:"mouseup",key:[u+"S",true]},{sel:"#tool_export",
fn:Ta,evt:"mouseup"},{sel:"#tool_open",fn:pb,evt:"mouseup"},{sel:"#tool_import",fn:Pa,evt:"mouseup"},{sel:"#tool_source",fn:lb,evt:"click",key:[u+"U",true]},{sel:"#tool_wireframe",fn:Ib,evt:"click"},{sel:"#tool_snap",fn:Kb,evt:"click"},{sel:"#tool_rulers",fn:Fb,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel,#tool_prefs_cancel",fn:f,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:Mb,evt:"click"},{sel:"#tool_delete,#tool_delete_multi",
fn:Xa,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:tb,evt:"click"},{sel:"#tool_node_link",fn:ja,evt:"change"},{sel:"#tool_node_clone",fn:aa,evt:"click"},{sel:"#tool_node_delete",fn:ka,evt:"click"},{sel:"#tool_openclose_path",fn:R,evt:"click"},{sel:"#tool_add_subpath",fn:N,evt:"click"},{sel:"#tool_move_top",fn:kb,evt:"click",key:u+"shift+up"},{sel:"#tool_move_bottom",fn:fb,evt:"click",key:u+"shift+down"},{sel:"#tool_move_up",fn:xb,evt:"click",key:[u+"up",true]},{sel:"#tool_move_down",
fn:mb,evt:"click",key:[u+"down",true]},{sel:"#tool_topath",fn:sb,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:yb,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:eb,evt:"click",key:[u+"D",true]},{sel:"#tool_group",fn:Db,evt:"click",key:[u+"G",true]},{sel:"#tool_ungroup",fn:Db,evt:"click",key:u+"shift+G"},{sel:"#tool_unlink_use",fn:Db,evt:"click"},{sel:"[id^=tool_align]",fn:Ma,evt:"click"},{sel:"#tool_undo",fn:ub,evt:"click",key:u+"z"},{sel:"#tool_redo",fn:Hb,evt:"click",key:["y",
true]},{sel:"#tool_cut",fn:$a,evt:"click",key:[u+"x",true]},{sel:"#tool_copy",fn:wb,evt:"click",key:u+"c"},{sel:"#tool_paste",fn:sa,evt:"click",key:u+"v"},{sel:"#tool_switch",fn:Ob,evt:"click",key:["x",true]},{sel:"#tool_bold",fn:cb,evt:"mousedown",key:[u+"B",true]},{sel:"#tool_italic",fn:qb,evt:"mousedown",key:[u+"I",true]},{sel:"#copy_save_done",fn:f,evt:"click"},{sel:"#tool_svg_iframe",fn:Qb,evt:"click"},{sel:"#tool_svg_iframe_close",fn:Cb,evt:"click"},{key:"ctrl+left",fn:function(){Na(0,1)}},
{key:"ctrl+right",fn:function(){Na(1,1)}},{key:"ctrl+shift+left",fn:function(){Na(0,5)}},{key:"ctrl+shift+right",fn:function(){Na(1,5)}},{key:"shift+O",fn:Ca},{key:"shift+P",fn:ca},{key:[u+"+",true],fn:function(){Ab(2)}},{key:[u+"-",true],fn:function(){Ab(0.5)}},{key:["up",true],fn:function(){ib(0,-1)}},{key:["down",true],fn:function(){ib(0,1)}},{key:["left",true],fn:function(){ib(-1,0)}},{key:["right",true],fn:function(){ib(1,0)}},{key:"shift+up",fn:function(){ib(0,-10)}},{key:"shift+down",fn:function(){ib(0,
10)}},{key:"shift+left",fn:function(){ib(-10,0)}},{key:"shift+right",fn:function(){ib(10,0)}},{key:["alt+up",true],fn:function(){e.cloneSelectedElements(0,-1)}},{key:["alt+down",true],fn:function(){e.cloneSelectedElements(0,1)}},{key:["alt+left",true],fn:function(){e.cloneSelectedElements(-1,0)}},{key:["alt+right",true],fn:function(){e.cloneSelectedElements(1,0)}},{key:["alt+shift+up",true],fn:function(){e.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",true],fn:function(){e.cloneSelectedElements(0,
10)}},{key:["alt+shift+left",true],fn:function(){e.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",true],fn:function(){e.cloneSelectedElements(10,0)}},{key:u+"A",fn:function(){e.selectAllInCurrentLayer()}},{key:"I",fn:function(){var C=a(".tool_button_current");if(C.length&&C[0].id!=="tool_eyedropper"){C.removeClass("tool_button_current").addClass("tool_button");a("#tool_eyedropper").addClass("tool_button_current").removeClass("tool_button")}e.setMode("eyedropper")}},{key:u+"shift+z",fn:Hb},
{key:"esc",fn:Pb}],s={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){var C={};a.each(l,function(B,K){if(K.sel){var P=a(K.sel);if(P.length==0)return true;if(K.evt){if(svgedit.browser.isTouch()&&K.evt==="click")K.evt="mousedown";P[K.evt](K.fn)}if(K.parent&&a(K.parent+"_show").length!=0){var V=a(K.parent);V.length||(V=oa(K.parent.substr(1)));V.append(P);a.isArray(C[K.parent])||(C[K.parent]=[]);C[K.parent].push(K)}}if(K.key){var S=K.fn,U=false;if(a.isArray(K.key)){V=
K.key[0];if(K.key.length>1)U=K.key[1]}else V=K.key;V+="";svgedit.browser.isMac&&V.indexOf("+")!=-1&&V.split("+")[0]=="ctrl"&&V.replace("ctrl","cmd");a.each(V.split("/"),function(ha,wa){a(document).bind("keydown",wa,function(Ea){S();U&&Ea.preventDefault();return false})});if(K.sel&&!K.hidekey&&P.attr("title")){var Y=P.attr("title").split("[")[0]+" ("+V+")";s[V]=K.sel;P.parents("#main_menu").length||P.attr("title",Y)}}});qa(C);a(window).bind("keydown","tab",function(B){if(O==="canvas"){B.preventDefault();
ca()}}).bind("keydown","shift+tab",function(B){if(O==="canvas"){B.preventDefault();Ca()}});a("#tool_zoom").dblclick(Ba)},setTitles:function(){a.each(s,function(C,B){var K=a(B).parents("#main_menu").length;a(B).each(function(){var P=K?a(this).text().split(" [")[0]:this.title.split(" [")[0],V="";a.each(C.split("/"),function(S,U){var Y=U.split("+"),ha="";if(Y.length>1){ha=Y[0]+"+";U=Y[1]}V+=(S?"/":"")+ha+(uiStrings["key_"+U]||U)});if(K)this.lastChild.textContent=P+" ["+V+"]";else this.title=P+" ["+V+
"]"})})},getButtonData:function(C){var B;a.each(l,function(K,P){if(P.sel===C)B=P});return B}}}();D.setAll();b.ready(function(){var l=curConfig.initTool,s=a("#tools_left, #svg_editor .tools_flyout"),C=s.find("#tool_"+l);l=s.find("#"+l);(C.length?C:l.length?l:a("#tool_select")).click().mouseup();curConfig.wireframe&&a("#tool_wireframe").click();curConfig.showlayers&&toggleSidePanel();a("#rulers").toggle(!!curConfig.showRulers)});a("#canvas_height").dragInput({min:10,max:null,step:10,callback:H,cursor:false,
dragAdjust:0.1});a("#canvas_width").dragInput({min:10,max:null,step:10,callback:H,cursor:false,dragAdjust:0.1});a("#rect_width").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_rx").dragInput({min:1,
max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_ry").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_r").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});
a("#image_height").dragInput({min:0,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_width").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});
a("#path_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,
cursor:false});a("#text_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#text_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_rx").dragInput({min:0,max:100,step:1,callback:changeAttribute,cursor:true});a("#stroke_width").dragInput({min:0,max:99,step:1,callback:function(l){var s=l.value;if(s==0&&Z&&["line","polyline"].indexOf(Z.nodeName)>=
0)s=l.value=1;e.setStrokeWidth(s)},cursor:true,smallStep:0.1,start:1.5});a("#angle").dragInput({min:-180,max:180,step:1,callback:function(l){console.log(l);e.setRotationAngle(l.value,true);rotateCursor(l.value);a("#tool_reorient").toggleClass("disabled",l.value==0)},cursor:false,dragAdjust:0.5});a("#font_size").dragInput({min:1,max:250,step:1,callback:function(l){e.setFontSize(l.value)},cursor:true,stepfunc:function(l,s){var C=l.value-0,B=C+s,K=B>=C;if(s===0)return C;return C>=24?K?Math.round(C*1.1):
Math.round(C/1.1):C<=1?K?C*2:C/2:B},dragAdjust:0.15});a("#group_opacity").dragInput({min:0,max:100,step:5,callback:changeAttribute,cursor:true,start:100});a("#blur").dragInput({min:0,max:10,step:0.1,callback:function(l,s){val=l.value;a("#blur").val(val);s?e.setBlur(val,true):e.setBlurNoUndo(val)},cursor:true,start:0});a("#zoom").val(e.getZoom()*100);a("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(l){switch(l){case "delete":Xa();break;case "cut":$a();break;case "copy":wb();break;
case "paste":e.pasteElements();break;case "paste_in_place":e.pasteElements("in_place");break;case "group":e.groupSelectedElements();break;case "ungroup":e.ungroupSelectedElement();break;case "move_front":kb();break;case "move_up":ab("Up");break;case "move_down":ab("Down");break;case "move_back":fb();break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(l)&&svgedit.contextmenu.getCustomHandler(l).call()}});a(".contextMenu li").mousedown(function(l){l.preventDefault()});a("#cmenu_canvas li").disableContextMenu();
I.enableContextMenuItems("#delete,#cut,#copy");a("#topic_save_button").on("click",function(){var l=a("#topic_input").val();e.setTopic(l);a.alert('El topico "'+l+'" guard\u00f3 correctamente')});window.onbeforeunload=function(){if(q.getUndoStackSize()===0)b.show_save_warning=false;if(!curConfig.no_save_warning&&b.show_save_warning)return uiStrings.notification.unsavedChanges};b.openPrep=function(l){a("#main_menu").hide();q.getUndoStackSize()===0?l(true):a.confirm(uiStrings.notification.QwantToOpen,
l)};if(window.FileReader){d=function(l){l.stopPropagation();l.preventDefault();a("#workarea").removeAttr("style");a("#main_menu").hide();var s=null;if(s=l.type=="drop"?l.dataTransfer.files[0]:this.files[0])if(s.type.indexOf("image")!=-1)if(s.type.indexOf("svg")!=-1){l=new FileReader;l.onloadend=function(C){e.importSvgString(C.target.result,true);e.ungroupSelectedElement();e.ungroupSelectedElement();e.groupSelectedElements();e.alignSelectedElements("m","page");e.alignSelectedElements("c","page")};
l.readAsText(s)}else{l=new FileReader;l.onloadend=function(C){insertNewImage=function(V,S){var U=e.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:V,height:S,id:e.getNextId(),style:"pointer-events:inherit"}});e.setHref(U,C.target.result);e.selectOnly([U]);e.alignSelectedElements("m","page");e.alignSelectedElements("c","page");Fa()};var B=100,K=100,P=new Image;P.src=C.target.result;document.body.appendChild(P);P.onload=function(){B=P.offsetWidth;K=P.offsetHeight;insertNewImage(B,K);document.body.removeChild(P)}};
l.readAsDataURL(s)}};L=a("#workarea");L[0].addEventListener("dragenter",function(l){l.stopPropagation();l.preventDefault();L.css({"-webkit-transform":"scale3d(1.1,1.1,1)","-moz-transform":"scale3d(1.1,1.1,1)","-o-transform":"scale(1.1)","-ms-transform":"scale3d(1.1,1.1,1)",transform:"scale3d(1.1,1.1,1)"})},false);L[0].addEventListener("dragover",function(l){l.stopPropagation();l.preventDefault()},false);L[0].addEventListener("dragleave",function(l){L.removeAttr("style");l.stopPropagation();l.preventDefault()},
false);L[0].addEventListener("drop",d,false);var v=a('<input type="file">').change(function(){var l=this;b.openPrep(function(s){if(s){e.clear();if(l.files.length==1){s=new FileReader;s.onloadend=function(C){n(C.target.result);E()};s.readAsText(l.files[0])}}})});a("#tool_open").show().prepend(v);d=a('<input type="file">').change(d);a("#tool_import").show().prepend(d)}var E=b.updateCanvas=function(l,s){var C=L.width(),B=L.height(),K=C,P=B,V=e.getZoom(),S=L,U=a("#svgcanvas"),Y={x:S[0].scrollLeft+K/2,
y:S[0].scrollTop+P/2},ha=curConfig.canvas_expansion;C=Math.max(K,e.contentW*V*ha);B=Math.max(P,e.contentH*V*ha);C==K&&B==P?L.css("overflow","hidden"):L.css("overflow","scroll");ha=U.height()/2;var wa=U.width()/2;U.width(C).height(B);var Ea=B/2,ga=C/2,va=e.updateCanvas(C,B),za=ga/wa;C=C/2-K/2;B=B/2-P/2;if(s){s.x+=va.x;s.y+=va.y}else s={x:ga+(Y.x-wa)*za,y:Ea+(Y.y-ha)*za};if(l)if(e.contentW>S.width()){L[0].scrollLeft=va.x-10;L[0].scrollTop=va.y-10}else{S[0].scrollLeft=C;S[0].scrollTop=B}else{S[0].scrollLeft=
s.x-K/2;S[0].scrollTop=s.y-P/2}if(curConfig.showRulers){K=U;V=V;document.getElementById("workarea");document.getElementById("title_show");V||(V=e.getZoom());K||(K=a("#svgcanvas"));P=e.getContentElem();S=svgedit.units.getTypeMap()[curConfig.baseUnit];for(U=0;U<2;U++){wa=(Y=U===0)?"x":"y";za=Y?"width":"height";ha=P.getAttribute(wa)-0;wa=a("#ruler_"+wa+" canvas:first");$hcanv=wa.clone();wa.replaceWith($hcanv);C=$hcanv[0];Ea=wa=K[za]()*2;C.parentNode.style[za]=Ea+"px";ga=0;var Ga;va=C.getContext("2d");
va.fillStyle="rgb(200,0,0)";va.fillRect(0,0,C.width,C.height);$hcanv.siblings().remove();if(wa>=3E4){var Ja=parseInt(wa/3E4)+1;Ga=Array(Ja);Ga[0]=va;for(B=1;B<Ja;B++){C[za]=3E4;var bb=C.cloneNode(true);C.parentNode.appendChild(bb);Ga[B]=bb.getContext("2d")}bb[za]=wa%3E4;wa=3E4}C[za]=wa;za=S*V;var Wa=50/za;C=1;for(B=0;B<J.length;B++){C=Ja=J[B];if(Wa<=Ja)break}Wa=C*za;va.font="normal 9px 'Lucida Grande', sans-serif";va.fillStyle="#777";for(var Oa=ha/za%C*za,nb=Oa-Wa;Oa<Ea;Oa+=Wa){nb+=Wa;B=Math.round(Oa)+
0.5;if(Y){va.moveTo(B,15);va.lineTo(B,0)}else{va.moveTo(15,B);va.lineTo(0,B)}Ja=(nb-ha)/za;if(C>=1)B=Math.round(Ja);else{B=(C+"").split(".")[1].length;B=Ja.toFixed(B)-0}if(B!==0&&B!==1E3&&B%1E3===0)B=B/1E3+"K";if(Y){va.fillText(B,Oa+2,8);va.fillStyle="#777"}else{Ja=(B+"").split("");for(B=0;B<Ja.length;B++){va.fillText(Ja[B],1,Oa+9+B*9);va.fillStyle="#777"}}Ja=Wa/10;for(B=1;B<10;B++){var zb=Math.round(Oa+Ja*B)+0.5;if(Ga&&zb>wa){ga++;va.stroke();if(ga>=Ga.length){B=10;Oa=Ea;continue}va=Ga[ga];Oa-=3E4;
zb=Math.round(Oa+Ja*B)+0.5}var Gb=B%2?12:10;if(Y){va.moveTo(zb,15);va.lineTo(zb,Gb)}else{va.moveTo(15,zb);va.lineTo(Gb,zb)}}}va.strokeStyle="#666";va.stroke()}L.scroll()}},J=[];for(d=0.1;d<1E5;d*=10){J.push(1*d);J.push(2*d);J.push(5*d)}E(true);try{var G=function(l){if(window.JSON&&JSON.stringify)return JSON.stringify(l);var s=arguments.callee;if(typeof l=="boolean"||typeof l=="number")return l+"";else if(typeof l=="string")return'"'+l.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
function(K){return"\\u"+("0000"+K.charCodeAt(0).toString(16)).slice(-4)})+'"';else if(l.length){for(var C=0;C<l.length;C++)l[C]=s(l[C]);return"["+l.join(",")+"]"}else{C=[];for(var B in l)C.push(s(B)+":"+s(l[B]));return"{"+C.join(",")+"}"}};window.addEventListener("message",function(l){var s=parseInt(l.data.substr(0,l.data.indexOf(";")));try{l.source.postMessage("SVGe"+s+";"+G(eval(l.data)),"*")}catch(C){l.source.postMessage("SVGe"+s+";error:"+C.message,"*")}},false)}catch(F){window.embed_error=F}a(function(){window.svgCanvas=
e;e.ready=methodDraw.ready});b.setLang=function(l,s){a.pref("lang",l);a("#lang_select").val(l);if(s){e.runExtensions("langChanged",l);pa();a.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(C,B){a(B).attr("title",a(C)[0].title)});a("#multiselected_panel div[id^=tool_align]").each(function(){a("#tool_pos"+this.id.substr(10))[0].title=this.title})}}};
var g=[];b.ready=function(d){k?d():g.push(d)};b.runCallbacks=function(){a.each(g,function(){this()});k=true};b.loadFromString=function(d){b.ready(function(){n(d)})};b.loadFromURL=function(d,o){o||(o={});var u=o.cache,A=o.callback;b.ready(function(){a.ajax({url:d,dataType:"text",cache:!!u,success:function(q){n(q,A)},error:function(q,M,Q){q.status!=404&&q.responseText?n(q.responseText,A):a.alert(uiStrings.notification.URLloadFail+": \n"+Q+"",A)}})})};b.loadFromDataURI=function(d){b.ready(function(){var o=
d.substring(26);n(svgedit.utilities.decode64(o))})};b.addExtension=function(){var d=arguments;a(function(){e&&e.addExtension.apply(this,d)})};return b}(jQuery);$(methodDraw.init)})();$.fn.dragInput=function(a){return this.each(function(){this.repeating=false;this.dragCfg={min:a&&!isNaN(parseFloat(a.min))?Number(a.min):null,max:a&&!isNaN(parseFloat(a.max))?Number(a.max):null,step:a&&Number(a.step)?a.step:1,stepfunc:a&&a.stepfunc?a.stepfunc:false,dragAdjust:a&&a.dragAdjust?a.dragAdjust:1,height:70,cursor:a&&a.cursor?Boolean(a.cursor):false,start:a&&a.start?Number(a.start):0,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:a&&a.callback?a.callback:null};this.dragCfg.smallStep=
a&&a.smallStep?a.smallStep:this.dragCfg.step/2;var n=this.dragCfg.dragAdjust,e=$(this).parent(),b=$(this),k=this.dragCfg.height,p=this.dragCfg.min,c=this.dragCfg.max,g=this.dragCfg.step,d=c-p>0?(c-p)/g:200,o=d/k*g,u=0,A=this.getAttribute("data-attr"),q=methodDraw.canvas,M=svgedit.browser.isTouch(),Q=true,L=d&&this.dragCfg.cursor?$("<div class='draginput_cursor' />").appendTo(e):false;b.attr("readonly","readonly");L&&!isNaN(this.dragCfg.start)&&L.css("top",this.dragCfg.start*-1/o+k);this.adjustValue=
function(I,W){var T;I=parseFloat(I);T=isNaN(this.value)?this.dragCfg.reset:$.isFunction(this.dragCfg.stepfunc)?this.dragCfg.stepfunc(this,I):Number((Number(this.value)+Number(I)).toFixed(5));if(c!==null)T=Math.min(T,c);if(p!==null)T=Math.max(T,p);L&&this.updateCursor(T);this.value=T;e.attr("data-value",T);$.isFunction(this.dragCfg.callback)&&this.dragCfg.callback(this,W)};e.toggleClass("draginput",e.is("label"));this.move=function(I,W,T){if(M)I=I.originalEvent.touches[0];if(u===0)u=W;W=(I.pageY-u)*
-1;u=I.pageY;T=W*o*n;this.adjustValue(T.toFixed(g<1?1:0))};this.stop=function(){var I=q.getSelectedElems();$("body").removeClass("dragging");e.removeClass("active");Q=true;$(window).unbind("mousemove.draginput touchmove.draginput mouseup.draginput touchend.draginput");u=0;if(I[0]){I=q.undoMgr.finishUndoableChange();I.isEmpty()||q.undoMgr.addCommandToHistory(I)}this.adjustValue(0,Q)};this.updateCursor=function(){var I=parseFloat(this.value)*-1/o+k;L.css("top",I)};this.launch=function(I){var W=q.getSelectedElems();
if(M)I=I.originalEvent.touches[0];var T=I.pageY,O=this.value,da=this;q.undoMgr.beginUndoableChange(A,W);$("body").addClass("dragging");e.addClass("active");$(window).bind("mousemove.draginput touchmove.draginput",function(ma){da.move(ma,T,parseFloat(O))});$(window).bind("mouseup.draginput touchend.draginput",function(){da.stop()})};$(this).attr("readonly","readonly").attr("data-scale",o).attr("data-domain",k).attr("data-cursor",L!=false).bind("mousedown touchstart",function(I){this.blur();this.launch(I)}).bind("dblclick taphold",
function(){this.removeAttribute("readonly","readonly");this.focus();this.select()}).keydown(function(I){switch(I.keyCode){case 13:this.adjustValue(0);this.blur()}}).focus(function(){this.getAttribute("readonly")==="readonly"&&this.blur()}).blur(function(){this.setAttribute("readonly","readonly")}).bind("mousewheel",function(I,W,T,O){W=q.getSelectedElems();Q&&q.undoMgr.beginUndoableChange(A,W);Q=false;clearTimeout(window.undoTimeout);window.undoTimeout=setTimeout(function(){da.stop()},200);var da=
this;if(O>0)this.adjustValue(this.dragCfg.step);else O<0&&this.adjustValue(-this.dragCfg.step);I.preventDefault()})})};$.fn.dragInput.updateCursor=function(a){var n=parseFloat(a.value),e=parseFloat(a.getAttribute("data-scale")),b=parseFloat(a.getAttribute("data-domain"));n=n*-1/e+b+"px";a=a.parentNode.lastChild;if(a.className=="draginput_cursor")a.style.top=n};svgedit=svgedit||{};
(function(){var a=this;if(!svgedit.contextmenu)svgedit.contextmenu={};a.contextMenuExtensions={};methodDraw.ready(function(){for(menuItem in contextMenuExtensions){var n=contextMenuExtensions[menuItem];Object.keys(a.contextMenuExtensions).length==0&&$("#cmenu_canvas").append("<li class='separator'>");var e=n.shortcut||"";$("#cmenu_canvas").append("<li class='disabled'><a href='#"+n.id+"'>"+n.label+"<span class='shortcut'>"+e+"</span></a></li>")}});svgedit.contextmenu.resetCustomMenus=function(){a.contextMenuExtensions=
{}};svgedit.contextmenu.add=function(n){if(n&&n.id&&n.label&&n.action&&typeof n.action=="function")if(n.id in a.contextMenuExtensions)console.error('Cannot add extension "'+n.id+'", an extension by that name already exists"');else{console.log("Registed contextmenu item: {id:"+n.id+", label:"+n.label+"}");a.contextMenuExtensions[n.id]=n}else console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")};svgedit.contextmenu.hasCustomHandler=
function(n){return a.contextMenuExtensions[n]&&true};svgedit.contextmenu.getCustomHandler=function(n){return a.contextMenuExtensions[n].action}})();(function(a,n){function e(k){return!a(k).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function b(k,p){var c=k.nodeName.toLowerCase();if("area"===c){c=k.parentNode;var g=c.name;if(!k.href||!g||c.nodeName.toLowerCase()!=="map")return false;c=a("img[usemap=#"+g+"]")[0];return!!c&&e(c)}return(/input|select|textarea|button|object/.test(c)?!k.disabled:"a"==c?k.href||p:p)&&e(k)}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(k,p){return typeof k=="number"?this.each(function(){var c=
this;setTimeout(function(){a(c).focus();p&&p.call(c)},k)}):this._focus.apply(this,arguments)},scrollParent:function(){var k;a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?k=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):k=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,
"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!k.length?a(document):k},zIndex:function(k){if(k!==n)return this.css("zIndex",k);if(this.length){k=a(this[0]);for(var p;k.length&&k[0]!==document;){p=k.css("position");if(p==="absolute"||p==="relative"||p==="fixed"){p=parseInt(k.css("zIndex"),10);if(!isNaN(p)&&p!==0)return p}k=k.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(k){k.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(k,p){function c(u,A,q,M){a.each(g,function(){A-=parseFloat(a.curCSS(u,"padding"+this,true))||0;q&&(A-=parseFloat(a.curCSS(u,"border"+this+"Width",true))||0);M&&(A-=parseFloat(a.curCSS(u,"margin"+this,true))||0)});return A}var g=p==="Width"?["Left","Right"]:["Top","Bottom"],d=p.toLowerCase(),o={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,
outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+p]=function(u){if(u===n)return o["inner"+p].call(this);return this.each(function(){a(this).css(d,c(this,u)+"px")})};a.fn["outer"+p]=function(u,A){if(typeof u!="number")return o["outer"+p].call(this,u);return this.each(function(){a(this).css(d,c(this,u,true,A)+"px")})}}),a.extend(a.expr[":"],{data:function(k,p,c){return!!a.data(k,c[3])},focusable:function(k){return b(k,!isNaN(a.attr(k,"tabindex")))},tabbable:function(k){var p=a.attr(k,
"tabindex"),c=isNaN(p);return(c||p>=0)&&b(k,!c)}}),a(function(){var k=document.body,p=k.appendChild(p=document.createElement("div"));a.extend(p.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=p.offsetHeight===100;a.support.selectstart="onselectstart"in p;k.removeChild(p).style.display="none"}),a.extend(a.ui,{plugin:{add:function(k,p,c){k=a.ui[k].prototype;for(var g in c){k.plugins[g]=k.plugins[g]||[];k.plugins[g].push([p,c[g]])}},call:function(k,p,c){if((p=k.plugins[p])&&
k.element[0].parentNode)for(var g=0;g<p.length;g++)k.options[p[g][0]]&&p[g][1].apply(k.element,c)}},contains:function(k,p){return document.compareDocumentPosition?k.compareDocumentPosition(p)&16:k!==p&&k.contains(p)},hasScroll:function(k,p){if(a(k).css("overflow")==="hidden")return false;var c=p&&p==="left"?"scrollLeft":"scrollTop",g=false;if(k[c]>0)return true;k[c]=1;g=k[c]>0;k[c]=0;return g},isOverAxis:function(k,p,c){return k>p&&k<p+c},isOver:function(k,p,c,g,d,o){return a.ui.isOverAxis(k,c,d)&&
a.ui.isOverAxis(p,g,o)}}))})(jQuery);
(function(a,n){if(a.cleanData){var e=a.cleanData;a.cleanData=function(k){for(var p=0,c;(c=k[p])!=null;p++)try{a(c).triggerHandler("remove")}catch(g){}e(k)}}else{var b=a.fn.remove;a.fn.remove=function(k,p){return this.each(function(){p||(!k||a.filter(k,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(c){}});return b.call(a(this),k,p)})}}a.widget=function(k,p,c){var g=k.split(".")[0],d;k=k.split(".")[1];d=g+"-"+k;c||(c=p,p=a.Widget);a.expr[":"][d]=
function(o){return!!a.data(o,k)};a[g]=a[g]||{};a[g][k]=function(o,u){arguments.length&&this._createWidget(o,u)};p=new p;p.options=a.extend(true,{},p.options);a[g][k].prototype=a.extend(true,p,{namespace:g,widgetName:k,widgetEventPrefix:a[g][k].prototype.widgetEventPrefix||k,widgetBaseClass:d},c);a.widget.bridge(k,a[g][k])};a.widget.bridge=function(k,p){a.fn[k]=function(c){var g=typeof c=="string",d=Array.prototype.slice.call(arguments,1),o=this;c=!g&&d.length?a.extend.apply(null,[true,c].concat(d)):
c;if(g&&c.charAt(0)==="_")return o;g?this.each(function(){var u=a.data(this,k),A=u&&a.isFunction(u[c])?u[c].apply(u,d):u;if(A!==u&&A!==n){o=A;return false}}):this.each(function(){var u=a.data(this,k);u?u.option(c||{})._init():a.data(this,k,new p(c,this))});return o}};a.Widget=function(k,p){arguments.length&&this._createWidget(k,p)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(k,p){a.data(p,this.widgetName,this);this.element=a(p);this.options=
a.extend(true,{},this.options,this._getCreateOptions(),k);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(k,p){var c=k;if(arguments.length===0)return a.extend({},this.options);if(typeof k=="string"){if(p===n)return this.options[k];c={};c[k]=p}this._setOptions(c);return this},_setOptions:function(k){var p=this;a.each(k,function(c,g){p._setOption(c,g)});return this},_setOption:function(k,p){this.options[k]=p;k==="disabled"&&this.widget()[p?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
p);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(k,p,c){var g,d=this.options[k];c=c||{};p=a.Event(p);p.type=(k===this.widgetEventPrefix?k:this.widgetEventPrefix+k).toLowerCase();p.target=this.element[0];if(k=p.originalEvent)for(g in k)g in p||(p[g]=k[g]);this.element.trigger(p,c);return!(a.isFunction(d)&&d.call(this.element[0],p,c)===false||p.isDefaultPrevented())}}})(jQuery);
(function(a){var n=false;a(document).mouseup(function(){n=false});a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(b){return e._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(true===a.data(b.target,e.widgetName+".preventClickEvent")){a.removeData(b.target,e.widgetName+".preventClickEvent");b.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(e){if(!n){this._mouseStarted&&this._mouseUp(e);this._mouseDownEvent=e;var b=this,k=e.which==1,p=typeof this.options.cancel=="string"&&e.target.nodeName?a(e.target).closest(this.options.cancel).length:false;if(!k||p||!this._mouseCapture(e))return true;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=true},this.options.delay));if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==
false;if(!this._mouseStarted){e.preventDefault();return true}}true===a.data(e.target,this.widgetName+".preventClickEvent")&&a.removeData(e.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(c){return b._mouseMove(c)};this._mouseUpDelegate=function(c){return b._mouseUp(c)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();return n=true}},_mouseMove:function(e){if(a.browser.msie&&
!(document.documentMode>=9)&&!e.button)return this._mouseUp(e);if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==false,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e));return!this._mouseStarted},_mouseUp:function(e){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&
(this._mouseStarted=false,e.target==this._mouseDownEvent.target&&a.data(e.target,this.widgetName+".preventClickEvent",true),this._mouseStop(e));return false},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){this.options.helper=="original"&&
!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(n){var e=this.options;
if(this.helper||e.disabled||a(n.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(n);if(!this.handle)return false;e.iframeFix&&a(e.iframeFix===true?"iframe":e.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")});return true},_mouseStart:function(n){var e=this.options;this.helper=
this._createHelper(n);this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:n.pageX-this.offset.left,top:n.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(n);this.originalPageX=n.pageX;this.originalPageY=n.pageY;e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt);e.containment&&this._setContainment();if(this._trigger("start",n)===false){this._clear();return false}this._cacheHelperProportions();a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,n);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(n,true);a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,n);return true},
_mouseDrag:function(n,e){this.position=this._generatePosition(n);this.positionAbs=this._convertPositionTo("absolute");if(!e){var b=this._uiHash();if(this._trigger("drag",n,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,n);return false},_mouseStop:function(n){var e=
false;a.ui.ddmanager&&!this.options.dropBehaviour&&(e=a.ui.ddmanager.drop(this,n));this.dropped&&(e=this.dropped,this.dropped=false);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!e||this.options.revert=="valid"&&e||this.options.revert===true||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,e)){var b=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),
function(){b._trigger("stop",n)!==false&&b._clear()})}else this._trigger("stop",n)!==false&&this._clear();return false},_mouseUp:function(n){this.options.iframeFix===true&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,n);return a.ui.mouse.prototype._mouseUp.call(this,n)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(n){var e=!this.options.handle||
!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==n.target&&(e=true)});return e},_createHelper:function(n){var e=this.options;n=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[n])):e.helper=="clone"?this.element.clone().removeAttr("id"):this.element;n.parents("body").length||n.appendTo(e.appendTo=="parent"?this.element[0].parentNode:e.appendTo);n[0]!=this.element[0]&&!/(fixed|absolute)/.test(n.css("position"))&&
n.css("position","absolute");return n},_adjustOffsetFromHelper:function(n){typeof n=="string"&&(n=n.split(" "));a.isArray(n)&&(n={left:+n[0],top:+n[1]||0});"left"in n&&(this.offset.click.left=n.left+this.margins.left);"right"in n&&(this.offset.click.left=this.helperProportions.width-n.right+this.margins.left);"top"in n&&(this.offset.click.top=n.top+this.margins.top);"bottom"in n&&(this.offset.click.top=this.helperProportions.height-n.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var n=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(n.left+=this.scrollParent.scrollLeft(),n.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)n={top:0,left:0};return{top:n.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:n.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var n=this.element.position();return{top:n.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:n.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var n=this.options;n.containment=="parent"&&(n.containment=this.helper[0].parentNode);if(n.containment=="document"||n.containment=="window")this.containment=[n.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,n.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
(n.containment=="document"?0:a(window).scrollLeft())+a(n.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(n.containment=="document"?0:a(window).scrollTop())+(a(n.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(n.containment)&&n.containment.constructor!=Array){n=a(n.containment);var e=n[0];if(e){n.offset();var b=a(e).css("overflow")!=
"hidden";this.containment=[(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0),(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0),(b?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),
10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=n}}else n.containment.constructor==Array&&(this.containment=n.containment)},_convertPositionTo:function(n,e){e||(e=this.position);var b=n=="absolute"?1:-1,k=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,p=/(html|body)/i.test(k[0].tagName);return{top:e.top+
this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():p?0:k.scrollTop())*b),left:e.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():p?0:k.scrollLeft())*b)}},_generatePosition:function(n){var e=this.options,b=this.cssPosition=="absolute"&&
(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,k=/(html|body)/i.test(b[0].tagName),p=n.pageX,c=n.pageY;if(this.originalPosition){var g;if(this.containment){if(this.relative_container){g=this.relative_container.offset();g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]}else g=this.containment;n.pageX-this.offset.click.left<g[0]&&(p=g[0]+this.offset.click.left);
n.pageY-this.offset.click.top<g[1]&&(c=g[1]+this.offset.click.top);n.pageX-this.offset.click.left>g[2]&&(p=g[2]+this.offset.click.left);n.pageY-this.offset.click.top>g[3]&&(c=g[3]+this.offset.click.top)}if(e.grid){c=e.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/e.grid[1])*e.grid[1]:this.originalPageY;c=g?c-this.offset.click.top<g[1]||c-this.offset.click.top>g[3]?c-this.offset.click.top<g[1]?c+e.grid[1]:c-e.grid[1]:c:c;p=e.grid[0]?this.originalPageX+Math.round((p-this.originalPageX)/
e.grid[0])*e.grid[0]:this.originalPageX;p=g?p-this.offset.click.left<g[0]||p-this.offset.click.left>g[2]?p-this.offset.click.left<g[0]?p+e.grid[0]:p-e.grid[0]:p:p}}return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():k?0:b.scrollTop()),left:p-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<
526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:b.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(n,e,b){b=b||this._uiHash();a.ui.plugin.call(this,n,[e,b]);n=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,n,e,
b)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.17"});a.ui.plugin.add("draggable","connectToSortable",{start:function(n,e){var b=a(this).data("draggable"),k=b.options,p=a.extend({},e,{item:b.element});b.sortables=[];a(k.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(b.sortables.push({instance:c,shouldRevert:c.options.revert}),
c.refreshPositions(),c._trigger("activate",n,p))})},stop:function(n,e){var b=a(this).data("draggable"),k=a.extend({},e,{item:b.element});a.each(b.sortables,function(){this.instance.isOver?(this.instance.isOver=0,b.cancelHelperRemoval=true,this.instance.cancelHelperRemoval=false,this.shouldRevert&&(this.instance.options.revert=true),this.instance._mouseStop(n),this.instance.options.helper=this.instance.options._helper,b.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):
(this.instance.cancelHelperRemoval=false,this.instance._trigger("deactivate",n,k))})},drag:function(n,e){var b=a(this).data("draggable"),k=this;a.each(b.sortables,function(){this.instance.positionAbs=b.positionAbs;this.instance.helperProportions=b.helperProportions;this.instance.offset.click=b.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(k).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",
true),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return e.helper[0]},n.target=this.instance.currentItem[0],this.instance._mouseCapture(n,true),this.instance._mouseStart(n,true,true),this.instance.offset.click.top=b.offset.click.top,this.instance.offset.click.left=b.offset.click.left,this.instance.offset.parent.left-=b.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=b.offset.parent.top-this.instance.offset.parent.top,
b._trigger("toSortable",n),b.dropped=this.instance.element,b.currentItem=b.element,this.instance.fromOutside=b),this.instance.currentItem&&this.instance._mouseDrag(n)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=true,this.instance.options.revert=false,this.instance._trigger("out",n,this.instance._uiHash(this.instance)),this.instance._mouseStop(n,true),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&
this.instance.placeholder.remove(),b._trigger("fromSortable",n),b.dropped=false)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var n=a("body"),e=a(this).data("draggable").options;n.css("cursor")&&(e._cursor=n.css("cursor"));n.css("cursor",e.cursor)},stop:function(){var n=a(this).data("draggable").options;n._cursor&&a("body").css("cursor",n._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(n,e){var b=a(e.helper),k=a(this).data("draggable").options;b.css("opacity")&&(k._opacity=
b.css("opacity"));b.css("opacity",k.opacity)},stop:function(n,e){var b=a(this).data("draggable").options;b._opacity&&a(e.helper).css("opacity",b._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var n=a(this).data("draggable");n.scrollParent[0]!=document&&n.scrollParent[0].tagName!="HTML"&&(n.overflowOffset=n.scrollParent.offset())},drag:function(n){var e=a(this).data("draggable"),b=e.options,k=false;if(e.scrollParent[0]!=document&&e.scrollParent[0].tagName!="HTML"){if(!b.axis||
b.axis!="x")e.overflowOffset.top+e.scrollParent[0].offsetHeight-n.pageY<b.scrollSensitivity?e.scrollParent[0].scrollTop=k=e.scrollParent[0].scrollTop+b.scrollSpeed:n.pageY-e.overflowOffset.top<b.scrollSensitivity&&(e.scrollParent[0].scrollTop=k=e.scrollParent[0].scrollTop-b.scrollSpeed);if(!b.axis||b.axis!="y")e.overflowOffset.left+e.scrollParent[0].offsetWidth-n.pageX<b.scrollSensitivity?e.scrollParent[0].scrollLeft=k=e.scrollParent[0].scrollLeft+b.scrollSpeed:n.pageX-e.overflowOffset.left<b.scrollSensitivity&&
(e.scrollParent[0].scrollLeft=k=e.scrollParent[0].scrollLeft-b.scrollSpeed)}else{if(!b.axis||b.axis!="x")n.pageY-a(document).scrollTop()<b.scrollSensitivity?k=a(document).scrollTop(a(document).scrollTop()-b.scrollSpeed):a(window).height()-(n.pageY-a(document).scrollTop())<b.scrollSensitivity&&(k=a(document).scrollTop(a(document).scrollTop()+b.scrollSpeed));if(!b.axis||b.axis!="y")n.pageX-a(document).scrollLeft()<b.scrollSensitivity?k=a(document).scrollLeft(a(document).scrollLeft()-b.scrollSpeed):
a(window).width()-(n.pageX-a(document).scrollLeft())<b.scrollSensitivity&&(k=a(document).scrollLeft(a(document).scrollLeft()+b.scrollSpeed))}k!==false&&a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(e,n)}});a.ui.plugin.add("draggable","snap",{start:function(){var n=a(this).data("draggable"),e=n.options;n.snapElements=[];a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),k=b.offset();this!=n.element[0]&&n.snapElements.push({item:this,
width:b.outerWidth(),height:b.outerHeight(),top:k.top,left:k.left})})},drag:function(n,e){for(var b=a(this).data("draggable"),k=b.options,p=k.snapTolerance,c=e.offset.left,g=c+b.helperProportions.width,d=e.offset.top,o=d+b.helperProportions.height,u=b.snapElements.length-1;u>=0;u--){var A=b.snapElements[u].left,q=A+b.snapElements[u].width,M=b.snapElements[u].top,Q=M+b.snapElements[u].height;if(A-p<c&&c<q+p&&M-p<d&&d<Q+p||A-p<c&&c<q+p&&M-p<o&&o<Q+p||A-p<g&&g<q+p&&M-p<d&&d<Q+p||A-p<g&&g<q+p&&M-p<o&&
o<Q+p){if(k.snapMode!="inner"){var L=Math.abs(M-o)<=p,I=Math.abs(Q-d)<=p,W=Math.abs(A-g)<=p,T=Math.abs(q-c)<=p;L&&(e.position.top=b._convertPositionTo("relative",{top:M-b.helperProportions.height,left:0}).top-b.margins.top);I&&(e.position.top=b._convertPositionTo("relative",{top:Q,left:0}).top-b.margins.top);W&&(e.position.left=b._convertPositionTo("relative",{top:0,left:A-b.helperProportions.width}).left-b.margins.left);T&&(e.position.left=b._convertPositionTo("relative",{top:0,left:q}).left-b.margins.left)}var O=
L||I||W||T;if(k.snapMode!="outer"){L=Math.abs(M-d)<=p;I=Math.abs(Q-o)<=p;W=Math.abs(A-c)<=p;T=Math.abs(q-g)<=p;L&&(e.position.top=b._convertPositionTo("relative",{top:M,left:0}).top-b.margins.top);I&&(e.position.top=b._convertPositionTo("relative",{top:Q-b.helperProportions.height,left:0}).top-b.margins.top);W&&(e.position.left=b._convertPositionTo("relative",{top:0,left:A}).left-b.margins.left);T&&(e.position.left=b._convertPositionTo("relative",{top:0,left:q-b.helperProportions.width}).left-b.margins.left)}!b.snapElements[u].snapping&&
(L||I||W||T||O)&&b.options.snap.snap&&b.options.snap.snap.call(b.element,n,a.extend(b._uiHash(),{snapItem:b.snapElements[u].item}));b.snapElements[u].snapping=L||I||W||T||O}else{b.snapElements[u].snapping&&b.options.snap.release&&b.options.snap.release.call(b.element,n,a.extend(b._uiHash(),{snapItem:b.snapElements[u].item}));b.snapElements[u].snapping=false}}}});a.ui.plugin.add("draggable","stack",{start:function(){var n=a(this).data("draggable").options;n=a.makeArray(a(n.stack)).sort(function(b,
k){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(k).css("zIndex"),10)||0)});if(n.length){var e=parseInt(n[0].style.zIndex)||0;a(n).each(function(b){this.style.zIndex=e+b});this[0].style.zIndex=e+n.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(n,e){var b=a(e.helper),k=a(this).data("draggable").options;b.css("zIndex")&&(k._zIndex=b.css("zIndex"));b.css("zIndex",k.zIndex)},stop:function(n,e){var b=a(this).data("draggable").options;b._zIndex&&a(e.helper).css("zIndex",b._zIndex)}})})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var n=this,e=this.options,b=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),k=e.values&&e.values.length||1,p=[];this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(e.disabled?" ui-slider-disabled ui-disabled":""));this.range=a([]);e.range&&(e.range===true&&(e.values||(e.values=[this._valueMin(),this._valueMin()]),e.values.length&&e.values.length!==2&&(e.values=[e.values[0],e.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(e.range==="min"||e.range==="max"?" ui-slider-range-"+e.range:"")));for(var c=b.length;c<k;c+=1)p.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=b.add(a(p.join("")).appendTo(n.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(g){g.preventDefault()}).hover(function(){e.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){e.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(g){a(this).data("index.ui-slider-handle",
g)});this.handles.keydown(function(g){var d=true,o=a(this).data("index.ui-slider-handle"),u,A,q;if(!n.options.disabled){switch(g.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:d=false;if(!n._keySliding){n._keySliding=true;a(this).addClass("ui-state-active");u=n._start(g,o);if(u===false)return}}u=n.options.step;n.options.values&&n.options.values.length?
A=q=n.values(o):A=q=n.value();switch(g.keyCode){case a.ui.keyCode.HOME:q=n._valueMin();break;case a.ui.keyCode.END:q=n._valueMax();break;case a.ui.keyCode.PAGE_UP:q=n._trimAlignValue(A+(n._valueMax()-n._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:q=n._trimAlignValue(A-(n._valueMax()-n._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(A===n._valueMax())return;q=n._trimAlignValue(A+u);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(A===n._valueMin())return;q=n._trimAlignValue(A-
u)}n._slide(g,o,q);return d}}).keyup(function(g){var d=a(this).data("index.ui-slider-handle");n._keySliding&&(n._keySliding=false,n._stop(g,d),n._change(g,d),a(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();
return this},_mouseCapture:function(n){var e=this.options,b,k,p,c,g;if(e.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();b=this._normValueFromMouse({x:n.pageX,y:n.pageY});k=this._valueMax()-this._valueMin()+1;c=this;this.handles.each(function(d){var o=Math.abs(b-c.values(d));k>o&&(k=o,p=a(this),g=d)});e.range===true&&this.values(1)===e.min&&(g+=1,p=a(this.handles[g]));if(this._start(n,g)===false)return false;
this._mouseSliding=true;c._handleIndex=g;p.addClass("ui-state-active").focus();e=p.offset();this._clickOffset=!a(n.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:n.pageX-e.left-p.width()/2,top:n.pageY-e.top-p.height()/2-(parseInt(p.css("borderTopWidth"),10)||0)-(parseInt(p.css("borderBottomWidth"),10)||0)+(parseInt(p.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(n,g,b);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(n){var e=
this._normValueFromMouse({x:n.pageX,y:n.pageY});this._slide(n,this._handleIndex,e);return false},_mouseStop:function(n){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(n,this._handleIndex);this._change(n,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(n){var e,b;this.orientation==="horizontal"?
(e=this.elementSize.width,b=n.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,b=n.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));n=b/e;n>1&&(n=1);n<0&&(n=0);this.orientation==="vertical"&&(n=1-n);e=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+n*e)},_start:function(n,e){var b={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(e),
b.values=this.values());return this._trigger("start",n,b)},_slide:function(n,e,b){var k,p,c;this.options.values&&this.options.values.length?(k=this.values(e?0:1),this.options.values.length===2&&this.options.range===true&&(e===0&&b>k||e===1&&b<k)&&(b=k),b!==this.values(e)&&(p=this.values(),p[e]=b,c=this._trigger("slide",n,{handle:this.handles[e],value:b,values:p}),this.values(e?0:1),c!==false&&this.values(e,b,true))):b!==this.value()&&(c=this._trigger("slide",n,{handle:this.handles[e],value:b}),c!==
false&&this.value(b))},_stop:function(n,e){var b={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(e),b.values=this.values());this._trigger("stop",n,b)},_change:function(n,e){if(!this._keySliding&&!this._mouseSliding){var b={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(e),b.values=this.values());this._trigger("change",n,b)}},value:function(n){if(arguments.length){this.options.value=
this._trimAlignValue(n);this._refreshValue();this._change(null,0)}else return this._value()},values:function(n,e){var b,k,p;if(arguments.length>1){this.options.values[n]=this._trimAlignValue(e);this._refreshValue();this._change(null,n)}else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(n):this.value();b=this.options.values;k=arguments[0];for(p=0;p<b.length;p+=1){b[p]=this._trimAlignValue(k[p]);this._change(null,
p)}this._refreshValue()}},_setOption:function(n,e){var b,k=0;a.isArray(this.options.values)&&(k=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(n){case "disabled":e?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",true),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",false),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(b=0;b<k;b+=1)this._change(null,b);this._animateOff=false}},_value:function(){var n=this.options.value;return n=this._trimAlignValue(n)},_values:function(n){var e,b;if(arguments.length){e=this.options.values[n];
return e=this._trimAlignValue(e)}e=this.options.values.slice();for(b=0;b<e.length;b+=1)e[b]=this._trimAlignValue(e[b]);return e},_trimAlignValue:function(n){if(n<=this._valueMin())return this._valueMin();if(n>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,b=(n-this._valueMin())%e;n=n-b;Math.abs(b)*2>=e&&(n+=b>0?e:-e);return parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var n=
this.options.range,e=this.options,b=this,k=this._animateOff?false:e.animate,p,c={},g,d,o,u;this.options.values&&this.options.values.length?this.handles.each(function(A){p=(b.values(A)-b._valueMin())/(b._valueMax()-b._valueMin())*100;c[b.orientation==="horizontal"?"left":"bottom"]=p+"%";a(this).stop(1,1)[k?"animate":"css"](c,e.animate);b.options.range===true&&(b.orientation==="horizontal"?(A===0&&b.range.stop(1,1)[k?"animate":"css"]({left:p+"%"},e.animate),A===1&&b.range[k?"animate":"css"]({width:p-
g+"%"},{queue:false,duration:e.animate})):(A===0&&b.range.stop(1,1)[k?"animate":"css"]({bottom:p+"%"},e.animate),A===1&&b.range[k?"animate":"css"]({height:p-g+"%"},{queue:false,duration:e.animate})));g=p}):(d=this.value(),o=this._valueMin(),u=this._valueMax(),p=u!==o?(d-o)/(u-o)*100:0,c[b.orientation==="horizontal"?"left":"bottom"]=p+"%",this.handle.stop(1,1)[k?"animate":"css"](c,e.animate),n==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[k?"animate":"css"]({width:p+"%"},e.animate),
n==="max"&&this.orientation==="horizontal"&&this.range[k?"animate":"css"]({width:100-p+"%"},{queue:false,duration:e.animate}),n==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[k?"animate":"css"]({height:p+"%"},e.animate),n==="max"&&this.orientation==="vertical"&&this.range[k?"animate":"css"]({height:100-p+"%"},{queue:false,duration:e.animate}))}});a.extend(a.ui.slider,{version:"1.8.17"})})(jQuery);(function(a){Math.precision=function(c,g){if(g===undefined)g=0;return Math.round(c*Math.pow(10,g))/Math.pow(10,g)};var n=function(c,g){var d=this,o=c.find("img:first"),u=0,A=100,q=100,M=0,Q=100,L=100,I=0,W=0,T,O,da=[],ma=function(ba){for(var ea=0;ea<da.length;ea++)da[ea].call(d,d,ba)},Z=function(ba){var ea=c.offset();T={l:ea.left|0,t:ea.top|0};clearTimeout(O);O=setTimeout(function(){ta.call(d,ba)},0);a(document).bind("mousemove",X).bind("mouseup",fa);ba.preventDefault()},X=function(ba){clearTimeout(O);
O=setTimeout(function(){ta.call(d,ba)},0);ba.stopPropagation();ba.preventDefault();return false},fa=function(ba){a(document).unbind("mouseup",fa).unbind("mousemove",X);ba.stopPropagation();ba.preventDefault();return false},ta=function(ba){var ea=ba.pageX-T.l;ba=ba.pageY-T.t;var qa=c.w,oa=c.h;if(ea<0)ea=0;else if(ea>qa)ea=qa;if(ba<0)ba=0;else if(ba>oa)ba=oa;ia.call(d,"xy",{x:ea/qa*q+u,y:ba/oa*L+M})},ia=function(ba,ea,qa){if(ea===undefined){if(ba===undefined||ba==null)ba="xy";switch(ba.toLowerCase()){case "x":return I;
case "y":return W;default:return{x:I,y:W}}}if(!(qa!=null&&qa==d)){var oa=false,na,pa;if(ba==null)ba="xy";switch(ba.toLowerCase()){case "x":na=ea&&(ea.x&&ea.x|0||ea|0)||0;break;case "y":pa=ea&&(ea.y&&ea.y|0||ea|0)||0;break;default:na=ea&&ea.x&&ea.x|0||0;pa=ea&&ea.y&&ea.y|0||0}if(na!=null){if(na<u)na=u;else if(na>A)na=A;if(I!=na){I=na;oa=true}}if(pa!=null){if(pa<M)pa=M;else if(pa>Q)pa=Q;if(W!=pa){W=pa;oa=true}}oa&&ma.call(d,qa||d)}},la=function(ba){a.isFunction(ba)&&da.push(ba)};a.extend(true,d,{val:ia,
range:function(ba,ea){if(ea===undefined){if(ba===undefined||ba==null)ba="all";switch(ba.toLowerCase()){case "minx":return u;case "maxx":return A;case "rangex":return{minX:u,maxX:A,rangeX:q};case "miny":return M;case "maxy":return Q;case "rangey":return{minY:M,maxY:Q,rangeY:L};default:return{minX:u,maxX:A,rangeX:q,minY:M,maxY:Q,rangeY:L}}}var qa,oa,na,pa;if(ba==null)ba="all";switch(ba.toLowerCase()){case "minx":qa=ea&&(ea.minX&&ea.minX|0||ea|0)||0;break;case "maxx":oa=ea&&(ea.maxX&&ea.maxX|0||ea|0)||
0;break;case "rangex":qa=ea&&ea.minX&&ea.minX|0||0;oa=ea&&ea.maxX&&ea.maxX|0||0;break;case "miny":na=ea&&(ea.minY&&ea.minY|0||ea|0)||0;break;case "maxy":pa=ea&&(ea.maxY&&ea.maxY|0||ea|0)||0;break;case "rangey":na=ea&&ea.minY&&ea.minY|0||0;pa=ea&&ea.maxY&&ea.maxY|0||0;break;default:qa=ea&&ea.minX&&ea.minX|0||0;oa=ea&&ea.maxX&&ea.maxX|0||0;na=ea&&ea.minY&&ea.minY|0||0;pa=ea&&ea.maxY&&ea.maxY|0||0}if(qa!=null&&u!=qa){u=qa;q=A-u}if(oa!=null&&A!=oa){A=oa;q=A-u}if(na!=null&&M!=na){M=na;L=Q-M}if(pa!=null&&
Q!=pa){Q=pa;L=Q-M}},bind:la,unbind:function(ba){if(a.isFunction(ba))for(var ea;(ea=a.inArray(ba,da))!=-1;)da.splice(ea,1)},destroy:function(){a(document).unbind("mouseup",fa).unbind("mousemove",X);c.unbind("mousedown",Z);da=o=c=null}});o.src=g.arrow&&g.arrow.image;o.w=g.arrow&&g.arrow.width||o.width();o.h=g.arrow&&g.arrow.height||o.height();c.w=g.map&&g.map.width||c.width();c.h=g.map&&g.map.height||c.height();c.bind("mousedown",Z);la.call(d,function(){var ba=0,ea=0,qa=c.w,oa=c.h,na=o.w,pa=o.h;setTimeout(function(){if(q>
0)ba=I==A?qa:I/q*qa|0;if(L>0)ea=W==Q?oa:W/L*oa|0;if(na>=qa)ba=(qa>>1)-(na>>1);else ba-=na>>1;if(pa>=oa)ea=(oa>>1)-(pa>>1);else ea-=pa>>1;o.css({left:ba+"px",top:ea+"px"})},0)})},e=function(c,g,d,o){var u=this;c=c.find("td.Text input");var A=c.eq(3),q=c.eq(4),M=c.eq(5),Q=c.length>7?c.eq(6):null,L=c.eq(0),I=c.eq(1),W=c.eq(2),T=c.eq(c.length>7?7:6),O=c.length>7?c.eq(8):null,da=function(ia){if(!(ia.target.value==""&&ia.target!=T.get(0)&&(d!=null&&ia.target!=d.get(0)||d==null))){if(!X(ia))return ia;switch(ia.target){case A.get(0):switch(ia.keyCode){case 38:A.val(fa.call(u,
(A.val()<<0)+1,0,255));g.val("r",A.val(),ia.target);return false;case 40:A.val(fa.call(u,(A.val()<<0)-1,0,255));g.val("r",A.val(),ia.target);return false}break;case q.get(0):switch(ia.keyCode){case 38:q.val(fa.call(u,(q.val()<<0)+1,0,255));g.val("g",q.val(),ia.target);return false;case 40:q.val(fa.call(u,(q.val()<<0)-1,0,255));g.val("g",q.val(),ia.target);return false}break;case M.get(0):switch(ia.keyCode){case 38:M.val(fa.call(u,(M.val()<<0)+1,0,255));g.val("b",M.val(),ia.target);return false;case 40:M.val(fa.call(u,
(M.val()<<0)-1,0,255));g.val("b",M.val(),ia.target);return false}break;case Q&&Q.get(0):switch(ia.keyCode){case 38:Q.val(fa.call(u,parseFloat(Q.val())+1,0,100));g.val("a",Math.precision(Q.val()*255/100,o),ia.target);return false;case 40:Q.val(fa.call(u,parseFloat(Q.val())-1,0,100));g.val("a",Math.precision(Q.val()*255/100,o),ia.target);return false}break;case L.get(0):switch(ia.keyCode){case 38:L.val(fa.call(u,(L.val()<<0)+1,0,360));g.val("h",L.val(),ia.target);return false;case 40:L.val(fa.call(u,
(L.val()<<0)-1,0,360));g.val("h",L.val(),ia.target);return false}break;case I.get(0):switch(ia.keyCode){case 38:I.val(fa.call(u,(I.val()<<0)+1,0,100));g.val("s",I.val(),ia.target);return false;case 40:I.val(fa.call(u,(I.val()<<0)-1,0,100));g.val("s",I.val(),ia.target);return false}break;case W.get(0):switch(ia.keyCode){case 38:W.val(fa.call(u,(W.val()<<0)+1,0,100));g.val("v",W.val(),ia.target);return false;case 40:W.val(fa.call(u,(W.val()<<0)-1,0,100));g.val("v",W.val(),ia.target);return false}}}},
ma=function(ia){if(!(ia.target.value==""&&ia.target!=T.get(0)&&(d!=null&&ia.target!=d.get(0)||d==null))){if(!X(ia))return ia;switch(ia.target){case A.get(0):A.val(fa.call(u,A.val(),0,255));g.val("r",A.val(),ia.target);break;case q.get(0):q.val(fa.call(u,q.val(),0,255));g.val("g",q.val(),ia.target);break;case M.get(0):M.val(fa.call(u,M.val(),0,255));g.val("b",M.val(),ia.target);break;case Q&&Q.get(0):Q.val(fa.call(u,Q.val(),0,100));g.val("a",Math.precision(Q.val()*255/100,o),ia.target);break;case L.get(0):L.val(fa.call(u,
L.val(),0,360));g.val("h",L.val(),ia.target);break;case I.get(0):I.val(fa.call(u,I.val(),0,100));g.val("s",I.val(),ia.target);break;case W.get(0):W.val(fa.call(u,W.val(),0,100));g.val("v",W.val(),ia.target);break;case T.get(0):T.val(T.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));d&&d.val(T.val());g.val("hex",T.val()!=""?T.val():null,ia.target);break;case d&&d.get(0):d.val(d.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));T.val(d.val());g.val("hex",d.val()!=""?d.val():
null,ia.target);break;case O&&O.get(0):O.val(O.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2));g.val("a",O.val()!=null?parseInt(O.val(),16):null,ia.target)}}},Z=function(ia){if(g.val()!=null)switch(ia.target){case A.get(0):A.val(g.val("r"));break;case q.get(0):q.val(g.val("g"));break;case M.get(0):M.val(g.val("b"));break;case Q&&Q.get(0):Q.val(Math.precision(g.val("a")*100/255,o));break;case L.get(0):L.val(g.val("h"));break;case I.get(0):I.val(g.val("s"));break;case W.get(0):W.val(g.val("v"));
break;case T.get(0):case d&&d.get(0):T.val(g.val("hex"));d&&d.val(g.val("hex"));break;case O&&O.get(0):O.val(g.val("ahex").substring(6))}},X=function(ia){switch(ia.keyCode){case 9:case 16:case 29:case 37:case 39:return false;case "c".charCodeAt():case "v".charCodeAt():if(ia.ctrlKey)return false}return true},fa=function(ia,la,ba){if(ia==""||isNaN(ia))return la;if(ia>ba)return ba;if(ia<la)return la;return ia},ta=function(ia,la){var ba=ia.val("all");if(la!=A.get(0))A.val(ba!=null?ba.r:"");if(la!=q.get(0))q.val(ba!=
null?ba.g:"");if(la!=M.get(0))M.val(ba!=null?ba.b:"");if(Q&&la!=Q.get(0))Q.val(ba!=null?Math.precision(ba.a*100/255,o):"");if(la!=L.get(0))L.val(ba!=null?ba.h:"");if(la!=I.get(0))I.val(ba!=null?ba.s:"");if(la!=W.get(0))W.val(ba!=null?ba.v:"");if(la!=T.get(0)&&(d&&la!=d.get(0)||!d))T.val(ba!=null?ba.hex:"");if(d&&la!=d.get(0)&&la!=T.get(0))d.val(ba!=null?ba.hex:"");if(O&&la!=O.get(0))O.val(ba!=null?ba.ahex.substring(6):"")};a.extend(true,u,{destroy:function(){A.add(q).add(M).add(Q).add(L).add(I).add(W).add(T).add(d).add(O).unbind("keyup",
ma).unbind("blur",Z);A.add(q).add(M).add(Q).add(L).add(I).add(W).unbind("keydown",da);g.unbind(ta);O=T=W=I=L=Q=M=q=A=null}});A.add(q).add(M).add(Q).add(L).add(I).add(W).add(T).add(d).add(O).bind("keyup",ma).bind("blur",Z);A.add(q).add(M).add(Q).add(L).add(I).add(W).bind("keydown",da);g.bind(ta)};a.jPicker={List:[],Color:function(c){var g=this,d,o,u,A,q,M,Q,L=[],I=function(T){for(var O=0;O<L.length;O++)L[O].call(g,g,T)},W=function(T,O,da){if(O===undefined){if(T===undefined||T==null||T=="")T="all";
if(d==null)return null;switch(T.toLowerCase()){case "ahex":return p.rgbaToHex({r:d,g:o,b:u,a:A});case "hex":return W("ahex").substring(0,6);case "all":return{r:d,g:o,b:u,a:A,h:q,s:M,v:Q,hex:W.call(g,"hex"),ahex:W.call(g,"ahex")};default:O={};for(var ma=0;ma<T.length;ma++)switch(T.charAt(ma)){case "r":if(T.length==1)O=d;else O.r=d;break;case "g":if(T.length==1)O=o;else O.g=o;break;case "b":if(T.length==1)O=u;else O.b=u;break;case "a":if(T.length==1)O=A;else O.a=A;break;case "h":if(T.length==1)O=q;
else O.h=q;break;case "s":if(T.length==1)O=M;else O.s=M;break;case "v":if(T.length==1)O=Q;else O.v=Q}return O=={}?W.call(g,"all"):O}}if(!(da!=null&&da==g)){var Z=false;if(T==null)T="";if(O==null){if(d!=null){d=null;Z=true}if(o!=null){o=null;Z=true}if(u!=null){u=null;Z=true}if(A!=null){A=null;Z=true}if(q!=null){q=null;Z=true}if(M!=null){M=null;Z=true}if(Q!=null){Q=null;Z=true}Z&&I.call(g,da||g)}else switch(T.toLowerCase()){case "ahex":case "hex":O=p.hexToRgba(O&&(O.ahex||O.hex)||O||"00000000");W.call(g,
"rgba",{r:O.r,g:O.g,b:O.b,a:T=="ahex"?O.a:A!=null?A:255},da);break;default:if(O&&(O.ahex!=null||O.hex!=null)){W.call(g,"ahex",O.ahex||O.hex||"00000000",da);break}var X={},fa=false,ta=false;if(O.r!==undefined&&!T.indexOf("r")==-1)T+="r";if(O.g!==undefined&&!T.indexOf("g")==-1)T+="g";if(O.b!==undefined&&!T.indexOf("b")==-1)T+="b";if(O.a!==undefined&&!T.indexOf("a")==-1)T+="a";if(O.h!==undefined&&!T.indexOf("h")==-1)T+="h";if(O.s!==undefined&&!T.indexOf("s")==-1)T+="s";if(O.v!==undefined&&!T.indexOf("v")==
-1)T+="v";for(ma=0;ma<T.length;ma++)switch(T.charAt(ma)){case "r":if(ta)continue;fa=true;X.r=O&&O.r&&O.r|0||O&&O|0||0;if(X.r<0)X.r=0;else if(X.r>255)X.r=255;if(d!=X.r){d=X.r;Z=true}break;case "g":if(ta)continue;fa=true;X.g=O&&O.g&&O.g|0||O&&O|0||0;if(X.g<0)X.g=0;else if(X.g>255)X.g=255;if(o!=X.g){o=X.g;Z=true}break;case "b":if(ta)continue;fa=true;X.b=O&&O.b&&O.b|0||O&&O|0||0;if(X.b<0)X.b=0;else if(X.b>255)X.b=255;if(u!=X.b){u=X.b;Z=true}break;case "a":X.a=O&&O.a!=null?O.a|0:O!=null?O|0:255;if(X.a<
0)X.a=0;else if(X.a>255)X.a=255;if(A!=X.a){A=X.a;Z=true}break;case "h":if(fa)continue;ta=true;X.h=O&&O.h&&O.h|0||O&&O|0||0;if(X.h<0)X.h=0;else if(X.h>360)X.h=360;if(q!=X.h){q=X.h;Z=true}break;case "s":if(fa)continue;ta=true;X.s=O&&O.s!=null?O.s|0:O!=null?O|0:100;if(X.s<0)X.s=0;else if(X.s>100)X.s=100;if(M!=X.s){M=X.s;Z=true}break;case "v":if(fa)continue;ta=true;X.v=O&&O.v!=null?O.v|0:O!=null?O|0:100;if(X.v<0)X.v=0;else if(X.v>100)X.v=100;if(Q!=X.v){Q=X.v;Z=true}}if(Z){if(fa){d=d||0;o=o||0;u=u||0;
O=p.rgbToHsv({r:d,g:o,b:u});q=O.h;M=O.s;Q=O.v}else if(ta){q=q||0;M=M!=null?M:100;Q=Q!=null?Q:100;O=p.hsvToRgb({h:q,s:M,v:Q});d=O.r;o=O.g;u=O.b}A=A!=null?A:255;I.call(g,da||g)}}}};a.extend(true,g,{val:W,bind:function(T){a.isFunction(T)&&L.push(T)},unbind:function(T){if(a.isFunction(T))for(var O;(O=a.inArray(T,L))!=-1;)L.splice(O,1)},destroy:function(){L=null}});if(c)if(c.ahex!=null)W("ahex",c);else if(c.hex!=null)W((c.a!=null?"a":"")+"hex",c.a!=null?{ahex:c.hex+p.intToHex(c.a)}:c);else if(c.r!=null&&
c.g!=null&&c.b!=null)W("rgb"+(c.a!=null?"a":""),c);else if(c.h!=null&&c.s!=null&&c.v!=null)W("hsv"+(c.a!=null?"a":""),c)},ColorMethods:{hexToRgba:function(c){c=this.validateHex(c);if(c=="")return{r:null,g:null,b:null,a:null};var g="00",d="00",o="00",u="255";if(c.length==6)c+="ff";if(c.length>6){g=c.substring(0,2);d=c.substring(2,4);o=c.substring(4,6);u=c.substring(6,c.length)}else{if(c.length>4){g=c.substring(4,c.length);c=c.substring(0,4)}if(c.length>2){d=c.substring(2,c.length);c=c.substring(0,
2)}if(c.length>0)o=c.substring(0,c.length)}return{r:this.hexToInt(g),g:this.hexToInt(d),b:this.hexToInt(o),a:this.hexToInt(u)}},validateHex:function(c){if(typeof c=="object")return"";c=c.toLowerCase().replace(/[^a-f0-9]/g,"");if(c.length>8)c=c.substring(0,8);return c},rgbaToHex:function(c){return this.intToHex(c.r)+this.intToHex(c.g)+this.intToHex(c.b)+this.intToHex(c.a)},intToHex:function(c){c=(c|0).toString(16);if(c.length==1)c="0"+c;return c.toLowerCase()},hexToInt:function(c){return parseInt(c,
16)},rgbToHsv:function(c){var g=c.r/255,d=c.g/255;c=c.b/255;var o={h:0,s:0,v:0},u=0,A=0;if(g>=d&&g>=c){A=g;u=d>c?c:d}else if(d>=c&&d>=g){A=d;u=g>c?c:g}else{A=c;u=d>g?g:d}o.v=A;o.s=A?(A-u)/A:0;if(o.s){u=A-u;o.h=g==A?(d-c)/u:d==A?2+(c-g)/u:4+(g-d)/u;o.h=parseInt(o.h*60);if(o.h<0)o.h+=360}else o.h=0;o.s=o.s*100|0;o.v=o.v*100|0;return o},hsvToRgb:function(c){var g={r:0,g:0,b:0,a:100},d=c.h,o=c.s;c=c.v;if(o==0)g.r=c==0?g.g=g.b=0:g.g=g.b=c*255/100|0;else{if(d==360)d=0;d/=60;o/=100;c/=100;var u=d|0,A=d-
u;d=c*(1-o);var q=c*(1-o*A);o=c*(1-o*(1-A));switch(u){case 0:g.r=c;g.g=o;g.b=d;break;case 1:g.r=q;g.g=c;g.b=d;break;case 2:g.r=d;g.g=c;g.b=o;break;case 3:g.r=d;g.g=q;g.b=c;break;case 4:g.r=o;g.g=d;g.b=c;break;case 5:g.r=c;g.g=d;g.b=q}g.r=g.r*255|0;g.g=g.g*255|0;g.b=g.b*255|0}return g}}};var b=a.jPicker.Color,k=a.jPicker.List,p=a.jPicker.ColorMethods;a.fn.jPicker=function(c){var g=arguments;return this.each(function(){var d=this,o=a.extend(true,{},a.fn.jPicker.defaults,c);if(a(d).get(0).nodeName.toLowerCase()==
"input"){a.extend(true,o,{window:{bindToInput:true,expandable:true,input:a(d)}});if(a(d).val()==""){o.color.active=new b({hex:null});o.color.current=new b({hex:null})}else if(p.validateHex(a(d).val())){o.color.active=new b({hex:a(d).val(),a:o.color.active.val("a")});o.color.current=new b({hex:a(d).val(),a:o.color.active.val("a")})}}if(o.window.expandable)a(d).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>');
else o.window.liveUpdate=false;var u=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,A=null,q=null,M=null,Q=null,L=null,I=null,W=null,T=null,O=null,da=null,ma=null,Z=null,X=null,fa=null,ta=null,ia=null,la=null,ba=null,ea=null,qa=null,oa=null,na=null,pa=null,Ka=null,La=null,Ha=null,Sa=null,Ra=null,Fa=function(N){var R=ka.active,ca=R.val("hex"),Ca,Na;o.color.mode=N;switch(N){case "h":setTimeout(function(){Va.call(d,q,"transparent");Aa.call(d,Q,0);ua.call(d,Q,100);Aa.call(d,
L,260);ua.call(d,L,100);Va.call(d,M,"transparent");Aa.call(d,W,0);ua.call(d,W,100);Aa.call(d,T,260);ua.call(d,T,100);Aa.call(d,O,260);ua.call(d,O,100);Aa.call(d,da,260);ua.call(d,da,100);Aa.call(d,Z,260);ua.call(d,Z,100)},0);X.range("all",{minX:0,maxX:100,minY:0,maxY:100});fa.range("rangeY",{minY:0,maxY:360});if(R.val("ahex")==null)break;X.val("xy",{x:R.val("s"),y:100-R.val("v")},X);fa.val("y",360-R.val("h"),fa);break;case "s":setTimeout(function(){Va.call(d,q,"transparent");Aa.call(d,Q,-260);Aa.call(d,
L,-520);Aa.call(d,W,-260);Aa.call(d,T,-520);Aa.call(d,Z,260);ua.call(d,Z,100)},0);X.range("all",{minX:0,maxX:360,minY:0,maxY:100});fa.range("rangeY",{minY:0,maxY:100});if(R.val("ahex")==null)break;X.val("xy",{x:R.val("h"),y:100-R.val("v")},X);fa.val("y",100-R.val("s"),fa);break;case "v":setTimeout(function(){Va.call(d,q,"000000");Aa.call(d,Q,-780);Aa.call(d,L,260);Va.call(d,M,ca);Aa.call(d,W,-520);Aa.call(d,T,260);ua.call(d,T,100);Aa.call(d,Z,260);ua.call(d,Z,100)},0);X.range("all",{minX:0,maxX:360,
minY:0,maxY:100});fa.range("rangeY",{minY:0,maxY:100});if(R.val("ahex")==null)break;X.val("xy",{x:R.val("h"),y:100-R.val("s")},X);fa.val("y",100-R.val("v"),fa);break;case "r":Ca=-1040;Na=-780;X.range("all",{minX:0,maxX:255,minY:0,maxY:255});fa.range("rangeY",{minY:0,maxY:255});if(R.val("ahex")==null)break;X.val("xy",{x:R.val("b"),y:255-R.val("g")},X);fa.val("y",255-R.val("r"),fa);break;case "g":Ca=-1560;Na=-1820;X.range("all",{minX:0,maxX:255,minY:0,maxY:255});fa.range("rangeY",{minY:0,maxY:255});
if(R.val("ahex")==null)break;X.val("xy",{x:R.val("b"),y:255-R.val("r")},X);fa.val("y",255-R.val("g"),fa);break;case "b":Ca=-2080;Na=-2860;X.range("all",{minX:0,maxX:255,minY:0,maxY:255});fa.range("rangeY",{minY:0,maxY:255});if(R.val("ahex")==null)break;X.val("xy",{x:R.val("r"),y:255-R.val("g")},X);fa.val("y",255-R.val("b"),fa);break;case "a":setTimeout(function(){Va.call(d,q,"transparent");Aa.call(d,Q,-260);Aa.call(d,L,-520);Aa.call(d,W,260);Aa.call(d,T,260);ua.call(d,T,100);Aa.call(d,Z,0);ua.call(d,
Z,100)},0);X.range("all",{minX:0,maxX:360,minY:0,maxY:100});fa.range("rangeY",{minY:0,maxY:255});if(R.val("ahex")==null)break;X.val("xy",{x:R.val("h"),y:100-R.val("v")},X);fa.val("y",255-R.val("a"),fa);break;default:throw"Invalid Mode";}switch(N){case "s":case "v":case "a":setTimeout(function(){ua.call(d,Q,100);ua.call(d,W,100);Aa.call(d,O,260);ua.call(d,O,100);Aa.call(d,da,260);ua.call(d,da,100)},0);break;case "r":case "g":case "b":setTimeout(function(){Va.call(d,q,"transparent");Va.call(d,M,"transparent");
ua.call(d,W,100);ua.call(d,Q,100);Aa.call(d,Q,Ca);Aa.call(d,L,Ca-260);Aa.call(d,W,Na-780);Aa.call(d,T,Na-520);Aa.call(d,O,Na);Aa.call(d,da,Na-260);Aa.call(d,Z,260);ua.call(d,Z,100)},0)}R.val("ahex")!=null&&ya.call(d,R)},ya=function(N,R){if(R==null||R!=fa&&R!=X)ra.call(d,N,R);setTimeout(function(){ob.call(d,N);vb.call(d,N);gb.call(d,N)},0)},xa=function(N,R){var ca=ka.active;if(!(R!=X&&ca.val()==null)){var Ca=N.val("all");switch(o.color.mode){case "h":ca.val("sv",{s:Ca.x,v:100-Ca.y},R);break;case "s":case "a":ca.val("hv",
{h:Ca.x,v:100-Ca.y},R);break;case "v":ca.val("hs",{h:Ca.x,s:100-Ca.y},R);break;case "r":ca.val("gb",{g:255-Ca.y,b:Ca.x},R);break;case "g":ca.val("rb",{r:255-Ca.y,b:Ca.x},R);break;case "b":ca.val("rg",{r:Ca.x,g:255-Ca.y},R)}}},Da=function(N,R){var ca=ka.active;if(!(R!=fa&&ca.val()==null))switch(o.color.mode){case "h":ca.val("h",{h:360-N.val("y")},R);break;case "s":ca.val("s",{s:100-N.val("y")},R);break;case "v":ca.val("v",{v:100-N.val("y")},R);break;case "r":ca.val("r",{r:255-N.val("y")},R);break;
case "g":ca.val("g",{g:255-N.val("y")},R);break;case "b":ca.val("b",{b:255-N.val("y")},R);break;case "a":ca.val("a",255-N.val("y"),R)}},ra=function(N,R){if(R!=X)switch(o.color.mode){case "h":var ca=N.val("sv");X.val("xy",{x:ca!=null?ca.s:100,y:100-(ca!=null?ca.v:100)},R);break;case "s":case "a":ca=N.val("hv");X.val("xy",{x:ca&&ca.h||0,y:100-(ca!=null?ca.v:100)},R);break;case "v":ca=N.val("hs");X.val("xy",{x:ca&&ca.h||0,y:100-(ca!=null?ca.s:100)},R);break;case "r":ca=N.val("bg");X.val("xy",{x:ca&&
ca.b||0,y:255-(ca&&ca.g||0)},R);break;case "g":ca=N.val("br");X.val("xy",{x:ca&&ca.b||0,y:255-(ca&&ca.r||0)},R);break;case "b":ca=N.val("rg");X.val("xy",{x:ca&&ca.r||0,y:255-(ca&&ca.g||0)},R)}if(R!=fa)switch(o.color.mode){case "h":fa.val("y",360-(N.val("h")||0),R);break;case "s":ca=N.val("s");fa.val("y",100-(ca!=null?ca:100),R);break;case "v":ca=N.val("v");fa.val("y",100-(ca!=null?ca:100),R);break;case "r":fa.val("y",255-(N.val("r")||0),R);break;case "g":fa.val("y",255-(N.val("g")||0),R);break;case "b":fa.val("y",
255-(N.val("b")||0),R);break;case "a":ca=N.val("a");fa.val("y",255-(ca!=null?ca:255),R)}},ob=function(N){try{var R=N.val("all");qa.css({backgroundColor:R&&"#"+R.hex||"transparent"});ua.call(d,qa,R&&Math.precision(R.a*100/255,4)||0)}catch(ca){}},vb=function(N){switch(o.color.mode){case "h":Va.call(d,q,(new b({h:N.val("h")||0,s:100,v:100})).val("hex"));break;case "s":case "a":var R=N.val("s");ua.call(d,L,100-(R!=null?R:100));break;case "v":R=N.val("v");ua.call(d,Q,R!=null?R:100);break;case "r":ua.call(d,
L,Math.precision((N.val("r")||0)/255*100,4));break;case "g":ua.call(d,L,Math.precision((N.val("g")||0)/255*100,4));break;case "b":ua.call(d,L,Math.precision((N.val("b")||0)/255*100))}N=N.val("a");ua.call(d,I,Math.precision((255-(N||0))*100/255,4))},gb=function(N){switch(o.color.mode){case "h":var R=N.val("a");ua.call(d,ma,Math.precision((255-(R||0))*100/255,4));break;case "s":R=N.val("hva");var ca=new b({h:R&&R.h||0,s:100,v:R!=null?R.v:100});Va.call(d,M,ca.val("hex"));ua.call(d,T,100-(R!=null?R.v:
100));ua.call(d,ma,Math.precision((255-(R&&R.a||0))*100/255,4));break;case "v":R=N.val("hsa");ca=new b({h:R&&R.h||0,s:R!=null?R.s:100,v:100});Va.call(d,M,ca.val("hex"));ua.call(d,ma,Math.precision((255-(R&&R.a||0))*100/255,4));break;case "r":case "g":case "b":ca=R=0;N=N.val("rgba");if(o.color.mode=="r"){R=N&&N.b||0;ca=N&&N.g||0}else if(o.color.mode=="g"){R=N&&N.b||0;ca=N&&N.r||0}else if(o.color.mode=="b"){R=N&&N.r||0;ca=N&&N.g||0}var Ca=ca>R?R:ca;ua.call(d,T,R>ca?Math.precision((R-ca)/(255-ca)*100,
4):0);ua.call(d,O,ca>R?Math.precision((ca-R)/(255-R)*100,4):0);ua.call(d,da,Math.precision(Ca/255*100,4));ua.call(d,ma,Math.precision((255-(N&&N.a||0))*100/255,4));break;case "a":R=N.val("a");Va.call(d,M,N.val("hex")||"000000");ua.call(d,ma,R!=null?0:100);ua.call(d,Z,R!=null?100:0)}},Va=function(N,R){N.css({backgroundColor:R&&R.length==6&&"#"+R||"transparent"})},Ya=function(N,R){if(u&&(R.indexOf("AlphaBar.png")!=-1||R.indexOf("Bars.png")!=-1||R.indexOf("Maps.png")!=-1)){N.attr("pngSrc",R);N.css({backgroundImage:"none",
filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+R+"', sizingMethod='scale')"})}else N.css({backgroundImage:"url('"+R+"')"})},Aa=function(N,R){N.css({top:R+"px"})},ua=function(N,R){N.css({visibility:R>0?"visible":"hidden"});if(R>0&&R<100)if(u){var ca=N.attr("pngSrc");ca!=null&&(ca.indexOf("AlphaBar.png")!=-1||ca.indexOf("Bars.png")!=-1||ca.indexOf("Maps.png")!=-1)?N.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ca+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+
R+")"}):N.css({opacity:Math.precision(R/100,4)})}else N.css({opacity:Math.precision(R/100,4)});else if(R==0||R==100)if(u){ca=N.attr("pngSrc");ca!=null&&(ca.indexOf("AlphaBar.png")!=-1||ca.indexOf("Bars.png")!=-1||ca.indexOf("Maps.png")!=-1)?N.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ca+"', sizingMethod='scale')"}):N.css({opacity:""})}else N.css({opacity:""})},db=function(){ka.active.val("ahex",ka.current.val("ahex"))},Ia=function(){ka.current.val("ahex",ka.active.val("ahex"))},
Ua=function(N){a(this).parents("tbody:first").find('input:radio[value!="'+N.target.value+'"]').removeAttr("checked");Fa.call(d,N.target.value)},Ba=function(){db.call(d)},hb=function(){db.call(d);o.window.expandable&&yb.call(d);a.isFunction(sb)&&sb.call(d,ka.active,pa)},rb=function(){Ia.call(d);o.window.expandable&&yb.call(d);a.isFunction(mb)&&mb.call(d,ka.active,na)},Xa=function(){tb.call(d)},$a=function(N){var R=N.val("hex");oa.css({backgroundColor:R&&"#"+R||"transparent"});ua.call(d,oa,Math.precision((N.val("a")||
0)*100/255,4))},wb=function(N){var R=N.val("hex");N=N.val("va");La.css({backgroundColor:R&&"#"+R||"transparent"});ua.call(d,Ha,Math.precision((255-(N&&N.a||0))*100/255,4));if(o.window.bindToInput&&o.window.updateInputColor)o.window.input.css({backgroundColor:R&&"#"+R||"transparent",color:N==null||N.v>75?"#000000":"#ffffff"})},sa=function(N){ia=parseInt(A.css("left"));la=parseInt(A.css("top"));ba=N.pageX;ea=N.pageY;a(document).bind("mousemove",kb).bind("mouseup",fb);N.preventDefault()},kb=function(N){A.css({left:ia-
(ba-N.pageX)+"px",top:la-(ea-N.pageY)+"px"});o.window.expandable&&!a.support.boxModel&&A.prev().css({left:A.css("left"),top:A.css("top")});N.stopPropagation();N.preventDefault();return false},fb=function(N){a(document).unbind("mousemove",kb).unbind("mouseup",fb);N.stopPropagation();N.preventDefault();return false},xb=function(N){N.preventDefault();N.stopPropagation();ka.active.val("ahex",a(this).attr("title")||null,N.target);return false},mb=a.isFunction(g[1])&&g[1]||null,ab=a.isFunction(g[2])&&g[2]||
null,sb=a.isFunction(g[3])&&g[3]||null,tb=function(){ka.current.val("ahex",ka.active.val("ahex"));var N=function(){if(!(!o.window.expandable||a.support.boxModel)){var R=A.find("table:first");A.before("<iframe/>");A.prev().css({width:R.width(),height:A.height(),opacity:0,position:"absolute",left:A.css("left"),top:A.css("top")})}};if(o.window.expandable){a(document.body).children("div.jPicker.Container").css({zIndex:10});A.css({zIndex:20})}switch(o.window.effects.type){case "fade":A.fadeIn(o.window.effects.speed.show,
N);break;case "slide":A.slideDown(o.window.effects.speed.show,N);break;default:A.show(o.window.effects.speed.show,N)}},yb=function(){var N=function(){o.window.expandable&&A.css({zIndex:10});!o.window.expandable||a.support.boxModel||A.prev().remove()};switch(o.window.effects.type){case "fade":A.fadeOut(o.window.effects.speed.hide,N);break;case "slide":A.slideUp(o.window.effects.speed.hide,N);break;default:A.hide(o.window.effects.speed.hide,N)}},ib=function(){var N=o.window,R=N.expandable?a(d).next().find(".Container:first"):
null;A=N.expandable?a("<div/>"):a(d);A.addClass("jPicker Container");N.expandable&&A.hide();A.get(0).onselectstart=function(Pa){if(Pa.target.nodeName.toLowerCase()!=="input")return false};var ca=ka.active.val("all");if(N.alphaPrecision<0)N.alphaPrecision=0;else if(N.alphaPrecision>2)N.alphaPrecision=2;var Ca='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(N.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(N.title||aa.text.title)+
'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+ja.clientPath+ja.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+ja.clientPath+ja.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview"><div class="prev_div">'+
aa.text.newColor+'<div class="color_preview"><span class="Active" title="'+aa.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+aa.tooltips.colors.currentColor+'">&nbsp;</span></div></div>'+aa.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+aa.text.ok+'" title="'+aa.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+aa.text.cancel+'" title="'+aa.tooltips.buttons.cancel+'"/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+
aa.tooltips.hue.radio+'"><input type="radio" value="h"'+(o.color.mode=="h"?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.h:"")+'" title="'+aa.tooltips.hue.textbox+'"/>&nbsp;\u00ba</td></tr><tr class="Saturation"><td class="Radio"><label title="'+aa.tooltips.saturation.radio+'"><input type="radio" value="s"'+(o.color.mode=="s"?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=
null?ca.s:"")+'" title="'+aa.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+aa.tooltips.value.radio+'"><input type="radio" value="v"'+(o.color.mode=="v"?' checked="checked"':"")+'/>V:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.v:"")+'" title="'+aa.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+aa.tooltips.red.radio+'"><input type="radio" value="r"'+
(o.color.mode=="r"?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.r:"")+'" title="'+aa.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+aa.tooltips.green.radio+'"><input type="radio" value="g"'+(o.color.mode=="g"?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.g:"")+'" title="'+aa.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+
aa.tooltips.blue.radio+'"><input type="radio" value="b"'+(o.color.mode=="b"?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.b:"")+'" title="'+aa.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(N.alphaSupport?'<label title="'+aa.tooltips.alpha.radio+'"><input type="radio" value="a"'+(o.color.mode=="a"?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(N.alphaSupport?'<input type="text" maxlength="'+
(3+N.alphaPrecision)+'" value="'+(ca!=null?Math.precision(ca.a*100/255,N.alphaPrecision):"")+'" title="'+aa.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+aa.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(ca!=null?ca.hex:"")+'"/></label>'+(N.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(ca!=null?ca.ahex.substring(6):"")+'" title="'+aa.tooltips.hex.alpha+'"/></td>':"&nbsp;")+
"</tr></tbody></table>";if(N.expandable){A.html(Ca);a(document.body).children("div.jPicker.Container").length==0?a(document.body).prepend(A):a(document.body).children("div.jPicker.Container:last").after(A);A.mousedown(function(){a(document.body).children("div.jPicker.Container").css({zIndex:10});A.css({zIndex:20})});A.css({left:N.position.x=="left"?R.offset().left-530-(N.position.y=="center"?25:0)+"px":N.position.x=="center"?R.offset().left-260+"px":N.position.x=="right"?R.offset().left-10+(N.position.y==
"center"?25:0)+"px":N.position.x=="screenCenter"?(a(document).width()>>1)-260+"px":R.offset().left+parseInt(N.position.x)+"px",position:"absolute",top:N.position.y=="top"?R.offset().top-312+"px":N.position.y=="center"?R.offset().top-156+"px":N.position.y=="bottom"?R.offset().top+25+"px":R.offset().top+parseInt(N.position.y)+"px"})}else{A=a(d);A.html(Ca)}Ca=A.find("tbody:first");q=Ca.find("div.Map:first");M=Ca.find("div.Bar:first");var Na=q.find("span"),Za=M.find("span");Q=Na.filter(".Map1:first");
L=Na.filter(".Map2:first");I=Na.filter(".Map3:first");W=Za.filter(".Map1:first");T=Za.filter(".Map2:first");O=Za.filter(".Map3:first");da=Za.filter(".Map4:first");ma=Za.filter(".Map5:first");Z=Za.filter(".Map6:first");X=new n(q,{map:{width:ja.colorMap.width,height:ja.colorMap.height},arrow:{image:ja.clientPath+ja.colorMap.arrow.file,width:ja.colorMap.arrow.width,height:ja.colorMap.arrow.height}});X.bind(xa);fa=new n(M,{map:{width:ja.colorBar.width,height:ja.colorBar.height},arrow:{image:ja.clientPath+
ja.colorBar.arrow.file,width:ja.colorBar.arrow.width,height:ja.colorBar.arrow.height}});fa.bind(Da);ta=new e(Ca,ka.active,N.expandable&&N.bindToInput?N.input:null,N.alphaPrecision);Na=ca!=null?ca.hex:null;var cb=Ca.find(".Preview");Za=Ca.find(".Button");qa=cb.find(".Active:first").css({backgroundColor:Na&&"#"+Na||"transparent"});oa=cb.find(".Current:first").css({backgroundColor:Na&&"#"+Na||"transparent"}).bind("click",Ba);ua.call(d,oa,Math.precision(ka.current.val("a")*100)/255,4);na=Za.find(".Ok:first").bind("click touchstart",
rb);pa=Za.find(".Cancel:first").bind("click touchstart",hb);Ka=Za.find(".Grid:first");setTimeout(function(){Ya.call(d,Q,ja.clientPath+"Maps.png");Ya.call(d,L,ja.clientPath+"Maps.png");Ya.call(d,I,ja.clientPath+"map-opacity.png");Ya.call(d,W,ja.clientPath+"Bars.png");Ya.call(d,T,ja.clientPath+"Bars.png");Ya.call(d,O,ja.clientPath+"Bars.png");Ya.call(d,da,ja.clientPath+"Bars.png");Ya.call(d,ma,ja.clientPath+"bar-opacity.png");Ya.call(d,Z,ja.clientPath+"AlphaBar.png");Ya.call(d,cb.find("div:last"),ja.clientPath+
"preview-opacity.png")},0);Ca.find("td.Radio input").bind("click  touchstart",Ua);if(ka.quickList&&ka.quickList.length>0){Za="";for(i=0;i<ka.quickList.length;i++){if((typeof ka.quickList[i]).toString().toLowerCase()=="string")ka.quickList[i]=new b({hex:ka.quickList[i]});var qb=ka.quickList[i].val("a"),Ta=ka.quickList[i].val("ahex");if(!N.alphaSupport&&Ta)Ta=Ta.substring(0,6)+"ff";var pb=ka.quickList[i].val("hex");Za+='<span class="QuickColor"'+(Ta&&' title="#'+Ta+'"'||"")+' style="background-color:'+
(pb&&"#"+pb||"")+";"+(pb?"":"background-image:url("+ja.clientPath+"NoColor.png)")+(N.alphaSupport&&qb&&qb<255?";opacity:"+Math.precision(qb/255,4)+";filter:Alpha(opacity="+Math.precision(qb/2.55,4)+")":"")+'">&nbsp;</span>'}Ya.call(d,Ka,ja.clientPath+"bar-opacity.png");Ka.html(Za);Ka.find(".QuickColor").click(xb)}Fa.call(d,o.color.mode);ka.active.bind(ya);a.isFunction(ab)&&ka.active.bind(ab);ka.current.bind($a);if(N.expandable){d.icon=R.parents(".Icon:first");La=d.icon.find(".Color:first").css({backgroundColor:Na&&
"#"+Na||"transparent"});Ha=d.icon.find(".Alpha:first");Ya.call(d,Ha,ja.clientPath+"bar-opacity.png");ua.call(d,Ha,Math.precision((255-(ca!=null?ca.a:0))*100/255,4));Sa=d.icon.find(".Image:first").css({backgroundImage:"url('"+ja.clientPath+ja.picker.file+"')"}).bind("click",Xa);if(N.bindToInput&&N.updateInputColor)N.input.css({backgroundColor:Na&&"#"+Na||"transparent",color:ca==null||ca.v>75?"#000000":"#ffffff"});Ra=Ca.find(".Move:first").bind("mousedown",sa);ka.active.bind(wb)}else tb.call(d)},ja=
o.images,aa=o.localization,ka={active:(typeof o.color.active).toString().toLowerCase()=="string"?new b({ahex:!o.window.alphaSupport&&o.color.active?o.color.active.substring(0,6)+"ff":o.color.active}):new b({ahex:!o.window.alphaSupport&&o.color.active.val("ahex")?o.color.active.val("ahex").substring(0,6)+"ff":o.color.active.val("ahex")}),current:(typeof o.color.active).toString().toLowerCase()=="string"?new b({ahex:!o.window.alphaSupport&&o.color.active?o.color.active.substring(0,6)+"ff":o.color.active}):
new b({ahex:!o.window.alphaSupport&&o.color.active.val("ahex")?o.color.active.val("ahex").substring(0,6)+"ff":o.color.active.val("ahex")}),quickList:o.color.quickList};a.extend(true,d,{commitCallback:mb,liveCallback:ab,cancelCallback:sb,color:ka,show:tb,hide:yb,destroy:function(){A.find("td.Radio input  touchstart").unbind("click",Ua);oa.unbind("click  touchstart",Ba);pa.unbind("click  touchstart",hb);na.unbind("click  touchstart",rb);if(o.window.expandable){Sa.unbind("click",Xa);Ra.unbind("mousedown",
sa);d.icon=null}A.find(".QuickColor").unbind("click",xb);Z=ma=da=O=T=W=I=L=Q=M=q=null;X.destroy();X=null;fa.destroy();fa=null;ta.destroy();ab=sb=mb=Ka=pa=na=oa=qa=ta=null;A.html("");for(i=0;i<k.length;i++)k[i]==d&&k.splice(i,1)}});k.push(d);setTimeout(function(){ib.call(d)},0)})};a.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:false,liveUpdate:true,alphaSupport:false,alphaPrecision:0,updateInputColor:true},
color:{mode:"h",active:new b({ahex:"#ffcc00ff"}),quickList:[new b({h:360,s:33,v:100}),new b({h:360,s:66,v:100}),new b({h:360,s:100,v:100}),new b({h:360,s:100,v:75}),new b({h:360,s:100,v:50}),new b({h:180,s:0,v:100}),new b({h:30,s:33,v:100}),new b({h:30,s:66,v:100}),new b({h:30,s:100,v:100}),new b({h:30,s:100,v:75}),new b({h:30,s:100,v:50}),new b({h:180,s:0,v:90}),new b({h:60,s:33,v:100}),new b({h:60,s:66,v:100}),new b({h:60,s:100,v:100}),new b({h:60,s:100,v:75}),new b({h:60,s:100,v:50}),new b({h:180,
s:0,v:80}),new b({h:90,s:33,v:100}),new b({h:90,s:66,v:100}),new b({h:90,s:100,v:100}),new b({h:90,s:100,v:75}),new b({h:90,s:100,v:50}),new b({h:180,s:0,v:70}),new b({h:120,s:33,v:100}),new b({h:120,s:66,v:100}),new b({h:120,s:100,v:100}),new b({h:120,s:100,v:75}),new b({h:120,s:100,v:50}),new b({h:180,s:0,v:60}),new b({h:150,s:33,v:100}),new b({h:150,s:66,v:100}),new b({h:150,s:100,v:100}),new b({h:150,s:100,v:75}),new b({h:150,s:100,v:50}),new b({h:180,s:0,v:50}),new b({h:180,s:33,v:100}),new b({h:180,
s:66,v:100}),new b({h:180,s:100,v:100}),new b({h:180,s:100,v:75}),new b({h:180,s:100,v:50}),new b({h:180,s:0,v:40}),new b({h:210,s:33,v:100}),new b({h:210,s:66,v:100}),new b({h:210,s:100,v:100}),new b({h:210,s:100,v:75}),new b({h:210,s:100,v:50}),new b({h:180,s:0,v:30}),new b({h:240,s:33,v:100}),new b({h:240,s:66,v:100}),new b({h:240,s:100,v:100}),new b({h:240,s:100,v:75}),new b({h:240,s:100,v:50}),new b({h:180,s:0,v:20}),new b({h:270,s:33,v:100}),new b({h:270,s:66,v:100}),new b({h:270,s:100,v:100}),
new b({h:270,s:100,v:75}),new b({h:270,s:100,v:50}),new b({h:180,s:0,v:10}),new b({h:300,s:33,v:100}),new b({h:300,s:66,v:100}),new b({h:300,s:100,v:100}),new b({h:300,s:100,v:75}),new b({h:300,s:100,v:50}),new b({h:180,s:0,v:0}),new b({h:330,s:33,v:100}),new b({h:330,s:66,v:100}),new b({h:330,s:100,v:100}),new b({h:330,s:100,v:75}),new b({h:330,s:100,v:50}),new b]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,
height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},
saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},
alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6");(function(a){function n(k){var p=k||window.event,c=[].slice.call(arguments,1),g=0,d=0,o=0;k=a.event.fix(p);k.type="mousewheel";if(p.wheelDelta)g=p.wheelDelta/120;if(p.detail)g=-p.detail/3;o=g;if(p.axis!==undefined&&p.axis===p.HORIZONTAL_AXIS){o=0;d=-1*g}if(p.wheelDeltaY!==undefined)o=p.wheelDeltaY/120;if(p.wheelDeltaX!==undefined)d=-1*p.wheelDeltaX/120;c.unshift(k,g,d,o);return(a.event.dispatch||a.event.handle).apply(this,c)}var e=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var b=e.length;b;)a.event.fixHooks[e[--b]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var k=e.length;k;)this.addEventListener(e[--k],n,false);else this.onmousewheel=n},teardown:function(){if(this.removeEventListener)for(var k=e.length;k;)this.removeEventListener(e[--k],n,false);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(k){return k?this.bind("mousewheel",k):this.trigger("mousewheel")},unmousewheel:function(k){return this.unbind("mousewheel",k)}})})(jQuery);methodDraw.addExtension("eyedropper",function(a){var n=methodDraw.canvas,e=svgedit.history.ChangeElementCommand,b={fillPaint:"red",fillOpacity:1,strokePaint:"black",strokeOpacity:1,strokeWidth:5,strokeDashArray:null,opacity:1,strokeLinecap:"butt",strokeLinejoin:"miter"},k=function(p,c,g){var d=null;if(p.indexOf("url(#")===0){p=(p=n.getRefElem(p))?p.cloneNode(true):$("#"+g+"_color defs *")[0];d={alpha:c};d[p.tagName]=p}else d=p.indexOf("#")===0?{alpha:c,solidColor:p.substr(1)}:{alpha:c,solidColor:"none"};
return new $.jGraduate.Paint(d)};return{name:"eyedropper",svgicons:"extensions/eyedropper-icon.xml",buttons:[{id:"tool_eyedropper",type:"mode",title:"Eye Dropper Tool",position:8,key:"I",icon:"extensions/eyedropper.png",events:{click:function(){n.setMode("eyedropper")}}}],mouseDown:function(p){var c=n.getMode(),g=p.event;g=g.target.id==="svgroot"?document.getElementById("canvas_background"):g.target;if(c=="eyedropper"&&g){b.fillPaint=g.getAttribute("fill")||"white";b.fillOpacity=g.getAttribute("fill-opacity")||
1;b.strokePaint=g.getAttribute("stroke")||"none";b.strokeOpacity=g.getAttribute("stroke-opacity")||1;b.strokeWidth=g.getAttribute("stroke-width");b.strokeDashArray=g.getAttribute("stroke-dasharray");b.strokeLinecap=g.getAttribute("stroke-linecap");b.strokeLinejoin=g.getAttribute("stroke-linejoin");b.opacity=g.getAttribute("opacity")||1;p.selectedElements=p.selectedElements.filter(Boolean);if(p.selectedElements.length){if($.inArray(p.selectedElements.nodeName,["g","use"])==-1){var d={},o=function(A,
q,M){d[q]=A.getAttribute(q);A.setAttribute(q,M)},u=new a.BatchCommand;p.selectedElements.forEach(function(A){b.fillPaint&&o(A,"fill",b.fillPaint);b.fillOpacity&&o(A,"fill-opacity",b.fillOpacity);b.strokePaint&&o(A,"stroke",b.strokePaint);b.strokeOpacity&&o(A,"stroke-opacity",b.strokeOpacity);b.strokeWidth&&o(A,"stroke-width",b.strokeWidth);b.strokeDashArray&&o(A,"stroke-dasharray",b.strokeDashArray);b.opacity&&o(A,"opacity",b.opacity);b.strokeLinecap&&o(A,"stroke-linecap",b.strokeLinecap);b.strokeLinejoin&&
o(A,"stroke-linejoin",b.strokeLinejoin);u.addSubCommand(new e(A,d));d={}});p=k(b.fillPaint,b.fillOpacity*100,"fill");c=k(b.strokePaint,b.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.update(true);methodDraw.paintBox.stroke.update(true);n.undoMgr.addCommandToHistory(u)}}else{p=k(b.fillPaint,b.fillOpacity*100,"fill");c=k(b.strokePaint,b.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.setPaint(p);methodDraw.paintBox.stroke.setPaint(c)}}}}});methodDraw.addExtension("view_grid",function(a){function n(o){g.attr("width");g.attr("height");var u=svgedit.units.getTypeMap()[methodDraw.curConfig.baseUnit],A=[0.01,0.1,1,10,100,1E3];b.getContentElem().getAttribute("x");var q=p;u=u*o;var M=100/u,Q=1;for(o=0;o<A.length;o++){var L=A[o];Q=L;if(M<=L)break}A=Q*u;q.width=A;q.height=A;u=q.getContext("2d");M=A/10;u.globalAlpha=0.2;u.strokeStyle="#000";for(o=1;o<10;o++){Q=Math.round(M*o)+0.5;u.moveTo(Q,A);u.lineTo(Q,0);u.moveTo(A,Q);u.lineTo(0,Q)}u.stroke();
u.beginPath();u.globalAlpha=0.5;u.moveTo(0.5,A);u.lineTo(0.5,0);u.moveTo(A,0.5);u.lineTo(0,0.5);u.stroke();q=q.toDataURL("image/png");d.setAttribute("width",A);d.setAttribute("height",A);d.parentNode.setAttribute("width",A);d.parentNode.setAttribute("height",A);b.setHref(d,q)}if(!document.getElementById("canvasGrid")){var e=document.getElementById("svgcanvas").ownerDocument,b=methodDraw.canvas,k=false;a=a.assignAttributes;var p=document.createElement("canvas");$(p).hide().appendTo("body");var c=e.createElementNS("http://www.w3.org/2000/svg",
"g");a(c,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"});var g=$("#canvas_background");g.after(c);c=e.createElementNS("http://www.w3.org/2000/svg","pattern");a(c,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var d=e.createElementNS("http://www.w3.org/2000/svg","image");a(d,{x:0,y:0,width:100,height:100});c.appendChild(d);$("#svgroot defs").append(c);e=e.createElementNS("http://www.w3.org/2000/svg","rect");a(e,{width:"100%",height:"100%",
x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"});$("#canvasGrid").append(e)}return{name:"view_grid",zoomChanged:function(o){k&&n(o)},buttons:[{id:"view_grid",type:"menu",after:"tool_wireframe",panel:"view_menu",title:"View Grid",events:{click:function(){if($("#view_grid").hasClass("push_button_pressed")){methodDraw.curConfig.showGrid=k=false;$("#view_grid").removeClass("push_button_pressed");$("#canvasGrid").attr("display","none")}else{methodDraw.curConfig.showGrid=
k=true;$("#view_grid").addClass("push_button_pressed");$("#canvasGrid").attr("display","inline");n(b.getZoom())}}}}]}});methodDraw.addExtension("shapes",function(){function a(){$("#shape_buttons").empty();$("#shape_buttons").append(M.buttons)}function n(L){var I=q[L];if(I){M=I;I.buttons.length||e(L,I);a()}else{$("#shape_buttons").html("Loading...");$.getJSON("extensions/shapelib/"+L+".json",function(W){M=q[L]={data:W.data,size:W.size,fill:W.fill};e(L,W);a()})}}function e(L,I){var W=M.size||300,T=M.fill||false,O=W*0.05;O=[-O,-O,W+O*2,W+O*2].join(" ");W=T?0:W/30;W=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><svg viewBox="'+
O+'"><path fill="#333" stroke="transparent" stroke-width="'+W+'" /></svg></svg>',"text/xml");W.documentElement.setAttribute("width",40);W.documentElement.setAttribute("height",40);W=$(document.importNode(W.documentElement,true));T=I.data;M.buttons=[];for(var da in T){O=T[da];var ma=W.clone();ma.find("path").attr("d",O);O=ma.wrap('<div class="tool_button">').parent().attr({id:Q+"_"+da,title:da});M.buttons.push(O[0])}}var b,k,p=methodDraw.canvas,c,g,d,o=p.getRootElem(),u={},A={basic:"Basic",object:"Objects",
symbol:"Symbols",arrow:"Arrows",flowchart:"Flowchart",nature:"Nature",game:"Cards & Chess",dialog_balloon:"Dialog balloons",music:"Music",weather:"Weather &amp; Time",ui:"User Interface",social:"Social Web"},q={basic:{data:{star_points_5:"m1,116.58409l113.82668,0l35.17332,-108.13487l35.17334,108.13487l113.82666,0l-92.08755,66.83026l35.17514,108.13487l-92.08759,-66.83208l-92.08757,66.83208l35.17515,-108.13487l-92.08758,-66.83026z",donut:"m1,150l0,0c0,-82.29042 66.70958,-149 149,-149l0,0c39.51724,0 77.41599,15.69816 105.35889,43.64108c27.94293,27.94293 43.64111,65.84165 43.64111,105.35892l0,0c0,82.29041 -66.70958,149 -149,149l0,0c-82.29041,0 -149,-66.70959 -149,-149zm74.5,0l0,0c0,41.1452 33.35481,74.5 74.5,74.5c41.14522,0 74.5,-33.3548 74.5,-74.5c0,-41.1452 -33.3548,-74.5 -74.5,-74.5l0,0c-41.14519,0 -74.5,33.35481 -74.5,74.5z",
triangle:"m1,280.375l149,-260.75l149,260.75z",right_triangle:"m1,299l0,-298l298,298z",diamond:"m1,150l149,-149l149,149l-149,149l-149,-149z",pentagon:"m1.00035,116.97758l148.99963,-108.4053l148.99998,108.4053l-56.91267,175.4042l-184.1741,0l-56.91284,-175.4042z",hexagon:"m1,149.99944l63.85715,-127.71428l170.28572,0l63.85713,127.71428l-63.85713,127.71428l-170.28572,0l-63.85715,-127.71428z",septagon1:"m0.99917,191.06511l29.51249,-127.7108l119.48833,-56.83673l119.48836,56.83673l29.51303,127.7108l-82.69087,102.41679l-132.62103,0l-82.69031,-102.41679z",
heptagon:"m1,88.28171l87.28172,-87.28171l123.43653,0l87.28172,87.28171l0,123.43654l-87.28172,87.28172l-123.43653,0l-87.28172,-87.28172l0,-123.43654z",decagon:"m1,150.00093l28.45646,-88.40318l74.49956,-54.63682l92.08794,0l74.50002,54.63682l28.45599,88.40318l-28.45599,88.40318l-74.50002,54.63681l-92.08794,0l-74.49956,-54.63681l-28.45646,-88.40318z",dodecagon:"m1,110.07421l39.92579,-69.14842l69.14842,-39.92579l79.85159,0l69.14842,39.92579l39.92578,69.14842l0,79.85159l-39.92578,69.14842l-69.14842,39.92578l-79.85159,0l-69.14842,-39.92578l-39.92579,-69.14842l0,-79.85159z",
trapezoid:"m1,299l55.875,-298l186.25001,0l55.87498,298z",dialog_balloon_1:"m0.99786,35.96579l0,0c0,-19.31077 15.28761,-34.96524 34.14583,-34.96524l15.52084,0l0,0l74.50001,0l139.68748,0c9.05606,0 17.74118,3.68382 24.14478,10.24108c6.40356,6.55726 10.00107,15.45081 10.00107,24.72416l0,87.41311l0,0l0,52.44785l0,0c0,19.31078 -15.2876,34.96524 -34.14584,34.96524l-139.68748,0l-97.32507,88.90848l22.82506,-88.90848l-15.52084,0c-18.85822,0 -34.14583,-15.65446 -34.14583,-34.96524l0,0l0,-52.44785l0,0z",heart:"m150,73c61,-175 300,0 0,225c-300,-225 -61,-400 0,-225z",
cylinder:"m299.0007,83.77844c0,18.28676 -66.70958,33.11111 -149.00002,33.11111m149.00002,-33.11111l0,0c0,18.28676 -66.70958,33.11111 -149.00002,33.11111c-82.29041,0 -148.99997,-14.82432 -148.99997,-33.11111m0,0l0,0c0,-18.28674 66.70956,-33.1111 148.99997,-33.1111c82.29044,0 149.00002,14.82436 149.00002,33.1111l0,132.44449c0,18.28674 -66.70958,33.11105 -149.00002,33.11105c-82.29041,0 -148.99997,-14.82431 -148.99997,-33.11105z",arrow_up:"m1.49805,149.64304l148.50121,-148.00241l148.50121,148.00241l-74.25061,0l0,148.71457l-148.5012,0l0,-148.71457z",
arrow_u_turn:"m1.00059,299.00055l0,-167.62497l0,0c0,-72.00411 58.37087,-130.37499 130.375,-130.37499l0,0l0,0c34.57759,0 67.73898,13.7359 92.18906,38.18595c24.45006,24.45005 38.18593,57.61144 38.18593,92.18904l0,18.625l37.24997,0l-74.49995,74.50002l-74.50002,-74.50002l37.25,0l0,-18.625c0,-30.8589 -25.0161,-55.87498 -55.87498,-55.87498l0,0l0,0c-30.85892,0 -55.875,25.01608 -55.875,55.87498l0,167.62497z",arrow_left_up:"m0.99865,224.5l74.50004,-74.5l0,37.25l111.74991,0l0,-111.75l-37.25,0l74.5,-74.5l74.5,74.5l-37.25,0l0,186.25l-186.24989,0l0,37.25l-74.50005,-74.5z",
plaque:"m-0.00197,49.94376l0,0c27.5829,0 49.94327,-22.36036 49.94327,-49.94327l199.76709,0l0,0c0,27.5829 22.36037,49.94327 49.94325,49.94327l0,199.7671l0,0c-27.58289,0 -49.94325,22.36034 -49.94325,49.94325l-199.76709,0c0,-27.58292 -22.36037,-49.94325 -49.94327,-49.94325z",page:"m249.3298,298.99744l9.9335,-39.73413l39.73413,-9.93355l-49.66763,49.66768l-248.33237,0l0,-298.00001l298.00001,0l0,248.33234",cross:"m0.99844,99.71339l98.71494,0l0,-98.71495l101.26279,0l0,98.71495l98.71495,0l0,101.2628l-98.71495,0l0,98.71494l-101.26279,0l0,-98.71494l-98.71494,0z",
divide:"m150,0.99785l0,0c25.17819,0 45.58916,20.41097 45.58916,45.58916c0,25.17821 -20.41096,45.58916 -45.58916,45.58916c-25.17822,0 -45.58916,-20.41093 -45.58916,-45.58916c0,-25.1782 20.41093,-45.58916 45.58916,-45.58916zm0,296.25203c-25.17822,0 -45.58916,-20.41095 -45.58916,-45.58917c0,-25.17819 20.41093,-45.58916 45.58916,-45.58916c25.17819,0 45.58916,20.41096 45.58916,45.58916c0,25.17822 -20.41096,45.58917 -45.58916,45.58917zm-134.06754,-193.71518l268.13507,0l0,91.17833l-268.13507,0z",minus:"m0.99887,102.39503l297.49445,0l0,95.2112l-297.49445,0z",
times:"m1.00089,73.36786l72.36697,-72.36697l76.87431,76.87368l76.87431,-76.87368l72.36765,72.36697l-76.87433,76.87431l76.87433,76.87431l-72.36765,72.36765l-76.87431,-76.87433l-76.87431,76.87433l-72.36697,-72.36765l76.87368,-76.87431l-76.87368,-76.87431z"},buttons:[]}},M=q.basic,Q="shapelib";return{svgicons:"extensions/ext-shapes.xml",buttons:[{id:"tool_shapelib",type:"mode_flyout",position:6,title:"Shape library",icon:"extensions/ext-shapes.png",events:{click:function(){p.setMode(Q)}}}],callback:function(){var L=
$('<div id="shape_buttons">');$("#tools_shapelib > *").wrapAll(L);var I=$("#tools_shapelib_show");n("basic");$("#shape_buttons").mouseup(function(T){T=$(T.target).closest("div.tool_button");if(T.length){var O=T.children().clone().attr({width:24,height:24});I.children(":not(.flyout_arrow_horiz)").remove();I.append(O).attr("data-curopt","#"+T[0].id).mouseup();p.setMode(Q);k=T[0].id.substr((Q+"_").length);b=M.data[k];$(".tools_flyout").fadeOut()}});L=$('<div id="shape_cats">');var W="";$.each(A,function(T,
O){W+="<div data-cat="+T+">"+O+"</div>"});L.html(W).children().bind("mouseup",function(){var T=$(this);T.siblings().removeClass("current");T.addClass("current");n(T.attr("data-cat"));return false});L.children().eq(0).addClass("current");$("#tools_shapelib").prepend(L);I.mouseup(function(){p.setMode(b?Q:"select")});$("#tool_shapelib").remove();L=$("#tools_shapelib").height();$("#tools_shapelib").css({"margin-top":-(L/2),"margin-left":3})},mouseDown:function(L){if(p.getMode()===Q){var I=g=L.start_x;
L=d=L.start_y;var W=p.getStyle();c=p.addSvgElementFromJson({element:"path",curStyles:true,attr:{d:b,id:p.getNextId(),opacity:W.opacity/2,style:"pointer-events:none"}});c.setAttribute("d",b);if(/[a-z]/.test(b)){b=M.data[k]=p.pathActions.convertPath(c);c.setAttribute("d",b);p.pathActions.fixEnd(c)}c.setAttribute("transform","translate("+I+","+L+") scale(0.005) translate("+-I+","+-L+")");p.recalculateDimensions(c);p.getTransformList(c);u=c.getBBox();totalScale={sx:1,sy:1};return{started:true}}},mouseMove:function(L){if(p.getMode()===
Q){var I=p.getZoom(),W=L.event,T=L.mouse_x/I,O=L.mouse_y/I;L=p.getTransformList(c);var da=c.getBBox();I=da.x;var ma=da.y,Z=da.width,X=da.height,fa=T-g,ta=O-d,ia={x:Math.min(g,T),y:Math.min(d,O),width:Math.abs(T-g),height:Math.abs(O-d)},la=da=0;X=X?(X+ta)/X:1;Z=Z?(Z+fa)/Z:1;Z=ia.width/u.width;X=ia.height/u.height;Z=Z||1;X=X||1;if(T<g)da=u.width;if(O<d)la=u.height;T=o.createSVGTransform();O=o.createSVGTransform();ia=o.createSVGTransform();T.setTranslate(-(I+da),-(ma+la));if(W.shiftKey){replaced=true;
W=Math.min(Math.abs(Z),Math.abs(X));Z=W*(Z<0?-1:1);X=W*(X<0?-1:1);if(totalScale.sx!=totalScale.sy){W=totalScale.sx>totalScale.sy?1:totalScale.sx/totalScale.sy;Z*=totalScale.sy>totalScale.sx?1:totalScale.sy/totalScale.sx;X*=W}}totalScale.sx*=Z;totalScale.sy*=X;O.setScale(Z,X);ia.setTranslate(I+da,ma+la);L.appendItem(ia);L.appendItem(O);L.appendItem(T);p.recalculateDimensions(c);u=c.getBBox()}},mouseUp:function(L){if(p.getMode()===Q){if(L.mouse_x==g&&L.mouse_y==d)return{keep:false,element:c,started:false};
p.setMode("select");return{keep:true,element:c,started:false}}}}});(function(){for(var a=0,n=["ms","moz","webkit","o"],e=0;e<n.length&&!window.requestAnimationFrame;++e){window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(b){var k=(new Date).getTime(),p=Math.max(0,16-(k-a)),c=window.setTimeout(function(){b(k+p)},p);a=k+p;return c};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(b){clearTimeout(b)}})();(function(a){function n(q){var M=q.originalEvent;if(!M.touches||M.targetTouches.length===1&&M.touches.length===1){c.call(this,q);q=a(this);q.bind(u,e);q.bind(o,b)}else{clearTimeout(A);p.call(this)}}function e(q){if(A!=null){var M=q.originalEvent;q=M.changedTouches?M.changedTouches[0].pageX:M.pageX;M=M.changedTouches?M.changedTouches[0].pageY:M.pageY;var Q=a(this).data("taphold.point");q=q-Q.x;M=M-Q.y;if(Math.sqrt(q*q+M*M)>d){clearTimeout(A);p.call(this)}}}function b(){clearTimeout(A);p.call(this)}
function k(q){p.call(this);a(this).data("taphold.handler").call(this,q)}function p(){A=null;a(this).unbind(u,e);a(this).unbind(o,b)}function c(q){if(A==null){var M=this;A=setTimeout(function(){k.call(M,q)},g);var Q=q.originalEvent,L={};L.x=Q.changedTouches?Q.changedTouches[0].pageX:Q.pageX;L.y=Q.changedTouches?Q.changedTouches[0].pageY:Q.pageY;a(this).data("taphold.point",L)}}var g=1E3,d=5,o="touchend",u="touchmove",A=null;a.event.special.taphold={setup:function(){},add:function(q){a(this).data("taphold.handler",
q.handler);q.data?a(this).bind("touchstart",q.data,n):a(this).bind("touchstart",n)},remove:function(q){clearTimeout(A);p.call(this);q.data?a(this).unbind("touchstart",q.data,n):a(this).unbind("touchstart",n)},teardown:function(){}}})(jQuery);var saveAs=saveAs||function(a){if(!(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent))){var n=a.document.createElementNS("http://www.w3.org/1999/xhtml","a"),e="download"in n,b=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),k=a.webkitRequestFileSystem,p=a.requestFileSystem||k||a.mozRequestFileSystem,c=function(M){(a.setImmediate||a.setTimeout)(function(){throw M;},0)},g=0,d=function(M){var Q=function(){typeof M==="string"?(a.URL||a.webkitURL||a).revokeObjectURL(M):M.remove()};
a.chrome?Q():setTimeout(Q,500)},o=function(M,Q,L){Q=[].concat(Q);for(var I=Q.length;I--;){var W=M["on"+Q[I]];if(typeof W==="function")try{W.call(M,L||M)}catch(T){c(T)}}},u=function(M){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(M.type))return new Blob(["\ufeff",M],{type:M.type});return M},A=function(M,Q,L){L||(M=u(M));var I=this;L=M.type;var W=false,T,O,da=function(){o(I,"writestart progress write writeend".split(" "))},ma=function(){if(O&&b&&typeof FileReader!==
"undefined"){var ta=new FileReader;ta.onloadend=function(){var ia=ta.result;O.location.href="data:attachment/file"+ia.slice(ia.search(/[,;]/));I.readyState=I.DONE;da()};ta.readAsDataURL(M);I.readyState=I.INIT}else{if(W||!T)T=(a.URL||a.webkitURL||a).createObjectURL(M);if(O)O.location.href=T;else if(a.open(T,"_blank")==undefined&&b)a.location.href=T;I.readyState=I.DONE;da();d(T)}},Z=function(ta){return function(){if(I.readyState!==I.DONE)return ta.apply(this,arguments)}},X={create:true,exclusive:false},
fa;I.readyState=I.INIT;Q||(Q="download");if(e){T=(a.URL||a.webkitURL||a).createObjectURL(M);setTimeout(function(){n.href=T;n.download=Q;var ta=new MouseEvent("click");n.dispatchEvent(ta);da();d(T);I.readyState=I.DONE})}else{if(a.chrome&&L&&L!=="application/octet-stream"){fa=M.slice||M.webkitSlice;M=fa.call(M,0,M.size,"application/octet-stream");W=true}if(k&&Q!=="download")Q+=".download";if(L==="application/octet-stream"||k)O=a;if(p){g+=M.size;p(a.TEMPORARY,g,Z(function(ta){ta.root.getDirectory("saved",
X,Z(function(ia){var la=function(){ia.getFile(Q,X,Z(function(ba){ba.createWriter(Z(function(ea){ea.onwriteend=function(qa){O.location.href=ba.toURL();I.readyState=I.DONE;o(I,"writeend",qa);d(ba)};ea.onerror=function(){var qa=ea.error;qa.code!==qa.ABORT_ERR&&ma()};"writestart progress write abort".split(" ").forEach(function(qa){ea["on"+qa]=I["on"+qa]});ea.write(M);I.abort=function(){ea.abort();I.readyState=I.DONE};I.readyState=I.WRITING}),ma)}),ma)};ia.getFile(Q,{create:false},Z(function(ba){ba.remove();
la()}),Z(function(ba){ba.code===ba.NOT_FOUND_ERR?la():ma()}))}),ma)}),ma)}else ma()}},q=A.prototype;if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob)return function(M,Q,L){L||(M=u(M));return navigator.msSaveOrOpenBlob(M,Q||"download")};q.abort=function(){this.readyState=this.DONE;o(this,"abort")};q.readyState=q.INIT=0;q.WRITING=1;q.DONE=2;q.error=q.onwritestart=q.onprogress=q.onwrite=q.onabort=q.onerror=q.onwriteend=null;return function(M,Q,L){return new A(M,Q,L)}}}(typeof self!=="undefined"&&
self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports)module.exports.saveAs=saveAs;else typeof define!=="undefined"&&define!==null&&define.amd!=null&&define([],function(){return saveAs});
